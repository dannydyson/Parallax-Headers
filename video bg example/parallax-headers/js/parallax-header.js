


//============================================================
//
// The MIT License
//
// Copyright (C) 2013 Matthew Wagerfield - @mwagerfield
//
// Permission is hereby granted, free of charge, to any
// person obtaining a copy of this software and associated
// documentation files (the "Software"), to deal in the
// Software without restriction, including without limitation
// the rights to use, copy, modify, merge, publish, distribute,
// sublicense, and/or sell copies of the Software, and to
// permit persons to whom the Software is furnished to do
// so, subject to the following conditions:
//
// The above copyright notice and this permission notice
// shall be included in all copies or substantial portions
// of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY
// OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT
// LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
// FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO
// EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE
// FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN
// AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE
// OR OTHER DEALINGS IN THE SOFTWARE.
//
//============================================================
(function(t,i,e,s){function o(i,e){this.element=i,this.$context=t(i).data("api",this),this.$layers=this.$context.find(".layer");var s={calibrateX:this.$context.data("calibrate-x")||null,calibrateY:this.$context.data("calibrate-y")||null,invertX:this.$context.data("invert-x")||null,invertY:this.$context.data("invert-y")||null,limitX:parseFloat(this.$context.data("limit-x"))||null,limitY:parseFloat(this.$context.data("limit-y"))||null,scalarX:parseFloat(this.$context.data("scalar-x"))||null,scalarY:parseFloat(this.$context.data("scalar-y"))||null,frictionX:parseFloat(this.$context.data("friction-x"))||null,frictionY:parseFloat(this.$context.data("friction-y"))||null};for(var o in s)null===s[o]&&delete s[o];t.extend(this,r,e,s),this.calibrationTimer=null,this.calibrationFlag=!0,this.enabled=!1,this.depths=[],this.raf=null,this.ox=0,this.oy=0,this.ow=0,this.oh=0,this.cx=0,this.cy=0,this.ix=0,this.iy=0,this.mx=0,this.my=0,this.vx=0,this.vy=0,this.onMouseMove=this.onMouseMove.bind(this),this.onDeviceOrientation=this.onDeviceOrientation.bind(this),this.onOrientationTimer=this.onOrientationTimer.bind(this),this.onCalibrationTimer=this.onCalibrationTimer.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onWindowResize=this.onWindowResize.bind(this),this.initialise()}var n="parallax",a=30,r={calibrationThreshold:100,calibrationDelay:500,supportDelay:500,calibrateX:!1,calibrateY:!0,invertX:!0,invertY:!0,limitX:!1,limitY:!1,scalarX:10,scalarY:10,frictionX:.1,frictionY:.1};o.prototype.transformSupport=function(t){for(var o=e.createElement("div"),n=!1,a=null,r=!1,h=null,l=null,p=0,c=this.vendors.length;c>p;p++)if(null!==this.vendors[p]?(h=this.vendors[p][0]+"transform",l=this.vendors[p][1]+"Transform"):(h="transform",l="transform"),o.style[l]!==s){n=!0;break}switch(t){case"2D":r=n;break;case"3D":n&&(e.body.appendChild(o),o.style[l]="translate3d(1px,1px,1px)",a=i.getComputedStyle(o).getPropertyValue(h),r=a!==s&&a.length>0&&"none"!==a,e.body.removeChild(o))}return r},o.prototype.ww=null,o.prototype.wh=null,o.prototype.hw=null,o.prototype.hh=null,o.prototype.portrait=null,o.prototype.desktop=!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|BB10|mobi|tablet|opera mini|nexus 7)/i),o.prototype.vendors=[null,["-webkit-","webkit"],["-moz-","Moz"],["-o-","O"],["-ms-","ms"]],o.prototype.motionSupport=!!i.DeviceMotionEvent,o.prototype.orientationSupport=!!i.DeviceOrientationEvent,o.prototype.orientationStatus=0,o.prototype.transform2DSupport=o.prototype.transformSupport("2D"),o.prototype.transform3DSupport=o.prototype.transformSupport("3D"),o.prototype.initialise=function(){"static"===this.$context.css("position")&&this.$context.css({position:"relative"}),this.$layers.css({position:"absolute",display:"block",height:"100%",width:"100%",left:0,top:0}),this.$layers.first().css({position:"relative"}),this.$layers.each(t.proxy(function(i,e){this.depths.push(t(e).data("depth")||0)},this)),this.accelerate(this.$context),this.accelerate(this.$layers),this.updateDimensions(),this.enable(),this.queueCalibration(this.calibrationDelay)},o.prototype.updateDimensions=function(){this.ox=this.$context.offset().left,this.oy=this.$context.offset().top,this.ow=this.$context.width(),this.oh=this.$context.height(),this.ww=i.innerWidth,this.wh=i.innerHeight,this.hw=this.ww/2,this.hh=this.wh/2},o.prototype.queueCalibration=function(t){clearTimeout(this.calibrationTimer),this.calibrationTimer=setTimeout(this.onCalibrationTimer,t)},o.prototype.enable=function(){this.enabled||(this.enabled=!0,this.orientationSupport?(this.portrait=null,i.addEventListener("deviceorientation",this.onDeviceOrientation),setTimeout(this.onOrientationTimer,this.supportDelay)):(this.cx=0,this.cy=0,this.portrait=!1,i.addEventListener("mousemove",this.onMouseMove)),i.addEventListener("resize",this.onWindowResize),this.raf=requestAnimationFrame(this.onAnimationFrame))},o.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.orientationSupport?i.removeEventListener("deviceorientation",this.onDeviceOrientation):i.removeEventListener("mousemove",this.onMouseMove),i.removeEventListener("resize",this.onWindowResize),cancelAnimationFrame(this.raf))},o.prototype.calibrate=function(t,i){this.calibrateX=t===s?this.calibrateX:t,this.calibrateY=i===s?this.calibrateY:i},o.prototype.invert=function(t,i){this.invertX=t===s?this.invertX:t,this.invertY=i===s?this.invertY:i},o.prototype.friction=function(t,i){this.frictionX=t===s?this.frictionX:t,this.frictionY=i===s?this.frictionY:i},o.prototype.scalar=function(t,i){this.scalarX=t===s?this.scalarX:t,this.scalarY=i===s?this.scalarY:i},o.prototype.limit=function(t,i){this.limitX=t===s?this.limitX:t,this.limitY=i===s?this.limitY:i},o.prototype.clamp=function(t,i,e){return t=Math.max(t,i),t=Math.min(t,e)},o.prototype.css=function(i,e,o){for(var n=null,a=0,r=this.vendors.length;r>a;a++)if(n=null!==this.vendors[a]?t.camelCase(this.vendors[a][1]+"-"+e):e,i.style[n]!==s){i.style[n]=o;break}},o.prototype.accelerate=function(t){for(var i=0,e=t.length;e>i;i++){var s=t[i];this.css(s,"transform","translate3d(0,0,0)"),this.css(s,"transform-style","preserve-3d"),this.css(s,"backface-visibility","hidden")}},o.prototype.setPosition=function(t,i,e){i+="%",e+="%",this.transform3DSupport?this.css(t,"transform","translate3d("+i+","+e+",0)"):this.transform2DSupport?this.css(t,"transform","translate("+i+","+e+")"):(t.style.left=i,t.style.top=e)},o.prototype.onOrientationTimer=function(){this.orientationSupport&&0===this.orientationStatus&&(this.disable(),this.orientationSupport=!1,this.enable())},o.prototype.onCalibrationTimer=function(){this.calibrationFlag=!0},o.prototype.onWindowResize=function(){this.updateDimensions()},o.prototype.onAnimationFrame=function(){var t=this.ix-this.cx,i=this.iy-this.cy;(Math.abs(t)>this.calibrationThreshold||Math.abs(i)>this.calibrationThreshold)&&this.queueCalibration(0),this.portrait?(this.mx=(this.calibrateX?i:this.iy)*this.scalarX,this.my=(this.calibrateY?t:this.ix)*this.scalarY):(this.mx=(this.calibrateX?t:this.ix)*this.scalarX,this.my=(this.calibrateY?i:this.iy)*this.scalarY),isNaN(parseFloat(this.limitX))||(this.mx=this.clamp(this.mx,-this.limitX,this.limitX)),isNaN(parseFloat(this.limitY))||(this.my=this.clamp(this.my,-this.limitY,this.limitY)),this.vx+=(this.mx-this.vx)*this.frictionX,this.vy+=(this.my-this.vy)*this.frictionY;for(var e=0,s=this.$layers.length;s>e;e++){var o=this.depths[e],n=this.$layers[e],a=this.vx*o*(this.invertX?-1:1),r=this.vy*o*(this.invertY?-1:1);this.setPosition(n,a,r)}this.raf=requestAnimationFrame(this.onAnimationFrame)},o.prototype.onDeviceOrientation=function(t){if(!this.desktop&&null!==t.beta&&null!==t.gamma){this.orientationStatus=1;var e=(t.beta||0)/a,s=(t.gamma||0)/a,o=i.innerHeight>i.innerWidth;this.portrait!==o&&(this.portrait=o,this.calibrationFlag=!0),this.calibrationFlag&&(this.calibrationFlag=!1,this.cx=e,this.cy=s),this.ix=e,this.iy=s}},o.prototype.onMouseMove=function(t){this.ix=(t.pageX-this.hw)/this.hw,this.iy=(t.pageY-this.hh)/this.hh};var h={enable:o.prototype.enable,disable:o.prototype.disable,calibrate:o.prototype.calibrate,friction:o.prototype.friction,invert:o.prototype.invert,scalar:o.prototype.scalar,limit:o.prototype.limit};t.fn[n]=function(i){var e=arguments;return this.each(function(){var s=t(this),a=s.data(n);a||(a=new o(this,i),s.data(n,a)),h[i]&&a[i].apply(a,Array.prototype.slice.call(e,1))})}})(window.jQuery||window.Zepto,window,document),function(){for(var t=0,i=["ms","moz","webkit","o"],e=0;i.length>e&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[i[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[e]+"CancelAnimationFrame"]||window[i[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(i){var e=(new Date).getTime(),s=Math.max(0,16-(e-t)),o=window.setTimeout(function(){i(e+s)},s);return t=e+s,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();


Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]};(function(){var $D=Date,$P=$D.prototype,$C=$D.CultureInfo,p=function(s,l){if(!l){l=2;}
return("000"+s).slice(l*-1);};$P.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this;};$P.setTimeToNow=function(){var n=new Date();this.setHours(n.getHours());this.setMinutes(n.getMinutes());this.setSeconds(n.getSeconds());this.setMilliseconds(n.getMilliseconds());return this;};$D.today=function(){return new Date().clearTime();};$D.compare=function(date1,date2){if(isNaN(date1)||isNaN(date2)){throw new Error(date1+" - "+date2);}else if(date1 instanceof Date&&date2 instanceof Date){return(date1<date2)?-1:(date1>date2)?1:0;}else{throw new TypeError(date1+" - "+date2);}};$D.equals=function(date1,date2){return(date1.compareTo(date2)===0);};$D.getDayNumberFromName=function(name){var n=$C.dayNames,m=$C.abbreviatedDayNames,o=$C.shortestDayNames,s=name.toLowerCase();for(var i=0;i<n.length;i++){if(n[i].toLowerCase()==s||m[i].toLowerCase()==s||o[i].toLowerCase()==s){return i;}}
return-1;};$D.getMonthNumberFromName=function(name){var n=$C.monthNames,m=$C.abbreviatedMonthNames,s=name.toLowerCase();for(var i=0;i<n.length;i++){if(n[i].toLowerCase()==s||m[i].toLowerCase()==s){return i;}}
return-1;};$D.isLeapYear=function(year){return((year%4===0&&year%100!==0)||year%400===0);};$D.getDaysInMonth=function(year,month){return[31,($D.isLeapYear(year)?29:28),31,30,31,30,31,31,30,31,30,31][month];};$D.getTimezoneAbbreviation=function(offset){var z=$C.timezones,p;for(var i=0;i<z.length;i++){if(z[i].offset===offset){return z[i].name;}}
return null;};$D.getTimezoneOffset=function(name){var z=$C.timezones,p;for(var i=0;i<z.length;i++){if(z[i].name===name.toUpperCase()){return z[i].offset;}}
return null;};$P.clone=function(){return new Date(this.getTime());};$P.compareTo=function(date){return Date.compare(this,date);};$P.equals=function(date){return Date.equals(this,date||new Date());};$P.between=function(start,end){return this.getTime()>=start.getTime()&&this.getTime()<=end.getTime();};$P.isAfter=function(date){return this.compareTo(date||new Date())===1;};$P.isBefore=function(date){return(this.compareTo(date||new Date())===-1);};$P.isToday=function(){return this.isSameDay(new Date());};$P.isSameDay=function(date){return this.clone().clearTime().equals(date.clone().clearTime());};$P.addMilliseconds=function(value){this.setMilliseconds(this.getMilliseconds()+value);return this;};$P.addSeconds=function(value){return this.addMilliseconds(value*1000);};$P.addMinutes=function(value){return this.addMilliseconds(value*60000);};$P.addHours=function(value){return this.addMilliseconds(value*3600000);};$P.addDays=function(value){this.setDate(this.getDate()+value);return this;};$P.addWeeks=function(value){return this.addDays(value*7);};$P.addMonths=function(value){var n=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+value);this.setDate(Math.min(n,$D.getDaysInMonth(this.getFullYear(),this.getMonth())));return this;};$P.addYears=function(value){return this.addMonths(value*12);};$P.add=function(config){if(typeof config=="number"){this._orient=config;return this;}
var x=config;if(x.milliseconds){this.addMilliseconds(x.milliseconds);}
if(x.seconds){this.addSeconds(x.seconds);}
if(x.minutes){this.addMinutes(x.minutes);}
if(x.hours){this.addHours(x.hours);}
if(x.weeks){this.addWeeks(x.weeks);}
if(x.months){this.addMonths(x.months);}
if(x.years){this.addYears(x.years);}
if(x.days){this.addDays(x.days);}
return this;};var $y,$m,$d;$P.getWeek=function(){var a,b,c,d,e,f,g,n,s,w;$y=(!$y)?this.getFullYear():$y;$m=(!$m)?this.getMonth()+1:$m;$d=(!$d)?this.getDate():$d;if($m<=2){a=$y-1;b=(a/4|0)-(a/100|0)+(a/400|0);c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0);s=b-c;e=0;f=$d-1+(31*($m-1));}else{a=$y;b=(a/4|0)-(a/100|0)+(a/400|0);c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0);s=b-c;e=s+1;f=$d+((153*($m-3)+2)/5)+58+s;}
g=(a+b)%7;d=(f+g-e)%7;n=(f+3-d)|0;if(n<0){w=53-((g-s)/5|0);}else if(n>364+s){w=1;}else{w=(n/7|0)+1;}
$y=$m=$d=null;return w;};$P.getISOWeek=function(){$y=this.getUTCFullYear();$m=this.getUTCMonth()+1;$d=this.getUTCDate();return p(this.getWeek());};$P.setWeek=function(n){return this.moveToDayOfWeek(1).addWeeks(n-this.getWeek());};$D._validate=function(n,min,max,name){if(typeof n=="undefined"){return false;}else if(typeof n!="number"){throw new TypeError(n+" is not a Number.");}else if(n<min||n>max){throw new RangeError(n+" is not a valid value for "+name+".");}
return true;};$D.validateMillisecond=function(value){return $D._validate(value,0,999,"millisecond");};$D.validateSecond=function(value){return $D._validate(value,0,59,"second");};$D.validateMinute=function(value){return $D._validate(value,0,59,"minute");};$D.validateHour=function(value){return $D._validate(value,0,23,"hour");};$D.validateDay=function(value,year,month){return $D._validate(value,1,$D.getDaysInMonth(year,month),"day");};$D.validateMonth=function(value){return $D._validate(value,0,11,"month");};$D.validateYear=function(value){return $D._validate(value,0,9999,"year");};$P.set=function(config){if($D.validateMillisecond(config.millisecond)){this.addMilliseconds(config.millisecond-this.getMilliseconds());}
if($D.validateSecond(config.second)){this.addSeconds(config.second-this.getSeconds());}
if($D.validateMinute(config.minute)){this.addMinutes(config.minute-this.getMinutes());}
if($D.validateHour(config.hour)){this.addHours(config.hour-this.getHours());}
if($D.validateMonth(config.month)){this.addMonths(config.month-this.getMonth());}
if($D.validateYear(config.year)){this.addYears(config.year-this.getFullYear());}
if($D.validateDay(config.day,this.getFullYear(),this.getMonth())){this.addDays(config.day-this.getDate());}
if(config.timezone){this.setTimezone(config.timezone);}
if(config.timezoneOffset){this.setTimezoneOffset(config.timezoneOffset);}
if(config.week&&$D._validate(config.week,0,53,"week")){this.setWeek(config.week);}
return this;};$P.moveToFirstDayOfMonth=function(){return this.set({day:1});};$P.moveToLastDayOfMonth=function(){return this.set({day:$D.getDaysInMonth(this.getFullYear(),this.getMonth())});};$P.moveToNthOccurrence=function(dayOfWeek,occurrence){var shift=0;if(occurrence>0){shift=occurrence-1;}
else if(occurrence===-1){this.moveToLastDayOfMonth();if(this.getDay()!==dayOfWeek){this.moveToDayOfWeek(dayOfWeek,-1);}
return this;}
return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(dayOfWeek,+1).addWeeks(shift);};$P.moveToDayOfWeek=function(dayOfWeek,orient){var diff=(dayOfWeek-this.getDay()+7*(orient||+1))%7;return this.addDays((diff===0)?diff+=7*(orient||+1):diff);};$P.moveToMonth=function(month,orient){var diff=(month-this.getMonth()+12*(orient||+1))%12;return this.addMonths((diff===0)?diff+=12*(orient||+1):diff);};$P.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/86400000)+1;};$P.getTimezone=function(){return $D.getTimezoneAbbreviation(this.getUTCOffset());};$P.setTimezoneOffset=function(offset){var here=this.getTimezoneOffset(),there=Number(offset)*-6/10;return this.addMinutes(there-here);};$P.setTimezone=function(offset){return this.setTimezoneOffset($D.getTimezoneOffset(offset));};$P.hasDaylightSavingTime=function(){return(Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset());};$P.isDaylightSavingTime=function(){return(this.hasDaylightSavingTime()&&new Date().getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset());};$P.getUTCOffset=function(){var n=this.getTimezoneOffset()*-10/6,r;if(n<0){r=(n-10000).toString();return r.charAt(0)+r.substr(2);}else{r=(n+10000).toString();return"+"+r.substr(1);}};$P.getElapsed=function(date){return(date||new Date())-this;};if(!$P.toISOString){$P.toISOString=function(){function f(n){return n<10?'0'+n:n;}
return'"'+this.getUTCFullYear()+'-'+
f(this.getUTCMonth()+1)+'-'+
f(this.getUTCDate())+'T'+
f(this.getUTCHours())+':'+
f(this.getUTCMinutes())+':'+
f(this.getUTCSeconds())+'Z"';};}
$P._toString=$P.toString;$P.toString=function(format){var x=this;if(format&&format.length==1){var c=$C.formatPatterns;x.t=x.toString;switch(format){case"d":return x.t(c.shortDate);case"D":return x.t(c.longDate);case"F":return x.t(c.fullDateTime);case"m":return x.t(c.monthDay);case"r":return x.t(c.rfc1123);case"s":return x.t(c.sortableDateTime);case"t":return x.t(c.shortTime);case"T":return x.t(c.longTime);case"u":return x.t(c.universalSortableDateTime);case"y":return x.t(c.yearMonth);}}
var ord=function(n){switch(n*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th";}};return format?format.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(m){if(m.charAt(0)==="\\"){return m.replace("\\","");}
x.h=x.getHours;switch(m){case"hh":return p(x.h()<13?(x.h()===0?12:x.h()):(x.h()-12));case"h":return x.h()<13?(x.h()===0?12:x.h()):(x.h()-12);case"HH":return p(x.h());case"H":return x.h();case"mm":return p(x.getMinutes());case"m":return x.getMinutes();case"ss":return p(x.getSeconds());case"s":return x.getSeconds();case"yyyy":return p(x.getFullYear(),4);case"yy":return p(x.getFullYear());case"dddd":return $C.dayNames[x.getDay()];case"ddd":return $C.abbreviatedDayNames[x.getDay()];case"dd":return p(x.getDate());case"d":return x.getDate();case"MMMM":return $C.monthNames[x.getMonth()];case"MMM":return $C.abbreviatedMonthNames[x.getMonth()];case"MM":return p((x.getMonth()+1));case"M":return x.getMonth()+1;case"t":return x.h()<12?$C.amDesignator.substring(0,1):$C.pmDesignator.substring(0,1);case"tt":return x.h()<12?$C.amDesignator:$C.pmDesignator;case"S":return ord(x.getDate());default:return m;}}):this._toString();};}());(function(){var $D=Date,$P=$D.prototype,$C=$D.CultureInfo,$N=Number.prototype;$P._orient=+1;$P._nth=null;$P._is=false;$P._same=false;$P._isSecond=false;$N._dateElement="day";$P.next=function(){this._orient=+1;return this;};$D.next=function(){return $D.today().next();};$P.last=$P.prev=$P.previous=function(){this._orient=-1;return this;};$D.last=$D.prev=$D.previous=function(){return $D.today().last();};$P.is=function(){this._is=true;return this;};$P.same=function(){this._same=true;this._isSecond=false;return this;};$P.today=function(){return this.same().day();};$P.weekday=function(){if(this._is){this._is=false;return(!this.is().sat()&&!this.is().sun());}
return false;};$P.at=function(time){return(typeof time==="string")?$D.parse(this.toString("d")+" "+time):this.set(time);};$N.fromNow=$N.after=function(date){var c={};c[this._dateElement]=this;return((!date)?new Date():date.clone()).add(c);};$N.ago=$N.before=function(date){var c={};c[this._dateElement]=this*-1;return((!date)?new Date():date.clone()).add(c);};var dx=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),mx=("january february march april may june july august september october november december").split(/\s/),px=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),pxf=("Milliseconds Seconds Minutes Hours Date Week Month FullYear").split(/\s/),nth=("final first second third fourth fifth").split(/\s/),de;$P.toObject=function(){var o={};for(var i=0;i<px.length;i++){o[px[i].toLowerCase()]=this["get"+pxf[i]]();}
return o;};$D.fromObject=function(config){config.week=null;return Date.today().set(config);};var df=function(n){return function(){if(this._is){this._is=false;return this.getDay()==n;}
if(this._nth!==null){if(this._isSecond){this.addSeconds(this._orient*-1);}
this._isSecond=false;var ntemp=this._nth;this._nth=null;var temp=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(n,ntemp);if(this>temp){throw new RangeError($D.getDayName(n)+" does not occur "+ntemp+" times in the month of "+$D.getMonthName(temp.getMonth())+" "+temp.getFullYear()+".");}
return this;}
return this.moveToDayOfWeek(n,this._orient);};};var sdf=function(n){return function(){var t=$D.today(),shift=n-t.getDay();if(n===0&&$C.firstDayOfWeek===1&&t.getDay()!==0){shift=shift+7;}
return t.addDays(shift);};};for(var i=0;i<dx.length;i++){$D[dx[i].toUpperCase()]=$D[dx[i].toUpperCase().substring(0,3)]=i;$D[dx[i]]=$D[dx[i].substring(0,3)]=sdf(i);$P[dx[i]]=$P[dx[i].substring(0,3)]=df(i);}
var mf=function(n){return function(){if(this._is){this._is=false;return this.getMonth()===n;}
return this.moveToMonth(n,this._orient);};};var smf=function(n){return function(){return $D.today().set({month:n,day:1});};};for(var j=0;j<mx.length;j++){$D[mx[j].toUpperCase()]=$D[mx[j].toUpperCase().substring(0,3)]=j;$D[mx[j]]=$D[mx[j].substring(0,3)]=smf(j);$P[mx[j]]=$P[mx[j].substring(0,3)]=mf(j);}
var ef=function(j){return function(){if(this._isSecond){this._isSecond=false;return this;}
if(this._same){this._same=this._is=false;var o1=this.toObject(),o2=(arguments[0]||new Date()).toObject(),v="",k=j.toLowerCase();for(var m=(px.length-1);m>-1;m--){v=px[m].toLowerCase();if(o1[v]!=o2[v]){return false;}
if(k==v){break;}}
return true;}
if(j.substring(j.length-1)!="s"){j+="s";}
return this["add"+j](this._orient);};};var nf=function(n){return function(){this._dateElement=n;return this;};};for(var k=0;k<px.length;k++){de=px[k].toLowerCase();$P[de]=$P[de+"s"]=ef(px[k]);$N[de]=$N[de+"s"]=nf(de);}
$P._ss=ef("Second");var nthfn=function(n){return function(dayOfWeek){if(this._same){return this._ss(arguments[0]);}
if(dayOfWeek||dayOfWeek===0){return this.moveToNthOccurrence(dayOfWeek,n);}
this._nth=n;if(n===2&&(dayOfWeek===undefined||dayOfWeek===null)){this._isSecond=true;return this.addSeconds(this._orient);}
return this;};};for(var l=0;l<nth.length;l++){$P[nth[l]]=(l===0)?nthfn(-1):nthfn(l);}}());(function(){Date.Parsing={Exception:function(s){this.message="Parse error at '"+s.substring(0,10)+" ...'";}};var $P=Date.Parsing;var _=$P.Operators={rtoken:function(r){return function(s){var mx=s.match(r);if(mx){return([mx[0],s.substring(mx[0].length)]);}else{throw new $P.Exception(s);}};},token:function(s){return function(s){return _.rtoken(new RegExp("^\s*"+s+"\s*"))(s);};},stoken:function(s){return _.rtoken(new RegExp("^"+s));},until:function(p){return function(s){var qx=[],rx=null;while(s.length){try{rx=p.call(this,s);}catch(e){qx.push(rx[0]);s=rx[1];continue;}
break;}
return[qx,s];};},many:function(p){return function(s){var rx=[],r=null;while(s.length){try{r=p.call(this,s);}catch(e){return[rx,s];}
rx.push(r[0]);s=r[1];}
return[rx,s];};},optional:function(p){return function(s){var r=null;try{r=p.call(this,s);}catch(e){return[null,s];}
return[r[0],r[1]];};},not:function(p){return function(s){try{p.call(this,s);}catch(e){return[null,s];}
throw new $P.Exception(s);};},ignore:function(p){return p?function(s){var r=null;r=p.call(this,s);return[null,r[1]];}:null;},product:function(){var px=arguments[0],qx=Array.prototype.slice.call(arguments,1),rx=[];for(var i=0;i<px.length;i++){rx.push(_.each(px[i],qx));}
return rx;},cache:function(rule){var cache={},r=null;return function(s){try{r=cache[s]=(cache[s]||rule.call(this,s));}catch(e){r=cache[s]=e;}
if(r instanceof $P.Exception){throw r;}else{return r;}};},any:function(){var px=arguments;return function(s){var r=null;for(var i=0;i<px.length;i++){if(px[i]==null){continue;}
try{r=(px[i].call(this,s));}catch(e){r=null;}
if(r){return r;}}
throw new $P.Exception(s);};},each:function(){var px=arguments;return function(s){var rx=[],r=null;for(var i=0;i<px.length;i++){if(px[i]==null){continue;}
try{r=(px[i].call(this,s));}catch(e){throw new $P.Exception(s);}
rx.push(r[0]);s=r[1];}
return[rx,s];};},all:function(){var px=arguments,_=_;return _.each(_.optional(px));},sequence:function(px,d,c){d=d||_.rtoken(/^\s*/);c=c||null;if(px.length==1){return px[0];}
return function(s){var r=null,q=null;var rx=[];for(var i=0;i<px.length;i++){try{r=px[i].call(this,s);}catch(e){break;}
rx.push(r[0]);try{q=d.call(this,r[1]);}catch(ex){q=null;break;}
s=q[1];}
if(!r){throw new $P.Exception(s);}
if(q){throw new $P.Exception(q[1]);}
if(c){try{r=c.call(this,r[1]);}catch(ey){throw new $P.Exception(r[1]);}}
return[rx,(r?r[1]:s)];};},between:function(d1,p,d2){d2=d2||d1;var _fn=_.each(_.ignore(d1),p,_.ignore(d2));return function(s){var rx=_fn.call(this,s);return[[rx[0][0],r[0][2]],rx[1]];};},list:function(p,d,c){d=d||_.rtoken(/^\s*/);c=c||null;return(p instanceof Array?_.each(_.product(p.slice(0,-1),_.ignore(d)),p.slice(-1),_.ignore(c)):_.each(_.many(_.each(p,_.ignore(d))),px,_.ignore(c)));},set:function(px,d,c){d=d||_.rtoken(/^\s*/);c=c||null;return function(s){var r=null,p=null,q=null,rx=null,best=[[],s],last=false;for(var i=0;i<px.length;i++){q=null;p=null;r=null;last=(px.length==1);try{r=px[i].call(this,s);}catch(e){continue;}
rx=[[r[0]],r[1]];if(r[1].length>0&&!last){try{q=d.call(this,r[1]);}catch(ex){last=true;}}else{last=true;}
if(!last&&q[1].length===0){last=true;}
if(!last){var qx=[];for(var j=0;j<px.length;j++){if(i!=j){qx.push(px[j]);}}
p=_.set(qx,d).call(this,q[1]);if(p[0].length>0){rx[0]=rx[0].concat(p[0]);rx[1]=p[1];}}
if(rx[1].length<best[1].length){best=rx;}
if(best[1].length===0){break;}}
if(best[0].length===0){return best;}
if(c){try{q=c.call(this,best[1]);}catch(ey){throw new $P.Exception(best[1]);}
best[1]=q[1];}
return best;};},forward:function(gr,fname){return function(s){return gr[fname].call(this,s);};},replace:function(rule,repl){return function(s){var r=rule.call(this,s);return[repl,r[1]];};},process:function(rule,fn){return function(s){var r=rule.call(this,s);return[fn.call(this,r[0]),r[1]];};},min:function(min,rule){return function(s){var rx=rule.call(this,s);if(rx[0].length<min){throw new $P.Exception(s);}
return rx;};}};var _generator=function(op){return function(){var args=null,rx=[];if(arguments.length>1){args=Array.prototype.slice.call(arguments);}else if(arguments[0]instanceof Array){args=arguments[0];}
if(args){for(var i=0,px=args.shift();i<px.length;i++){args.unshift(px[i]);rx.push(op.apply(null,args));args.shift();return rx;}}else{return op.apply(null,arguments);}};};var gx="optional not ignore cache".split(/\s/);for(var i=0;i<gx.length;i++){_[gx[i]]=_generator(_[gx[i]]);}
var _vector=function(op){return function(){if(arguments[0]instanceof Array){return op.apply(null,arguments[0]);}else{return op.apply(null,arguments);}};};var vx="each any all".split(/\s/);for(var j=0;j<vx.length;j++){_[vx[j]]=_vector(_[vx[j]]);}}());(function(){var $D=Date,$P=$D.prototype,$C=$D.CultureInfo;var flattenAndCompact=function(ax){var rx=[];for(var i=0;i<ax.length;i++){if(ax[i]instanceof Array){rx=rx.concat(flattenAndCompact(ax[i]));}else{if(ax[i]){rx.push(ax[i]);}}}
return rx;};$D.Grammar={};$D.Translator={hour:function(s){return function(){this.hour=Number(s);};},minute:function(s){return function(){this.minute=Number(s);};},second:function(s){return function(){this.second=Number(s);};},meridian:function(s){return function(){this.meridian=s.slice(0,1).toLowerCase();};},timezone:function(s){return function(){var n=s.replace(/[^\d\+\-]/g,"");if(n.length){this.timezoneOffset=Number(n);}else{this.timezone=s.toLowerCase();}};},day:function(x){var s=x[0];return function(){this.day=Number(s.match(/\d+/)[0]);};},month:function(s){return function(){this.month=(s.length==3)?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(s)/4:Number(s)-1;};},year:function(s){return function(){var n=Number(s);this.year=((s.length>2)?n:(n+(((n+2000)<$C.twoDigitYearMax)?2000:1900)));};},rday:function(s){return function(){switch(s){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break;}};},finishExact:function(x){x=(x instanceof Array)?x:[x];for(var i=0;i<x.length;i++){if(x[i]){x[i].call(this);}}
var now=new Date();if((this.hour||this.minute)&&(!this.month&&!this.year&&!this.day)){this.day=now.getDate();}
if(!this.year){this.year=now.getFullYear();}
if(!this.month&&this.month!==0){this.month=now.getMonth();}
if(!this.day){this.day=1;}
if(!this.hour){this.hour=0;}
if(!this.minute){this.minute=0;}
if(!this.second){this.second=0;}
if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12;}else if(this.meridian=="a"&&this.hour==12){this.hour=0;}}
if(this.day>$D.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.");}
var r=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){r.set({timezone:this.timezone});}else if(this.timezoneOffset){r.set({timezoneOffset:this.timezoneOffset});}
return r;},finish:function(x){x=(x instanceof Array)?flattenAndCompact(x):[x];if(x.length===0){return null;}
for(var i=0;i<x.length;i++){if(typeof x[i]=="function"){x[i].call(this);}}
var today=$D.today();if(this.now&&!this.unit&&!this.operator){return new Date();}else if(this.now){today=new Date();}
var expression=!!(this.days&&this.days!==null||this.orient||this.operator);var gap,mod,orient;orient=((this.orient=="past"||this.operator=="subtract")?-1:1);if(!this.now&&"hour minute second".indexOf(this.unit)!=-1){today.setTimeToNow();}
if(this.month||this.month===0){if("year day hour minute second".indexOf(this.unit)!=-1){this.value=this.month+1;this.month=null;expression=true;}}
if(!expression&&this.weekday&&!this.day&&!this.days){var temp=Date[this.weekday]();this.day=temp.getDate();if(!this.month){this.month=temp.getMonth();}
this.year=temp.getFullYear();}
if(expression&&this.weekday&&this.unit!="month"){this.unit="day";gap=($D.getDayNumberFromName(this.weekday)-today.getDay());mod=7;this.days=gap?((gap+(orient*mod))%mod):(orient*mod);}
if(this.month&&this.unit=="day"&&this.operator){this.value=(this.month+1);this.month=null;}
if(this.value!=null&&this.month!=null&&this.year!=null){this.day=this.value*1;}
if(this.month&&!this.day&&this.value){today.set({day:this.value*1});if(!expression){this.day=this.value*1;}}
if(!this.month&&this.value&&this.unit=="month"&&!this.now){this.month=this.value;expression=true;}
if(expression&&(this.month||this.month===0)&&this.unit!="year"){this.unit="month";gap=(this.month-today.getMonth());mod=12;this.months=gap?((gap+(orient*mod))%mod):(orient*mod);this.month=null;}
if(!this.unit){this.unit="day";}
if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null){this[this.unit+"s"]=this[this.unit+"s"]+((this.operator=="add")?1:-1)+(this.value||0)*orient;}else if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1;}
this[this.unit+"s"]=this.value*orient;}
if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12;}else if(this.meridian=="a"&&this.hour==12){this.hour=0;}}
if(this.weekday&&!this.day&&!this.days){var temp=Date[this.weekday]();this.day=temp.getDate();if(temp.getMonth()!==today.getMonth()){this.month=temp.getMonth();}}
if((this.month||this.month===0)&&!this.day){this.day=1;}
if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month){return Date.today().setWeek(this.value);}
if(expression&&this.timezone&&this.day&&this.days){this.day=this.days;}
return(expression)?today.add(this):today.set(this);}};var _=$D.Parsing.Operators,g=$D.Grammar,t=$D.Translator,_fn;g.datePartDelimiter=_.rtoken(/^([\s\-\.\,\/\x27]+)/);g.timePartDelimiter=_.stoken(":");g.whiteSpace=_.rtoken(/^\s*/);g.generalDelimiter=_.rtoken(/^(([\s\,]|at|@|on)+)/);var _C={};g.ctoken=function(keys){var fn=_C[keys];if(!fn){var c=$C.regexPatterns;var kx=keys.split(/\s+/),px=[];for(var i=0;i<kx.length;i++){px.push(_.replace(_.rtoken(c[kx[i]]),kx[i]));}
fn=_C[keys]=_.any.apply(null,px);}
return fn;};g.ctoken2=function(key){return _.rtoken($C.regexPatterns[key]);};g.h=_.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),t.hour));g.hh=_.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2])/),t.hour));g.H=_.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),t.hour));g.HH=_.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3])/),t.hour));g.m=_.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/),t.minute));g.mm=_.cache(_.process(_.rtoken(/^[0-5][0-9]/),t.minute));g.s=_.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/),t.second));g.ss=_.cache(_.process(_.rtoken(/^[0-5][0-9]/),t.second));g.hms=_.cache(_.sequence([g.H,g.m,g.s],g.timePartDelimiter));g.t=_.cache(_.process(g.ctoken2("shortMeridian"),t.meridian));g.tt=_.cache(_.process(g.ctoken2("longMeridian"),t.meridian));g.z=_.cache(_.process(_.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),t.timezone));g.zz=_.cache(_.process(_.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),t.timezone));g.zzz=_.cache(_.process(g.ctoken2("timezone"),t.timezone));g.timeSuffix=_.each(_.ignore(g.whiteSpace),_.set([g.tt,g.zzz]));g.time=_.each(_.optional(_.ignore(_.stoken("T"))),g.hms,g.timeSuffix);g.d=_.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1]|\d)/),_.optional(g.ctoken2("ordinalSuffix"))),t.day));g.dd=_.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1])/),_.optional(g.ctoken2("ordinalSuffix"))),t.day));g.ddd=g.dddd=_.cache(_.process(g.ctoken("sun mon tue wed thu fri sat"),function(s){return function(){this.weekday=s;};}));g.M=_.cache(_.process(_.rtoken(/^(1[0-2]|0\d|\d)/),t.month));g.MM=_.cache(_.process(_.rtoken(/^(1[0-2]|0\d)/),t.month));g.MMM=g.MMMM=_.cache(_.process(g.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),t.month));g.y=_.cache(_.process(_.rtoken(/^(\d\d?)/),t.year));g.yy=_.cache(_.process(_.rtoken(/^(\d\d)/),t.year));g.yyy=_.cache(_.process(_.rtoken(/^(\d\d?\d?\d?)/),t.year));g.yyyy=_.cache(_.process(_.rtoken(/^(\d\d\d\d)/),t.year));_fn=function(){return _.each(_.any.apply(null,arguments),_.not(g.ctoken2("timeContext")));};g.day=_fn(g.d,g.dd);g.month=_fn(g.M,g.MMM);g.year=_fn(g.yyyy,g.yy);g.orientation=_.process(g.ctoken("past future"),function(s){return function(){this.orient=s;};});g.operator=_.process(g.ctoken("add subtract"),function(s){return function(){this.operator=s;};});g.rday=_.process(g.ctoken("yesterday tomorrow today now"),t.rday);g.unit=_.process(g.ctoken("second minute hour day week month year"),function(s){return function(){this.unit=s;};});g.value=_.process(_.rtoken(/^\d\d?(st|nd|rd|th)?/),function(s){return function(){this.value=s.replace(/\D/g,"");};});g.expression=_.set([g.rday,g.operator,g.value,g.unit,g.orientation,g.ddd,g.MMM]);_fn=function(){return _.set(arguments,g.datePartDelimiter);};g.mdy=_fn(g.ddd,g.month,g.day,g.year);g.ymd=_fn(g.ddd,g.year,g.month,g.day);g.dmy=_fn(g.ddd,g.day,g.month,g.year);g.date=function(s){return((g[$C.dateElementOrder]||g.mdy).call(this,s));};g.format=_.process(_.many(_.any(_.process(_.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(fmt){if(g[fmt]){return g[fmt];}else{throw $D.Parsing.Exception(fmt);}}),_.process(_.rtoken(/^[^dMyhHmstz]+/),function(s){return _.ignore(_.stoken(s));}))),function(rules){return _.process(_.each.apply(null,rules),t.finishExact);});var _F={};var _get=function(f){return _F[f]=(_F[f]||g.format(f)[0]);};g.formats=function(fx){if(fx instanceof Array){var rx=[];for(var i=0;i<fx.length;i++){rx.push(_get(fx[i]));}
return _.any.apply(null,rx);}else{return _get(fx);}};g._formats=g.formats(["\"yyyy-MM-ddTHH:mm:ssZ\"","yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]);g._start=_.process(_.set([g.date,g.time,g.expression],g.generalDelimiter,g.whiteSpace),t.finish);g.start=function(s){try{var r=g._formats.call({},s);if(r[1].length===0){return r;}}catch(e){}
return g._start.call({},s);};$D._parse=$D.parse;$D.parse=function(s){var r=null;if(!s){return null;}
if(s instanceof Date){return s;}
try{r=$D.Grammar.start.call({},s.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"));}catch(e){return null;}
return((r[1].length===0)?r[0]:null);};$D.getParseFunction=function(fx){var fn=$D.Grammar.formats(fx);return function(s){var r=null;try{r=fn.call({},s);}catch(e){return null;}
return((r[1].length===0)?r[0]:null);};};$D.parseExact=function(s,fx){return $D.getParseFunction(fx)(s);};}());(function(){function g(o){console.log("$f.fireEvent",[].slice.call(o))}function k(q){if(!q||typeof q!="object"){return q}var o=new q.constructor();for(var p in q){if(q.hasOwnProperty(p)){o[p]=k(q[p])}}return o}function m(t,q){if(!t){return}var o,p=0,r=t.length;if(r===undefined){for(o in t){if(q.call(t[o],o,t[o])===false){break}}}else{for(var s=t[0];p<r&&q.call(s,p,s)!==false;s=t[++p]){}}return t}function c(o){return document.getElementById(o)}function i(q,p,o){if(typeof p!="object"){return q}if(q&&p){m(p,function(r,s){if(!o||typeof s!="function"){q[r]=s}})}return q}function n(s){var q=s.indexOf(".");if(q!=-1){var p=s.slice(0,q)||"*";var o=s.slice(q+1,s.length);var r=[];m(document.getElementsByTagName(p),function(){if(this.className&&this.className.indexOf(o)!=-1){r.push(this)}});return r}}function f(o){o=o||window.event;if(o.preventDefault){o.stopPropagation();o.preventDefault()}else{o.returnValue=false;o.cancelBubble=true}return false}function j(q,o,p){q[o]=q[o]||[];q[o].push(p)}function e(){return"_"+(""+Math.random()).slice(2,10)}var h=function(t,r,s){var q=this,p={},u={};q.index=r;if(typeof t=="string"){t={url:t}}i(this,t,true);m(("Begin*,Start,Pause*,Resume*,Seek*,Stop*,Finish*,LastSecond,Update,BufferFull,BufferEmpty,BufferStop").split(","),function(){var v="on"+this;if(v.indexOf("*")!=-1){v=v.slice(0,v.length-1);var w="onBefore"+v.slice(2);q[w]=function(x){j(u,w,x);return q}}q[v]=function(x){j(u,v,x);return q};if(r==-1){if(q[w]){s[w]=q[w]}if(q[v]){s[v]=q[v]}}});i(this,{onCuepoint:function(x,w){if(arguments.length==1){p.embedded=[null,x];return q}if(typeof x=="number"){x=[x]}var v=e();p[v]=[x,w];if(s.isLoaded()){s._api().fp_addCuepoints(x,r,v)}return q},update:function(w){i(q,w);if(s.isLoaded()){s._api().fp_updateClip(w,r)}var v=s.getConfig();var x=(r==-1)?v.clip:v.playlist[r];i(x,w,true)},_fireEvent:function(v,y,w,A){if(v=="onLoad"){m(p,function(B,C){if(C[0]){s._api().fp_addCuepoints(C[0],r,B)}});return false}A=A||q;if(v=="onCuepoint"){var z=p[y];if(z){return z[1].call(s,A,w)}}if(y&&"onBeforeBegin,onMetaData,onStart,onUpdate,onResume".indexOf(v)!=-1){i(A,y);if(y.metaData){if(!A.duration){A.duration=y.metaData.duration}else{A.fullDuration=y.metaData.duration}}}var x=true;m(u[v],function(){x=this.call(s,A,y,w)});return x}});if(t.onCuepoint){var o=t.onCuepoint;q.onCuepoint.apply(q,typeof o=="function"?[o]:o);delete t.onCuepoint}m(t,function(v,w){if(typeof w=="function"){j(u,v,w);delete t[v]}});if(r==-1){s.onCuepoint=this.onCuepoint}};var l=function(p,r,q,t){var o=this,s={},u=false;if(t){i(s,t)}m(r,function(v,w){if(typeof w=="function"){s[v]=w;delete r[v]}});i(this,{animate:function(y,z,x){if(!y){return o}if(typeof z=="function"){x=z;z=500}if(typeof y=="string"){var w=y;y={};y[w]=z;z=500}if(x){var v=e();s[v]=x}if(z===undefined){z=500}r=q._api().fp_animate(p,y,z,v);return o},css:function(w,x){if(x!==undefined){var v={};v[w]=x;w=v}r=q._api().fp_css(p,w);i(o,r);return o},show:function(){this.display="block";q._api().fp_showPlugin(p);return o},hide:function(){this.display="none";q._api().fp_hidePlugin(p);return o},toggle:function(){this.display=q._api().fp_togglePlugin(p);return o},fadeTo:function(y,x,w){if(typeof x=="function"){w=x;x=500}if(w){var v=e();s[v]=w}this.display=q._api().fp_fadeTo(p,y,x,v);this.opacity=y;return o},fadeIn:function(w,v){return o.fadeTo(1,w,v)},fadeOut:function(w,v){return o.fadeTo(0,w,v)},getName:function(){return p},getPlayer:function(){return q},_fireEvent:function(w,v,x){if(w=="onUpdate"){var z=q._api().fp_getPlugin(p);if(!z){return}i(o,z);delete o.methods;if(!u){m(z.methods,function(){var B=""+this;o[B]=function(){var C=[].slice.call(arguments);var D=q._api().fp_invoke(p,B,C);return D==="undefined"||D===undefined?o:D}});u=true}}var A=s[w];if(A){var y=A.apply(o,v);if(w.slice(0,1)=="_"){delete s[w]}return y}return o}})};function b(q,G,t){var w=this,v=null,D=false,u,s,F=[],y={},x={},E,r,p,C,o,A;i(w,{id:function(){return E},isLoaded:function(){return(v!==null&&v.fp_play!==undefined&&!D)},getParent:function(){return q},hide:function(H){if(H){q.style.height="0px"}if(w.isLoaded()){v.style.height="0px"}return w},show:function(){q.style.height=A+"px";if(w.isLoaded()){v.style.height=o+"px"}return w},isHidden:function(){return w.isLoaded()&&parseInt(v.style.height,10)===0},load:function(J){if(!w.isLoaded()&&w._fireEvent("onBeforeLoad")!==false){var H=function(){if(u&&!flashembed.isSupported(G.version)){q.innerHTML=""}if(J){J.cached=true;j(x,"onLoad",J)}flashembed(q,G,{config:t})};var I=0;m(a,function(){this.unload(function(K){if(++I==a.length){H()}})})}return w},unload:function(J){if(u.replace(/\s/g,"")!==""){if(w._fireEvent("onBeforeUnload")===false){if(J){J(false)}return w}D=true;try{if(v){if(v.fp_isFullscreen()){v.fp_toggleFullscreen()}v.fp_close();w._fireEvent("onUnload")}}catch(H){}var I=function(){v=null;q.innerHTML=u;D=false;if(J){J(true)}};if(/WebKit/i.test(navigator.userAgent)&&!/Chrome/i.test(navigator.userAgent)){setTimeout(I,0)}else{I()}}else{if(J){J(false)}}return w},getClip:function(H){if(H===undefined){H=C}return F[H]},getCommonClip:function(){return s},getPlaylist:function(){return F},getPlugin:function(H){var J=y[H];if(!J&&w.isLoaded()){var I=w._api().fp_getPlugin(H);if(I){J=new l(H,I,w);y[H]=J}}return J},getScreen:function(){return w.getPlugin("screen")},getControls:function(){return w.getPlugin("controls")._fireEvent("onUpdate")},getLogo:function(){try{return w.getPlugin("logo")._fireEvent("onUpdate")}catch(H){}},getPlay:function(){return w.getPlugin("play")._fireEvent("onUpdate")},getConfig:function(H){return H?k(t):t},getFlashParams:function(){return G},loadPlugin:function(K,J,M,L){if(typeof M=="function"){L=M;M={}}var I=L?e():"_";w._api().fp_loadPlugin(K,J,M,I);var H={};H[I]=L;var N=new l(K,null,w,H);y[K]=N;return N},getState:function(){return w.isLoaded()?v.fp_getState():-1},play:function(I,H){var J=function(){if(I!==undefined){w._api().fp_play(I,H)}else{w._api().fp_play()}};if(w.isLoaded()){J()}else{if(D){setTimeout(function(){w.play(I,H)},50)}else{w.load(function(){J()})}}return w},getVersion:function(){var I="flowplayer.js 3.2.11";if(w.isLoaded()){var H=v.fp_getVersion();H.push(I);return H}return I},_api:function(){if(!w.isLoaded()){throw"Flowplayer "+w.id()+" not loaded when calling an API method"}return v},setClip:function(H){m(H,function(I,J){if(typeof J=="function"){j(x,I,J);delete H[I]}else{if(I=="onCuepoint"){$f(q).getCommonClip().onCuepoint(H[I][0],H[I][1])}}});w.setPlaylist([H]);return w},getIndex:function(){return p},bufferAnimate:function(H){v.fp_bufferAnimate(H===undefined||H);return w},_swfHeight:function(){return v.clientHeight}});m(("Click*,Load*,Unload*,Keypress*,Volume*,Mute*,Unmute*,PlaylistReplace,ClipAdd,Fullscreen*,FullscreenExit,Error,MouseOver,MouseOut").split(","),function(){var H="on"+this;if(H.indexOf("*")!=-1){H=H.slice(0,H.length-1);var I="onBefore"+H.slice(2);w[I]=function(J){j(x,I,J);return w}}w[H]=function(J){j(x,H,J);return w}});m(("pause,resume,mute,unmute,stop,toggle,seek,getStatus,getVolume,setVolume,getTime,isPaused,isPlaying,startBuffering,stopBuffering,isFullscreen,toggleFullscreen,reset,close,setPlaylist,addClip,playFeed,setKeyboardShortcutsEnabled,isKeyboardShortcutsEnabled").split(","),function(){var H=this;w[H]=function(J,I){if(!w.isLoaded()){return w}var K=null;if(J!==undefined&&I!==undefined){K=v["fp_"+H](J,I)}else{K=(J===undefined)?v["fp_"+H]():v["fp_"+H](J)}return K==="undefined"||K===undefined?w:K}});w._fireEvent=function(Q){if(typeof Q=="string"){Q=[Q]}var R=Q[0],O=Q[1],M=Q[2],L=Q[3],K=0;if(t.debug){g(Q)}if(!w.isLoaded()&&R=="onLoad"&&O=="player"){v=v||c(r);o=w._swfHeight();m(F,function(){this._fireEvent("onLoad")});m(y,function(S,T){T._fireEvent("onUpdate")});s._fireEvent("onLoad")}if(R=="onLoad"&&O!="player"){return}if(R=="onError"){if(typeof O=="string"||(typeof O=="number"&&typeof M=="number")){O=M;M=L}}if(R=="onContextMenu"){m(t.contextMenu[O],function(S,T){T.call(w)});return}if(R=="onPluginEvent"||R=="onBeforePluginEvent"){var H=O.name||O;var I=y[H];if(I){I._fireEvent("onUpdate",O);return I._fireEvent(M,Q.slice(3))}return}if(R=="onPlaylistReplace"){F=[];var N=0;m(O,function(){F.push(new h(this,N++,w))})}if(R=="onClipAdd"){if(O.isInStream){return}O=new h(O,M,w);F.splice(M,0,O);for(K=M+1;K<F.length;K++){F[K].index++}}var P=true;if(typeof O=="number"&&O<F.length){C=O;var J=F[O];if(J){P=J._fireEvent(R,M,L)}if(!J||P!==false){P=s._fireEvent(R,M,L,J)}}m(x[R],function(){P=this.call(w,O,M);if(this.cached){x[R].splice(K,1)}if(P===false){return false}K++});return P};function B(){if($f(q)){$f(q).getParent().innerHTML="";p=$f(q).getIndex();a[p]=w}else{a.push(w);p=a.length-1}A=parseInt(q.style.height,10)||q.clientHeight;E=q.id||"fp"+e();r=G.id||E+"_api";G.id=r;u=q.innerHTML;if(typeof t=="string"){t={clip:{url:t}}}t.playerId=E;t.clip=t.clip||{};if(q.getAttribute("href",2)&&!t.clip.url){t.clip.url=q.getAttribute("href",2)}s=new h(t.clip,-1,w);t.playlist=t.playlist||[t.clip];var I=0;m(t.playlist,function(){var L=this;if(typeof L=="object"&&L.length){L={url:""+L}}m(t.clip,function(M,N){if(N!==undefined&&L[M]===undefined&&typeof N!="function"){L[M]=N}});t.playlist[I]=L;L=new h(L,I,w);F.push(L);I++});m(t,function(L,M){if(typeof M=="function"){if(s[L]){s[L](M)}else{j(x,L,M)}delete t[L]}});m(t.plugins,function(L,M){if(M){y[L]=new l(L,M,w)}});if(!t.plugins||t.plugins.controls===undefined){y.controls=new l("controls",null,w)}y.canvas=new l("canvas",null,w);u=q.innerHTML;function K(L){if(/iPad|iPhone|iPod/i.test(navigator.userAgent)&&!/.flv$/i.test(F[0].url)&&!J()){return true}if(!w.isLoaded()&&w._fireEvent("onBeforeClick")!==false){w.load()}return f(L)}function J(){return w.hasiPadSupport&&w.hasiPadSupport()}function H(){if(u.replace(/\s/g,"")!==""){if(q.addEventListener){q.addEventListener("click",K,false)}else{if(q.attachEvent){q.attachEvent("onclick",K)}}}else{if(q.addEventListener&&!J()){q.addEventListener("click",f,false)}w.load()}}setTimeout(H,0)}if(typeof q=="string"){var z=c(q);if(!z){throw"Flowplayer cannot access element: "+q}q=z;B()}else{B()}}var a=[];function d(o){this.length=o.length;this.each=function(q){m(o,q)};this.size=function(){return o.length};var p=this;for(name in b.prototype){p[name]=function(){var q=arguments;p.each(function(){this[name].apply(this,q)})}}}window.flowplayer=window.$f=function(){var p=null;var o=arguments[0];if(!arguments.length){m(a,function(){if(this.isLoaded()){p=this;return false}});return p||a[0]}if(arguments.length==1){if(typeof o=="number"){return a[o]}else{if(o=="*"){return new d(a)}m(a,function(){if(this.id()==o.id||this.id()==o||this.getParent()==o){p=this;return false}});return p}}if(arguments.length>1){var t=arguments[1],q=(arguments.length==3)?arguments[2]:{};if(typeof t=="string"){t={src:t}}t=i({bgcolor:"#000000",version:[10,1],expressInstall:"http://releases.flowplayer.org/swf/expressinstall.swf",cachebusting:false},t);if(typeof o=="string"){if(o.indexOf(".")!=-1){var s=[];m(n(o),function(){s.push(new b(this,k(t),k(q)))});return new d(s)}else{var r=c(o);return new b(r!==null?r:k(o),k(t),k(q))}}else{if(o){return new b(o,k(t),k(q))}}}return null};i(window.$f,{fireEvent:function(){var o=[].slice.call(arguments);var q=$f(o[0]);return q?q._fireEvent(o.slice(1)):null},addPlugin:function(o,p){b.prototype[o]=p;return $f},each:m,extend:i});if(typeof jQuery=="function"){jQuery.fn.flowplayer=function(q,p){if(!arguments.length||typeof arguments[0]=="number"){var o=[];this.each(function(){var r=$f(this);if(r){o.push(r)}});return arguments.length?o[arguments[0]]:new d(o)}return this.each(function(){$f(this,k(q),p?k(p):{})})}}})();(function(){var h=document.all,j="http://get.adobe.com/flashplayer",c=typeof jQuery=="function",e=/(\d+)[^\d]+(\d+)[^\d]*(\d*)/,b={width:"100%",height:"100%",id:"_"+(""+Math.random()).slice(9),allowfullscreen:true,allowscriptaccess:"always",quality:"high",version:[3,0],onFail:null,expressInstall:null,w3c:false,cachebusting:false};if(window.attachEvent){window.attachEvent("onbeforeunload",function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){}})}function i(m,l){if(l){for(var f in l){if(l.hasOwnProperty(f)){m[f]=l[f]}}}return m}function a(f,n){var m=[];for(var l in f){if(f.hasOwnProperty(l)){m[l]=n(f[l])}}return m}window.flashembed=function(f,m,l){if(typeof f=="string"){f=document.getElementById(f.replace("#",""))}if(!f){return}if(typeof m=="string"){m={src:m}}return new d(f,i(i({},b),m),l)};var g=i(window.flashembed,{conf:b,getVersion:function(){var m,f;try{f=navigator.plugins["Shockwave Flash"].description.slice(16)}catch(o){try{m=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");f=m&&m.GetVariable("$version")}catch(n){try{m=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");f=m&&m.GetVariable("$version")}catch(l){}}}f=e.exec(f);return f?[1*f[1],1*f[(f[1]*1>9?2:3)]*1]:[0,0]},asString:function(l){if(l===null||l===undefined){return null}var f=typeof l;if(f=="object"&&l.push){f="array"}switch(f){case"string":l=l.replace(new RegExp('(["\\\\])',"g"),"\\$1");l=l.replace(/^\s?(\d+\.?\d*)%/,"$1pct");return'"'+l+'"';case"array":return"["+a(l,function(o){return g.asString(o)}).join(",")+"]";case"function":return'"function()"';case"object":var m=[];for(var n in l){if(l.hasOwnProperty(n)){m.push('"'+n+'":'+g.asString(l[n]))}}return"{"+m.join(",")+"}"}return String(l).replace(/\s/g," ").replace(/\'/g,'"')},getHTML:function(o,l){o=i({},o);var n='<object width="'+o.width+'" height="'+o.height+'" id="'+o.id+'" name="'+o.id+'"';if(o.cachebusting){o.src+=((o.src.indexOf("?")!=-1?"&":"?")+Math.random())}if(o.w3c||!h){n+=' data="'+o.src+'" type="application/x-shockwave-flash"'}else{n+=' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'}n+=">";if(o.w3c||h){n+='<param name="movie" value="'+o.src+'" />'}o.width=o.height=o.id=o.w3c=o.src=null;o.onFail=o.version=o.expressInstall=null;for(var m in o){if(o[m]){n+='<param name="'+m+'" value="'+o[m]+'" />'}}var p="";if(l){for(var f in l){if(l[f]){var q=l[f];p+=f+"="+(/function|object/.test(typeof q)?g.asString(q):q)+"&"}}p=p.slice(0,-1);n+='<param name="flashvars" value=\''+p+"' />"}n+="</object>";return n},isSupported:function(f){return k[0]>f[0]||k[0]==f[0]&&k[1]>=f[1]}});var k=g.getVersion();function d(f,n,m){if(g.isSupported(n.version)){f.innerHTML=g.getHTML(n,m)}else{if(n.expressInstall&&g.isSupported([6,65])){f.innerHTML=g.getHTML(i(n,{src:n.expressInstall}),{MMredirectURL:encodeURIComponent(location.href),MMplayerType:"PlugIn",MMdoctitle:document.title})}else{if(!f.innerHTML.replace(/\s/g,"")){f.innerHTML="<h2>Flash version "+n.version+" or greater is required</h2><h3>"+(k[0]>0?"Your version is "+k:"You have no flash plugin installed")+"</h3>"+(f.tagName=="A"?"<p>Click here to download latest version</p>":"<p>Download latest version from <a href='"+j+"'>here</a></p>");if(f.tagName=="A"||f.tagName=="DIV"){f.onclick=function(){location.href=j}}}if(n.onFail){var l=n.onFail.call(this);if(typeof l=="string"){f.innerHTML=l}}}}if(h){window[n.id]=document.getElementById(n.id)}i(this,{getRoot:function(){return f},getOptions:function(){return n},getConf:function(){return m},getApi:function(){return f.firstChild}})}if(c){jQuery.tools=jQuery.tools||{version:"3.2.11"};jQuery.tools.flashembed={conf:b};jQuery.fn.flashembed=function(l,f){return this.each(function(){$(this).data("flashembed",flashembed(this,l,f))})}}})();$f.addPlugin("ipad",function(y){var S=-1;var z=0;var A=1;var P=2;var E=3;var L=4;var j=5;var i=this;var U=1;var T=false;var I=false;var v=false;var s=0;var R=[];var l;var t=null;var d=0;var f={accelerated:false,autoBuffering:false,autoPlay:true,baseUrl:null,bufferLength:3,connectionProvider:null,cuepointMultiplier:1000,cuepoints:[],controls:{},duration:0,extension:"",fadeInSpeed:1000,fadeOutSpeed:1000,image:false,linkUrl:null,linkWindow:"_self",live:false,metaData:{},originalUrl:null,position:0,playlist:[],provider:"http",scaling:"scale",seekableOnBegin:false,start:0,url:null,urlResolvers:[]};var x=S;var r=S;var u=/iPad|iPhone|iPod/i.test(navigator.userAgent);var c=null;function n(Y,X,V){if(X){for(key in X){if(key){if(X[key]&&typeof X[key]=="function"&&!V){continue}if(X[key]&&typeof X[key]=="object"&&X[key].length===undefined){var W={};n(W,X[key]);Y[key]=W}else{Y[key]=X[key]}}}}return Y}var B={simulateiDevice:false,controlsSizeRatio:1.5,controls:true,debug:false,validExtensions:"mov|m4v|mp4|avi|mp3|m4a|aac|m3u8|m3u|pls",posterExtensions:"png|jpg"};n(B,y);var b=new RegExp("^.("+B.validExtensions+")$","i");var e=new RegExp("^.("+B.posterExtensions+")$","i");function h(){if(B.debug){if(u){var V=[].splice.call(arguments,0).join(", ");console.log.apply(console,[V])}else{console.log.apply(console,arguments)}}}function m(V){switch(V){case-1:return"UNLOADED";case 0:return"LOADED";case 1:return"UNSTARTED";case 2:return"BUFFERING";case 3:return"PLAYING";case 4:return"PAUSED";case 5:return"ENDED"}return"UNKOWN"}function J(V){var W=$f.fireEvent(i.id(),"onBefore"+V,s);return W!==false}function O(V){V.stopPropagation();V.preventDefault();return false}function M(W,V){if(x==S&&!V){return}r=x;x=W;D();if(W==E){p()}h(m(W))}function C(){c.fp_stop();T=false;I=false;v=false;M(A);M(A)}var g=null;function p(){if(g){return}console.log("starting tracker");g=setInterval(G,100);G()}function D(){clearInterval(g);g=null}function G(){var W=Math.floor(c.fp_getTime()*10)*100;var X=Math.floor(c.duration*10)*100;var Y=(new Date()).time;function V(ab,Z){ab=ab>=0?ab:X-Math.abs(ab);for(var aa=0;aa<Z.length;aa++){if(Z[aa].lastTimeFired>Y){Z[aa].lastTimeFired=-1}else{if(Z[aa].lastTimeFired+500>Y){continue}else{if(ab==W||(W-500<ab&&W>ab)){Z[aa].lastTimeFired=Y;$f.fireEvent(i.id(),"onCuepoint",s,Z[aa].fnId,Z[aa].parameters)}}}}}$f.each(i.getCommonClip().cuepoints,V);$f.each(R[s].cuepoints,V)}function H(){C();v=true;c.fp_seek(0)}function N(V){}function q(){console.log(c);function V(X){var W={};n(W,f);n(W,i.getCommonClip());n(W,X);if(W.ipadUrl){url=decodeURIComponent(W.ipadUrl)}else{if(W.url){url=W.url}}if(url&&url.indexOf("://")==-1&&W.ipadBaseUrl){url=W.ipadBaseUrl+"/"+url}else{if(url&&url.indexOf("://")==-1&&W.baseUrl){url=W.baseUrl+"/"+url}}W.originalUrl=W.url;W.completeUrl=url;W.extension=W.completeUrl.substr(W.completeUrl.lastIndexOf("."));var Y=W.extension.indexOf("?");if(Y>-1){W.extension=W.extension.substr(0,Y)}W.type="video";delete W.index;h("fixed clip",W);return W}c.fp_play=function(Z,X,ab,ac){var W=null;var aa=true;var Y=true;h("Calling play() "+Z,Z);if(X){h("ERROR: inStream clips not yet supported");return}if(Z!==undefined){if(typeof Z=="number"){if(s>=R.length){return}s=Z;Z=R[s]}else{if(typeof Z=="string"){Z={url:Z}}c.fp_setPlaylist(Z.length!==undefined?Z:[Z])}if(!b.test(R[s].extension)){if(R.length>1&&s<R.length-1){var ac;if(e.test(R[s].extension)){ac=R[s].url;console.log("Poster image available with url "+ac)}++s;console.log("Not last clip in the playlist, moving to next one");c.fp_play(s,false,true,ac)}return}Z=R[s];W=Z.completeUrl;if(Z.autoBuffering!==undefined&&Z.autoBuffering===false){aa=false}if(Z.autoPlay===undefined||Z.autoPlay===true||ab===true){aa=true;Y=true}else{Y=false}}else{h("clip was not given, simply calling video.play, if not already buffering");if(x!=P){c.play()}return}h("about to play "+W,aa,Y);C();if(W){h("Changing SRC attribute"+W);c.setAttribute("src",W)}if(aa){if(!J("Begin")){return false}if(ac){Y=Z.autoPlay;c.setAttribute("poster",ac);c.setAttribute("preload","none")}$f.fireEvent(i.id(),"onBegin",s);h("calling video.load()");c.load()}if(Y){h("calling video.play()");c.play()}};c.fp_pause=function(){h("pause called");if(!J("Pause")){return false}c.pause()};c.fp_resume=function(){h("resume called");if(!J("Resume")){return false}c.play()};c.fp_stop=function(){h("stop called");if(!J("Stop")){return false}I=true;c.pause();try{c.currentTime=0}catch(W){}};c.fp_seek=function(W){h("seek called "+W);if(!J("Seek")){return false}var aa=0;var W=W+"";if(W.charAt(W.length-1)=="%"){var X=parseInt(W.substr(0,W.length-1))/100;var Z=c.duration;aa=Z*X}else{aa=W}try{c.currentTime=aa}catch(Y){h("Wrong seek time")}};c.fp_getTime=function(){return c.currentTime};c.fp_mute=function(){h("mute called");if(!J("Mute")){return false}U=c.volume;c.volume=0};c.fp_unmute=function(){if(!J("Unmute")){return false}c.volume=U};c.fp_getVolume=function(){return c.volume*100};c.fp_setVolume=function(W){if(!J("Volume")){return false}c.volume=W/100};c.fp_toggle=function(){h("toggle called");if(i.getState()==j){H();return}if(c.paused){c.fp_play()}else{c.fp_pause()}};c.fp_isPaused=function(){return c.paused};c.fp_isPlaying=function(){return!c.paused};c.fp_getPlugin=function(X){if(X=="canvas"||X=="controls"){var W=i.getConfig();return W.plugins&&W.plugins[X]?W.plugins[X]:null}h("ERROR: no support for "+X+" plugin on iDevices");return null};c.fp_close=function(){M(S);c.parentNode.removeChild(c);c=null};c.fp_getStatus=function(){var X=0;var Y=0;try{X=c.buffered.start();Y=c.buffered.end()}catch(W){}return{bufferStart:X,bufferEnd:Y,state:x,time:c.fp_getTime(),muted:c.muted,volume:c.fp_getVolume()}};c.fp_getState=function(){return x};c.fp_startBuffering=function(){if(x==A){c.load()}};c.fp_setPlaylist=function(X){h("Setting playlist");s=0;for(var W=0;W<X.length;W++){X[W]=V(X[W])}R=X;$f.fireEvent(i.id(),"onPlaylistReplace",X)};c.fp_addClip=function(X,W){X=V(X);R.splice(W,0,X);$f.fireEvent(i.id(),"onClipAdd",X,W)};c.fp_updateClip=function(X,W){n(R[W],X);return R[W]};c.fp_getVersion=function(){return"3.2.3"};c.fp_isFullscreen=function(){return false};c.fp_toggleFullscreen=function(){if(c.fp_isFullscreen()){c.webkitExitFullscreen()}else{c.webkitEnterFullscreen()}};c.fp_addCuepoints=function(Z,X,W){var ab=X==-1?i.getCommonClip():R[X];ab.cuepoints=ab.cuepoints||{};Z=Z instanceof Array?Z:[Z];for(var Y=0;Y<Z.length;Y++){var ac=typeof Z[Y]=="object"?(Z[Y]["time"]||null):Z[Y];if(ac==null){continue}ac=Math.floor(ac/100)*100;var aa=ac;if(typeof Z[Y]=="object"){aa=n({},Z[Y],false);if(aa.time===undefined){delete aa.time}if(aa.parameters!==undefined){n(aa,aa.parameters,false);delete aa.parameters}}ab.cuepoints[ac]=ab.cuepoints[ac]||[];ab.cuepoints[ac].push({fnId:W,lastTimeFired:-1,parameters:aa})}};$f.each(("toggleFullscreen,stopBuffering,reset,playFeed,setKeyboardShortcutsEnabled,isKeyboardShortcutsEnabled,css,animate,showPlugin,hidePlugin,togglePlugin,fadeTo,invoke,loadPlugin").split(","),function(){var W=this;c["fp_"+W]=function(){h("ERROR: unsupported API on iDevices "+W);return false}})}function K(){var ai=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","volumechange","waiting"];var aa=function(ak){h("Got event "+ak.type,ak)};for(var ac=0;ac<ai.length;ac++){c.addEventListener(ai[ac],aa,false)}var X=function(ak){h("got onBufferEmpty event "+ak.type);M(P);$f.fireEvent(i.id(),"onBufferEmpty",s)};c.addEventListener("emptied",X,false);c.addEventListener("waiting",X,false);var Z=function(ak){if(r==A||r==P){}else{h("Restoring old state "+m(r));M(r)}$f.fireEvent(i.id(),"onBufferFull",s)};c.addEventListener("canplay",Z,false);c.addEventListener("canplaythrough",Z,false);var Y=function(al){var ak;d=R[s].start;if(R[s].duration>0){ak=R[s].duration;t=ak+d}else{ak=c.duration;t=null}c.fp_updateClip({duration:ak,metaData:{duration:c.duration}},s);R[s].duration=c.duration;R[s].metaData={duration:c.duration};$f.fireEvent(i.id(),"onMetaData",s,R[s])};c.addEventListener("loadedmetadata",Y,false);c.addEventListener("durationchange",Y,false);var W=function(ak){if(t&&c.currentTime>t){c.fp_seek(d);C();return O(ak)}};c.addEventListener("timeupdate",W,false);var ah=function(ak){if(x==L){if(!J("Resume")){h("Resume disallowed, pausing");c.fp_pause();return O(ak)}$f.fireEvent(i.id(),"onResume",s)}M(E);if(!T){T=true;$f.fireEvent(i.id(),"onStart",s)}};c.addEventListener("playing",ah,false);var V=function(ak){F()};c.addEventListener("play",V,false);var ae=function(ak){if(!J("Finish")){if(R.length==1){h("Active playlist only has one clip, onBeforeFinish returned false. Replaying");H()}else{if(s!=(R.length-1)){h("Not the last clip in the playlist, but onBeforeFinish returned false. Returning to the beginning of current clip");c.fp_seek(0)}else{h("Last clip in playlist, but onBeforeFinish returned false, start again from the beginning");c.fp_play(0)}}return O(ak)}M(j);$f.fireEvent(i.id(),"onFinish",s);if(R.length>1&&s<(R.length-1)){h("Not last clip in the playlist, moving to next one");c.fp_play(++s,false,true)}};c.addEventListener("ended",ae,false);var ad=function(ak){M(z,true);$f.fireEvent(i.id(),"onError",s,201);if(B.onFail&&B.onFail instanceof Function){B.onFail.apply(i,[])}};c.addEventListener("error",ad,false);var ag=function(ak){h("got pause event from player"+i.id());if(I){return}if(x==P&&r==A){h("forcing play");setTimeout(function(){c.play()},0);return}if(!J("Pause")){c.fp_resume();return O(ak)}Q();M(L);$f.fireEvent(i.id(),"onPause",s)};c.addEventListener("pause",ag,false);var aj=function(ak){$f.fireEvent(i.id(),"onBeforeSeek",s)};c.addEventListener("seeking",aj,false);var ab=function(ak){if(I){I=false;$f.fireEvent(i.id(),"onStop",s)}else{$f.fireEvent(i.id(),"onSeek",s)}h("seek done, currentState",m(x));if(v){v=false;c.fp_play()}else{if(x!=E){c.fp_pause()}}};c.addEventListener("seeked",ab,false);var af=function(ak){$f.fireEvent(i.id(),"onVolume",c.fp_getVolume())};c.addEventListener("volumechange",af,false)}function F(){l=setInterval(function(){if(c.fp_getTime()>=c.duration-1){$f.fireEvent(i.id(),"onLastSecond",s);Q()}},100)}function Q(){clearInterval(l)}function o(){c.fp_play(0)}function w(){}if(u||B.simulateiDevice){if(!window.flashembed.__replaced){var k=window.flashembed;window.flashembed=function(X,ac,Y){if(typeof X=="string"){X=document.getElementById(X.replace("#",""))}if(!X){return}var ab=window.getComputedStyle(X,null);var aa=parseInt(ab.width);var V=parseInt(ab.height);while(X.firstChild){X.removeChild(X.firstChild)}var W=document.createElement("div");var Z=document.createElement("video");W.appendChild(Z);X.appendChild(W);W.style.height=V+"px";W.style.width=aa+"px";W.style.display="block";W.style.position="relative";W.style.background="-webkit-gradient(linear, left top, left bottom, from(rgba(0, 0, 0, 0.5)), to(rgba(0, 0, 0, 0.7)))";W.style.cursor="default";W.style.webkitUserDrag="none";Z.style.height="100%";Z.style.width="100%";Z.style.display="block";Z.id=ac.id;Z.name=ac.id;Z.style.cursor="pointer";Z.style.webkitUserDrag="none";Z.type="video/mp4";Z.playerConfig=Y.config;$f.fireEvent(Y.config.playerId,"onLoad","player")};flashembed.getVersion=k.getVersion;flashembed.asString=k.asString;flashembed.isSupported=function(){return true};flashembed.__replaced=true}var a=i._fireEvent;i._fireEvent=function(V){if(V[0]=="onLoad"&&V[1]=="player"){c=i.getParent().querySelector("video");if(B.controls){c.controls="controls"}q();K();M(z,true);c.fp_setPlaylist(c.playerConfig.playlist);o();a.apply(i,[V])}var W=x!=S;if(x==S&&typeof V=="string"){W=true}if(W){return a.apply(i,[V])}};i._swfHeight=function(){return parseInt(c.style.height)};i.hasiPadSupport=function(){return true}}return i});(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type=="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.bind('mouseenter',handleHover).bind('mouseleave',handleHover)}})(jQuery);
(function($,p){var i,m=Array.prototype.slice,r=decodeURIComponent,a=$.param,c,l,v,b=$.bbq=$.bbq||{},q,u,j,e=$.event.special,d="hashchange",A="querystring",D="fragment",y="elemUrlAttr",g="location",k="href",t="src",x=/^.*\?|#.*$/g,w=/^.*\#/,h,C={};function E(F){return typeof F==="string"}function B(G){var F=m.call(arguments,1);return function(){return G.apply(this,F.concat(m.call(arguments)))}}function n(F){return F.replace(/^[^#]*#?(.*)$/,"$1")}function o(F){return F.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function f(H,M,F,I,G){var O,L,K,N,J;if(I!==i){K=F.match(H?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);J=K[3]||"";if(G===2&&E(I)){L=I.replace(H?w:x,"")}else{N=l(K[2]);I=E(I)?l[H?D:A](I):I;L=G===2?I:G===1?$.extend({},I,N):$.extend({},N,I);L=a(L);if(H){L=L.replace(h,r)}}O=K[1]+(H?"#":L||!K[1]?"?":"")+L+J}else{O=M(F!==i?F:p[g][k])}return O}a[A]=B(f,0,o);a[D]=c=B(f,1,n);c.noEscape=function(G){G=G||"";var F=$.map(G.split(""),encodeURIComponent);h=new RegExp(F.join("|"),"g")};c.noEscape(",/");$.deparam=l=function(I,F){var H={},G={"true":!0,"false":!1,"null":null};$.each(I.replace(/\+/g," ").split("&"),function(L,Q){var K=Q.split("="),P=r(K[0]),J,O=H,M=0,R=P.split("]["),N=R.length-1;if(/\[/.test(R[0])&&/\]$/.test(R[N])){R[N]=R[N].replace(/\]$/,"");R=R.shift().split("[").concat(R);N=R.length-1}else{N=0}if(K.length===2){J=r(K[1]);if(F){J=J&&!isNaN(J)?+J:J==="undefined"?i:G[J]!==i?G[J]:J}if(N){for(;M<=N;M++){P=R[M]===""?O.length:R[M];O=O[P]=M<N?O[P]||(R[M+1]&&isNaN(R[M+1])?{}:[]):J}}else{if($.isArray(H[P])){H[P].push(J)}else{if(H[P]!==i){H[P]=[H[P],J]}else{H[P]=J}}}}else{if(P){H[P]=F?i:""}}});return H};function z(H,F,G){if(F===i||typeof F==="boolean"){G=F;F=a[H?D:A]()}else{F=E(F)?F.replace(H?w:x,""):F}return l(F,G)}l[A]=B(z,0);l[D]=v=B(z,1);$[y]||($[y]=function(F){return $.extend(C,F)})({a:k,base:k,iframe:t,img:t,input:t,form:"action",link:k,script:t});j=$[y];function s(I,G,H,F){if(!E(H)&&typeof H!=="object"){F=H;H=G;G=i}return this.each(function(){var L=$(this),J=G||j()[(this.nodeName||"").toLowerCase()]||"",K=J&&L.attr(J)||"";L.attr(J,a[I](K,H,F))})}$.fn[A]=B(s,A);$.fn[D]=B(s,D);b.pushState=q=function(I,F){if(E(I)&&/^#/.test(I)&&F===i){F=2}var H=I!==i,G=c(p[g][k],H?I:{},H?F:2);p[g][k]=G+(/#/.test(G)?"":"#")};b.getState=u=function(F,G){return F===i||typeof F==="boolean"?v(F):v(G)[F]};b.removeState=function(F){var G={};if(F!==i){G=u();$.each($.isArray(F)?F:arguments,function(I,H){delete G[H]})}q(G,2)};e[d]=$.extend(e[d],{add:function(F){var H;function G(J){var I=J[D]=c();J.getState=function(K,L){return K===i||typeof K==="boolean"?l(I,K):l(I,L)[K]};H.apply(this,arguments)}if($.isFunction(F)){H=F;return G}else{H=F.handler;F.handler=G}}})})(jQuery,this);(function($,i,b){var j,k=$.event.special,c="location",d="hashchange",l="href",f=$.browser,g=document.documentMode,h=f.msie&&(g===b||g<8),e="on"+d in i&&!h;function a(m){m=m||i[c][l];return m.replace(/^[^#]*#?(.*)$/,"$1")}$[d+"Delay"]=100;k[d]=$.extend(k[d],{setup:function(){if(e){return false}$(j.start)},teardown:function(){if(e){return false}$(j.stop)}});j=(function(){var m={},r,n,o,q;function p(){o=q=function(s){return s};if(h){n=$('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;q=function(){return a(n.document[c][l])};o=function(u,s){if(u!==s){var t=n.document;t.open().close();t[c].hash="#"+u}};o(a())}}m.start=function(){if(r){return}var t=a();o||p();(function s(){var v=a(),u=q(t);if(v!==t){o(t=v,u);$(i).trigger(d)}else{if(u!==t){i[c][l]=i[c][l].replace(/#.*/,"")+"#"+u}}r=setTimeout(s,$[d+"Delay"])})()};m.stop=function(){if(!n){r&&clearTimeout(r);r=0}};return m})()})(jQuery,this);(function($){$.cookie=function(key,value,options){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(value))||value===null||value===undefined)){options=$.extend({},options);if(value===null||value===undefined){options.expires=-1;}
if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);}
value=String(value);return(document.cookie=[encodeURIComponent(key),'=',options.raw?value:encodeURIComponent(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}
options=value||{};var decode=options.raw?function(s){return s;}:decodeURIComponent;var pairs=document.cookie.split('; ');for(var i=0,pair;pair=pairs[i]&&pairs[i].split('=');i++){if(decode(pair[0])===key)return decode(pair[1]||'');}
return null;};})(jQuery);(function($){function Countdown(){this.regional=[];this.regional['']={labels:['Years','Months','Weeks','Days','Hours','Minutes','Seconds'],labels1:['Year','Month','Week','Day','Hour','Minute','Second'],compactLabels:['y','m','w','d'],whichLabels:null,timeSeparator:':',isRTL:false};this._defaults={until:null,since:null,timezone:null,serverSync:null,format:'dHMS',layout:'',compact:false,significant:0,description:'',expiryUrl:'',expiryText:'',alwaysExpire:false,onExpiry:null,onTick:null,tickInterval:1};$.extend(this._defaults,this.regional['']);this._serverSyncs=[]}var w='countdown';var Y=0;var O=1;var W=2;var D=3;var H=4;var M=5;var S=6;$.extend(Countdown.prototype,{markerClassName:'hasCountdown',_timer:setInterval(function(){$.countdown._updateTargets()},980),_timerTargets:[],setDefaults:function(a){this._resetExtraLabels(this._defaults,a);extendRemove(this._defaults,a||{})},UTCDate:function(a,b,c,e,f,g,h,i){if(typeof b=='object'&&b.constructor==Date){i=b.getMilliseconds();h=b.getSeconds();g=b.getMinutes();f=b.getHours();e=b.getDate();c=b.getMonth();b=b.getFullYear()}var d=new Date();d.setUTCFullYear(b);d.setUTCDate(1);d.setUTCMonth(c||0);d.setUTCDate(e||1);d.setUTCHours(f||0);d.setUTCMinutes((g||0)-(Math.abs(a)<30?a*60:a));d.setUTCSeconds(h||0);d.setUTCMilliseconds(i||0);return d},periodsToSeconds:function(a){return a[0]*31557600+a[1]*2629800+a[2]*604800+a[3]*86400+a[4]*3600+a[5]*60+a[6]},_settingsCountdown:function(a,b){if(!b){return $.countdown._defaults}var c=$.data(a,w);return(b=='all'?c.options:c.options[b])},_attachCountdown:function(a,b){var c=$(a);if(c.hasClass(this.markerClassName)){return}c.addClass(this.markerClassName);var d={options:$.extend({},b),_periods:[0,0,0,0,0,0,0]};$.data(a,w,d);this._changeCountdown(a)},_addTarget:function(a){if(!this._hasTarget(a)){this._timerTargets.push(a)}},_hasTarget:function(a){return($.inArray(a,this._timerTargets)>-1)},_removeTarget:function(b){this._timerTargets=$.map(this._timerTargets,function(a){return(a==b?null:a)})},_updateTargets:function(){for(var i=this._timerTargets.length-1;i>=0;i--){this._updateCountdown(this._timerTargets[i])}},_updateCountdown:function(a,b){var c=$(a);b=b||$.data(a,w);if(!b){return}c.html(this._generateHTML(b));c[(this._get(b,'isRTL')?'add':'remove')+'Class']('countdown_rtl');var d=this._get(b,'onTick');if(d){var e=b._hold!='lap'?b._periods:this._calculatePeriods(b,b._show,this._get(b,'significant'),new Date());var f=this._get(b,'tickInterval');if(f==1||this.periodsToSeconds(e)%f==0){d.apply(a,[e])}}var g=b._hold!='pause'&&(b._since?b._now.getTime()<b._since.getTime():b._now.getTime()>=b._until.getTime());if(g&&!b._expiring){b._expiring=true;if(this._hasTarget(a)||this._get(b,'alwaysExpire')){this._removeTarget(a);var h=this._get(b,'onExpiry');if(h){h.apply(a,[])}var i=this._get(b,'expiryText');if(i){var j=this._get(b,'layout');b.options.layout=i;this._updateCountdown(a,b);b.options.layout=j}var k=this._get(b,'expiryUrl');if(k){window.location=k}}b._expiring=false}else if(b._hold=='pause'){this._removeTarget(a)}$.data(a,w,b)},_changeCountdown:function(a,b,c){b=b||{};if(typeof b=='string'){var d=b;b={};b[d]=c}var e=$.data(a,w);if(e){this._resetExtraLabels(e.options,b);extendRemove(e.options,b);this._adjustSettings(a,e);$.data(a,w,e);var f=new Date();if((e._since&&e._since<f)||(e._until&&e._until>f)){this._addTarget(a)}this._updateCountdown(a,e)}},_resetExtraLabels:function(a,b){var c=false;for(var n in b){if(n!='whichLabels'&&n.match(/[Ll]abels/)){c=true;break}}if(c){for(var n in a){if(n.match(/[Ll]abels[0-9]/)){a[n]=null}}}},_adjustSettings:function(a,b){var c;var d=this._get(b,'serverSync');var e=0;var f=null;for(var i=0;i<this._serverSyncs.length;i++){if(this._serverSyncs[i][0]==d){f=this._serverSyncs[i][1];break}}if(f!=null){e=(d?f:0);c=new Date()}else{var g=(d?d.apply(a,[]):null);c=new Date();e=(g?c.getTime()-g.getTime():0);this._serverSyncs.push([d,e])}var h=this._get(b,'timezone');h=(h==null?-c.getTimezoneOffset():h);b._since=this._get(b,'since');if(b._since!=null){b._since=this.UTCDate(h,this._determineTime(b._since,null));if(b._since&&e){b._since.setMilliseconds(b._since.getMilliseconds()+e)}}b._until=this.UTCDate(h,this._determineTime(this._get(b,'until'),c));if(e){b._until.setMilliseconds(b._until.getMilliseconds()+e)}b._show=this._determineShow(b)},_destroyCountdown:function(a){var b=$(a);if(!b.hasClass(this.markerClassName)){return}this._removeTarget(a);b.removeClass(this.markerClassName).empty();$.removeData(a,w)},_pauseCountdown:function(a){this._hold(a,'pause')},_lapCountdown:function(a){this._hold(a,'lap')},_resumeCountdown:function(a){this._hold(a,null)},_hold:function(a,b){var c=$.data(a,w);if(c){if(c._hold=='pause'&&!b){c._periods=c._savePeriods;var d=(c._since?'-':'+');c[c._since?'_since':'_until']=this._determineTime(d+c._periods[0]+'y'+d+c._periods[1]+'o'+d+c._periods[2]+'w'+d+c._periods[3]+'d'+d+c._periods[4]+'h'+d+c._periods[5]+'m'+d+c._periods[6]+'s');this._addTarget(a)}c._hold=b;c._savePeriods=(b=='pause'?c._periods:null);$.data(a,w,c);this._updateCountdown(a,c)}},_getTimesCountdown:function(a){var b=$.data(a,w);return(!b?null:(!b._hold?b._periods:this._calculatePeriods(b,b._show,this._get(b,'significant'),new Date())))},_get:function(a,b){return(a.options[b]!=null?a.options[b]:$.countdown._defaults[b])},_determineTime:function(k,l){var m=function(a){var b=new Date();b.setTime(b.getTime()+a*1000);return b};var n=function(a){a=a.toLowerCase();var b=new Date();var c=b.getFullYear();var d=b.getMonth();var e=b.getDate();var f=b.getHours();var g=b.getMinutes();var h=b.getSeconds();var i=/([+-]?[0-9]+)\s*(s|m|h|d|w|o|y)?/g;var j=i.exec(a);while(j){switch(j[2]||'s'){case's':h+=parseInt(j[1],10);break;case'm':g+=parseInt(j[1],10);break;case'h':f+=parseInt(j[1],10);break;case'd':e+=parseInt(j[1],10);break;case'w':e+=parseInt(j[1],10)*7;break;case'o':d+=parseInt(j[1],10);e=Math.min(e,$.countdown._getDaysInMonth(c,d));break;case'y':c+=parseInt(j[1],10);e=Math.min(e,$.countdown._getDaysInMonth(c,d));break}j=i.exec(a)}return new Date(c,d,e,f,g,h,0)};var o=(k==null?l:(typeof k=='string'?n(k):(typeof k=='number'?m(k):k)));if(o)o.setMilliseconds(0);return o},_getDaysInMonth:function(a,b){return 32-new Date(a,b,32).getDate()},_normalLabels:function(a){return a},_generateHTML:function(c){var d=this._get(c,'significant');c._periods=(c._hold?c._periods:this._calculatePeriods(c,c._show,d,new Date()));var e=false;var f=0;var g=d;var h=$.extend({},c._show);for(var i=Y;i<=S;i++){e|=(c._show[i]=='?'&&c._periods[i]>0);h[i]=(c._show[i]=='?'&&!e?null:c._show[i]);f+=(h[i]?1:0);g-=(c._periods[i]>0?1:0)}var j=[false,false,false,false,false,false,false];for(var i=S;i>=Y;i--){if(c._show[i]){if(c._periods[i]){j[i]=true}else{j[i]=g>0;g--}}}var k=this._get(c,'compact');var l=this._get(c,'layout');var m=(k?this._get(c,'compactLabels'):this._get(c,'labels'));var n=this._get(c,'whichLabels')||this._normalLabels;var o=this._get(c,'timeSeparator');var p=this._get(c,'description')||'';var q=function(a){var b=$.countdown._get(c,'compactLabels'+n(c._periods[a]));return(h[a]?c._periods[a]+(b?b[a]:m[a])+' ':'')};var r=function(a){var b=$.countdown._get(c,'labels'+n(c._periods[a]));return((!d&&h[a])||(d&&j[a])?'<span class="countdown_section"><span class="countdown_amount">'+c._periods[a]+'</span><br/>'+(b?b[a]:m[a])+'</span>':'')};return(l?this._buildLayout(c,h,l,k,d,j):((k?'<span class="countdown_row countdown_amount'+(c._hold?' countdown_holding':'')+'">'+q(Y)+q(O)+q(W)+q(D)+(h[H]?this._minDigits(c._periods[H],2):'')+(h[M]?(h[H]?o:'')+this._minDigits(c._periods[M],2):'')+(h[S]?(h[H]||h[M]?o:'')+this._minDigits(c._periods[S],2):''):'<span class="countdown_row countdown_show'+(d||f)+(c._hold?' countdown_holding':'')+'">'+r(Y)+r(O)+r(W)+r(D)+r(H)+r(M)+r(S))+'</span>'+(p?'<span class="countdown_row countdown_descr">'+p+'</span>':'')))},_buildLayout:function(c,d,e,f,g,h){var j=this._get(c,(f?'compactLabels':'labels'));var k=this._get(c,'whichLabels')||this._normalLabels;var l=function(a){return($.countdown._get(c,(f?'compactLabels':'labels')+k(c._periods[a]))||j)[a]};var m=function(a,b){return Math.floor(a/b)%10};var o={desc:this._get(c,'description'),sep:this._get(c,'timeSeparator'),yl:l(Y),yn:c._periods[Y],ynn:this._minDigits(c._periods[Y],2),ynnn:this._minDigits(c._periods[Y],3),y1:m(c._periods[Y],1),y10:m(c._periods[Y],10),y100:m(c._periods[Y],100),y1000:m(c._periods[Y],1000),ol:l(O),on:c._periods[O],onn:this._minDigits(c._periods[O],2),onnn:this._minDigits(c._periods[O],3),o1:m(c._periods[O],1),o10:m(c._periods[O],10),o100:m(c._periods[O],100),o1000:m(c._periods[O],1000),wl:l(W),wn:c._periods[W],wnn:this._minDigits(c._periods[W],2),wnnn:this._minDigits(c._periods[W],3),w1:m(c._periods[W],1),w10:m(c._periods[W],10),w100:m(c._periods[W],100),w1000:m(c._periods[W],1000),dl:l(D),dn:c._periods[D],dnn:this._minDigits(c._periods[D],2),dnnn:this._minDigits(c._periods[D],3),d1:m(c._periods[D],1),d10:m(c._periods[D],10),d100:m(c._periods[D],100),d1000:m(c._periods[D],1000),hl:l(H),hn:c._periods[H],hnn:this._minDigits(c._periods[H],2),hnnn:this._minDigits(c._periods[H],3),h1:m(c._periods[H],1),h10:m(c._periods[H],10),h100:m(c._periods[H],100),h1000:m(c._periods[H],1000),ml:l(M),mn:c._periods[M],mnn:this._minDigits(c._periods[M],2),mnnn:this._minDigits(c._periods[M],3),m1:m(c._periods[M],1),m10:m(c._periods[M],10),m100:m(c._periods[M],100),m1000:m(c._periods[M],1000),sl:l(S),sn:c._periods[S],snn:this._minDigits(c._periods[S],2),snnn:this._minDigits(c._periods[S],3),s1:m(c._periods[S],1),s10:m(c._periods[S],10),s100:m(c._periods[S],100),s1000:m(c._periods[S],1000)};var p=e;for(var i=Y;i<=S;i++){var q='yowdhms'.charAt(i);var r=new RegExp('\\{'+q+'<\\}(.*)\\{'+q+'>\\}','g');p=p.replace(r,((!g&&d[i])||(g&&h[i])?'$1':''))}$.each(o,function(n,v){var a=new RegExp('\\{'+n+'\\}','g');p=p.replace(a,v)});return p},_minDigits:function(a,b){a=''+a;if(a.length>=b){return a}a='0000000000'+a;return a.substr(a.length-b)},_determineShow:function(a){var b=this._get(a,'format');var c=[];c[Y]=(b.match('y')?'?':(b.match('Y')?'!':null));c[O]=(b.match('o')?'?':(b.match('O')?'!':null));c[W]=(b.match('w')?'?':(b.match('W')?'!':null));c[D]=(b.match('d')?'?':(b.match('D')?'!':null));c[H]=(b.match('h')?'?':(b.match('H')?'!':null));c[M]=(b.match('m')?'?':(b.match('M')?'!':null));c[S]=(b.match('s')?'?':(b.match('S')?'!':null));return c},_calculatePeriods:function(c,d,e,f){c._now=f;c._now.setMilliseconds(0);var g=new Date(c._now.getTime());if(c._since){if(f.getTime()<c._since.getTime()){c._now=f=g}else{f=c._since}}else{g.setTime(c._until.getTime());if(f.getTime()>c._until.getTime()){c._now=f=g}}var h=[0,0,0,0,0,0,0];if(d[Y]||d[O]){var i=$.countdown._getDaysInMonth(f.getFullYear(),f.getMonth());var j=$.countdown._getDaysInMonth(g.getFullYear(),g.getMonth());var k=(g.getDate()==f.getDate()||(g.getDate()>=Math.min(i,j)&&f.getDate()>=Math.min(i,j)));var l=function(a){return(a.getHours()*60+a.getMinutes())*60+a.getSeconds()};var m=Math.max(0,(g.getFullYear()-f.getFullYear())*12+g.getMonth()-f.getMonth()+((g.getDate()<f.getDate()&&!k)||(k&&l(g)<l(f))?-1:0));h[Y]=(d[Y]?Math.floor(m/12):0);h[O]=(d[O]?m-h[Y]*12:0);f=new Date(f.getTime());var n=(f.getDate()==i);var o=$.countdown._getDaysInMonth(f.getFullYear()+h[Y],f.getMonth()+h[O]);if(f.getDate()>o){f.setDate(o)}f.setFullYear(f.getFullYear()+h[Y]);f.setMonth(f.getMonth()+h[O]);if(n){f.setDate(o)}}var p=Math.floor((g.getTime()-f.getTime())/1000);var q=function(a,b){h[a]=(d[a]?Math.floor(p/b):0);p-=h[a]*b};q(W,604800);q(D,86400);q(H,3600);q(M,60);q(S,1);if(p>0&&!c._since){var r=[1,12,4.3482,7,24,60,60];var s=S;var t=1;for(var u=S;u>=Y;u--){if(d[u]){if(h[s]>=t){h[s]=0;p=1}if(p>0){h[u]++;p=0;s=u;t=1}}t*=r[u]}}if(e){for(var u=Y;u<=S;u++){if(e&&h[u]){e--}else if(!e){h[u]=0}}}return h}});function extendRemove(a,b){$.extend(a,b);for(var c in b){if(b[c]==null){a[c]=null}}return a}$.fn.countdown=function(a){var b=Array.prototype.slice.call(arguments,1);if(a=='getTimes'||a=='settings'){return $.countdown['_'+a+'Countdown'].apply($.countdown,[this[0]].concat(b))}return this.each(function(){if(typeof a=='string'){$.countdown['_'+a+'Countdown'].apply($.countdown,[this].concat(b))}else{$.countdown._attachCountdown(this,a)}})};$.countdown=new Countdown()})(jQuery);;(function($,undefined){"use strict";var ver='2.9999.5';if($.support===undefined){$.support={opacity:!($.browser.msie)};}
function debug(s){if($.fn.cycle.debug)
log(s);}
function log(){if(window.console&&console.log)
console.log('[cycle] '+Array.prototype.join.call(arguments,' '));}
$.expr[':'].paused=function(el){return el.cyclePause;};$.fn.cycle=function(options,arg2){var o={s:this.selector,c:this.context};if(this.length===0&&options!='stop'){if(!$.isReady&&o.s){log('DOM not ready, queuing slideshow');$(function(){$(o.s,o.c).cycle(options,arg2);});return this;}
log('terminating; zero elements found by selector'+($.isReady?'':' (DOM not ready)'));return this;}
return this.each(function(){var opts=handleArguments(this,options,arg2);if(opts===false)
return;opts.updateActivePagerLink=opts.updateActivePagerLink||$.fn.cycle.updateActivePagerLink;if(this.cycleTimeout)
clearTimeout(this.cycleTimeout);this.cycleTimeout=this.cyclePause=0;this.cycleStop=0;var $cont=$(this);var $slides=opts.slideExpr?$(opts.slideExpr,this):$cont.children();var els=$slides.get();if(els.length<2){log('terminating; too few slides: '+els.length);return;}
var opts2=buildOptions($cont,$slides,els,opts,o);if(opts2===false)
return;var startTime=opts2.continuous?10:getTimeout(els[opts2.currSlide],els[opts2.nextSlide],opts2,!opts2.backwards);if(startTime){startTime+=(opts2.delay||0);if(startTime<10)
startTime=10;debug('first timeout: '+startTime);this.cycleTimeout=setTimeout(function(){go(els,opts2,0,!opts.backwards);},startTime);}});};function triggerPause(cont,byHover,onPager){var opts=$(cont).data('cycle.opts');var paused=!!cont.cyclePause;if(paused&&opts.paused)
opts.paused(cont,opts,byHover,onPager);else if(!paused&&opts.resumed)
opts.resumed(cont,opts,byHover,onPager);}
function handleArguments(cont,options,arg2){if(cont.cycleStop===undefined)
cont.cycleStop=0;if(options===undefined||options===null)
options={};if(options.constructor==String){switch(options){case'destroy':case'stop':var opts=$(cont).data('cycle.opts');if(!opts)
return false;cont.cycleStop++;if(cont.cycleTimeout)
clearTimeout(cont.cycleTimeout);cont.cycleTimeout=0;if(opts.elements)
$(opts.elements).stop();$(cont).removeData('cycle.opts');if(options=='destroy')
destroy(cont,opts);return false;case'toggle':cont.cyclePause=(cont.cyclePause===1)?0:1;checkInstantResume(cont.cyclePause,arg2,cont);triggerPause(cont);return false;case'pause':cont.cyclePause=1;triggerPause(cont);return false;case'resume':cont.cyclePause=0;checkInstantResume(false,arg2,cont);triggerPause(cont);return false;case'prev':case'next':opts=$(cont).data('cycle.opts');if(!opts){log('options not found, "prev/next" ignored');return false;}
$.fn.cycle[options](opts);return false;default:options={fx:options};}
return options;}
else if(options.constructor==Number){var num=options;options=$(cont).data('cycle.opts');if(!options){log('options not found, can not advance slide');return false;}
if(num<0||num>=options.elements.length){log('invalid slide index: '+num);return false;}
options.nextSlide=num;if(cont.cycleTimeout){clearTimeout(cont.cycleTimeout);cont.cycleTimeout=0;}
if(typeof arg2=='string')
options.oneTimeFx=arg2;go(options.elements,options,1,num>=options.currSlide);return false;}
return options;function checkInstantResume(isPaused,arg2,cont){if(!isPaused&&arg2===true){var options=$(cont).data('cycle.opts');if(!options){log('options not found, can not resume');return false;}
if(cont.cycleTimeout){clearTimeout(cont.cycleTimeout);cont.cycleTimeout=0;}
go(options.elements,options,1,!options.backwards);}}}
function removeFilter(el,opts){if(!$.support.opacity&&opts.cleartype&&el.style.filter){try{el.style.removeAttribute('filter');}
catch(smother){}}}
function destroy(cont,opts){if(opts.next)
$(opts.next).unbind(opts.prevNextEvent);if(opts.prev)
$(opts.prev).unbind(opts.prevNextEvent);if(opts.pager||opts.pagerAnchorBuilder)
$.each(opts.pagerAnchors||[],function(){this.unbind().remove();});opts.pagerAnchors=null;$(cont).unbind('mouseenter.cycle mouseleave.cycle');if(opts.destroy)
opts.destroy(opts);}
function buildOptions($cont,$slides,els,options,o){var startingSlideSpecified;var opts=$.extend({},$.fn.cycle.defaults,options||{},$.metadata?$cont.metadata():$.meta?$cont.data():{});var meta=$.isFunction($cont.data)?$cont.data(opts.metaAttr):null;if(meta)
opts=$.extend(opts,meta);if(opts.autostop)
opts.countdown=opts.autostopCount||els.length;var cont=$cont[0];$cont.data('cycle.opts',opts);opts.$cont=$cont;opts.stopCount=cont.cycleStop;opts.elements=els;opts.before=opts.before?[opts.before]:[];opts.after=opts.after?[opts.after]:[];if(!$.support.opacity&&opts.cleartype)
opts.after.push(function(){removeFilter(this,opts);});if(opts.continuous)
opts.after.push(function(){go(els,opts,0,!opts.backwards);});saveOriginalOpts(opts);if(!$.support.opacity&&opts.cleartype&&!opts.cleartypeNoBg)
clearTypeFix($slides);if($cont.css('position')=='static')
$cont.css('position','relative');if(opts.width)
$cont.width(opts.width);if(opts.height&&opts.height!='auto')
$cont.height(opts.height);if(opts.startingSlide!==undefined){opts.startingSlide=parseInt(opts.startingSlide,10);if(opts.startingSlide>=els.length||opts.startSlide<0)
opts.startingSlide=0;else
startingSlideSpecified=true;}
else if(opts.backwards)
opts.startingSlide=els.length-1;else
opts.startingSlide=0;if(opts.random){opts.randomMap=[];for(var i=0;i<els.length;i++)
opts.randomMap.push(i);opts.randomMap.sort(function(a,b){return Math.random()-0.5;});if(startingSlideSpecified){for(var cnt=0;cnt<els.length;cnt++){if(opts.startingSlide==opts.randomMap[cnt]){opts.randomIndex=cnt;}}}
else{opts.randomIndex=1;opts.startingSlide=opts.randomMap[1];}}
else if(opts.startingSlide>=els.length)
opts.startingSlide=0;opts.currSlide=opts.startingSlide||0;var first=opts.startingSlide;$slides.css({position:'absolute',top:0,left:0}).hide().each(function(i){var z;if(opts.backwards)
z=first?i<=first?els.length+(i-first):first-i:els.length-i;else
z=first?i>=first?els.length-(i-first):first-i:els.length-i;$(this).css('z-index',z);});$(els[first]).css('opacity',1).show();removeFilter(els[first],opts);if(opts.fit){if(!opts.aspect){if(opts.width)
$slides.width(opts.width);if(opts.height&&opts.height!='auto')
$slides.height(opts.height);}else{$slides.each(function(){var $slide=$(this);var ratio=(opts.aspect===true)?$slide.width()/$slide.height():opts.aspect;if(opts.width&&$slide.width()!=opts.width){$slide.width(opts.width);$slide.height(opts.width/ratio);}
if(opts.height&&$slide.height()<opts.height){$slide.height(opts.height);$slide.width(opts.height*ratio);}});}}
if(opts.center&&((!opts.fit)||opts.aspect)){$slides.each(function(){var $slide=$(this);$slide.css({"margin-left":opts.width?((opts.width-$slide.width())/2)+"px":0,"margin-top":opts.height?((opts.height-$slide.height())/2)+"px":0});});}
if(opts.center&&!opts.fit&&!opts.slideResize){$slides.each(function(){var $slide=$(this);$slide.css({"margin-left":opts.width?((opts.width-$slide.width())/2)+"px":0,"margin-top":opts.height?((opts.height-$slide.height())/2)+"px":0});});}
var reshape=opts.containerResize&&!$cont.innerHeight();if(reshape){var maxw=0,maxh=0;for(var j=0;j<els.length;j++){var $e=$(els[j]),e=$e[0],w=$e.outerWidth(),h=$e.outerHeight();if(!w)w=e.offsetWidth||e.width||$e.attr('width');if(!h)h=e.offsetHeight||e.height||$e.attr('height');maxw=w>maxw?w:maxw;maxh=h>maxh?h:maxh;}
if(maxw>0&&maxh>0)
$cont.css({width:maxw+'px',height:maxh+'px'});}
var pauseFlag=false;if(opts.pause)
$cont.bind('mouseenter.cycle',function(){pauseFlag=true;this.cyclePause++;triggerPause(cont,true);}).bind('mouseleave.cycle',function(){if(pauseFlag)
this.cyclePause--;triggerPause(cont,true);});if(supportMultiTransitions(opts)===false)
return false;var requeue=false;options.requeueAttempts=options.requeueAttempts||0;$slides.each(function(){var $el=$(this);this.cycleH=(opts.fit&&opts.height)?opts.height:($el.height()||this.offsetHeight||this.height||$el.attr('height')||0);this.cycleW=(opts.fit&&opts.width)?opts.width:($el.width()||this.offsetWidth||this.width||$el.attr('width')||0);if($el.is('img')){var loadingIE=($.browser.msie&&this.cycleW==28&&this.cycleH==30&&!this.complete);var loadingFF=($.browser.mozilla&&this.cycleW==34&&this.cycleH==19&&!this.complete);var loadingOp=($.browser.opera&&((this.cycleW==42&&this.cycleH==19)||(this.cycleW==37&&this.cycleH==17))&&!this.complete);var loadingOther=(this.cycleH===0&&this.cycleW===0&&!this.complete);if(loadingIE||loadingFF||loadingOp||loadingOther){if(o.s&&opts.requeueOnImageNotLoaded&&++options.requeueAttempts<100){log(options.requeueAttempts,' - img slide not loaded, requeuing slideshow: ',this.src,this.cycleW,this.cycleH);setTimeout(function(){$(o.s,o.c).cycle(options);},opts.requeueTimeout);requeue=true;return false;}
else{log('could not determine size of image: '+this.src,this.cycleW,this.cycleH);}}}
return true;});if(requeue)
return false;opts.cssBefore=opts.cssBefore||{};opts.cssAfter=opts.cssAfter||{};opts.cssFirst=opts.cssFirst||{};opts.animIn=opts.animIn||{};opts.animOut=opts.animOut||{};$slides.not(':eq('+first+')').css(opts.cssBefore);$($slides[first]).css(opts.cssFirst);if(opts.timeout){opts.timeout=parseInt(opts.timeout,10);if(opts.speed.constructor==String)
opts.speed=$.fx.speeds[opts.speed]||parseInt(opts.speed,10);if(!opts.sync)
opts.speed=opts.speed/2;var buffer=opts.fx=='none'?0:opts.fx=='shuffle'?500:250;while((opts.timeout-opts.speed)<buffer)
opts.timeout+=opts.speed;}
if(opts.easing)
opts.easeIn=opts.easeOut=opts.easing;if(!opts.speedIn)
opts.speedIn=opts.speed;if(!opts.speedOut)
opts.speedOut=opts.speed;opts.slideCount=els.length;opts.currSlide=opts.lastSlide=first;if(opts.random){if(++opts.randomIndex==els.length)
opts.randomIndex=0;opts.nextSlide=opts.randomMap[opts.randomIndex];}
else if(opts.backwards)
opts.nextSlide=opts.startingSlide===0?(els.length-1):opts.startingSlide-1;else
opts.nextSlide=opts.startingSlide>=(els.length-1)?0:opts.startingSlide+1;if(!opts.multiFx){var init=$.fn.cycle.transitions[opts.fx];if($.isFunction(init))
init($cont,$slides,opts);else if(opts.fx!='custom'&&!opts.multiFx){log('unknown transition: '+opts.fx,'; slideshow terminating');return false;}}
var e0=$slides[first];if(!opts.skipInitializationCallbacks){if(opts.before.length)
opts.before[0].apply(e0,[e0,e0,opts,true]);if(opts.after.length)
opts.after[0].apply(e0,[e0,e0,opts,true]);}
if(opts.next)
$(opts.next).bind(opts.prevNextEvent,function(){return advance(opts,1);});if(opts.prev)
$(opts.prev).bind(opts.prevNextEvent,function(){return advance(opts,0);});if(opts.pager||opts.pagerAnchorBuilder)
buildPager(els,opts);exposeAddSlide(opts,els);return opts;}
function saveOriginalOpts(opts){opts.original={before:[],after:[]};opts.original.cssBefore=$.extend({},opts.cssBefore);opts.original.cssAfter=$.extend({},opts.cssAfter);opts.original.animIn=$.extend({},opts.animIn);opts.original.animOut=$.extend({},opts.animOut);$.each(opts.before,function(){opts.original.before.push(this);});$.each(opts.after,function(){opts.original.after.push(this);});}
function supportMultiTransitions(opts){var i,tx,txs=$.fn.cycle.transitions;if(opts.fx.indexOf(',')>0){opts.multiFx=true;opts.fxs=opts.fx.replace(/\s*/g,'').split(',');for(i=0;i<opts.fxs.length;i++){var fx=opts.fxs[i];tx=txs[fx];if(!tx||!txs.hasOwnProperty(fx)||!$.isFunction(tx)){log('discarding unknown transition: ',fx);opts.fxs.splice(i,1);i--;}}
if(!opts.fxs.length){log('No valid transitions named; slideshow terminating.');return false;}}
else if(opts.fx=='all'){opts.multiFx=true;opts.fxs=[];for(var p in txs){if(txs.hasOwnProperty(p)){tx=txs[p];if(txs.hasOwnProperty(p)&&$.isFunction(tx))
opts.fxs.push(p);}}}
if(opts.multiFx&&opts.randomizeEffects){var r1=Math.floor(Math.random()*20)+30;for(i=0;i<r1;i++){var r2=Math.floor(Math.random()*opts.fxs.length);opts.fxs.push(opts.fxs.splice(r2,1)[0]);}
debug('randomized fx sequence: ',opts.fxs);}
return true;}
function exposeAddSlide(opts,els){opts.addSlide=function(newSlide,prepend){var $s=$(newSlide),s=$s[0];if(!opts.autostopCount)
opts.countdown++;els[prepend?'unshift':'push'](s);if(opts.els)
opts.els[prepend?'unshift':'push'](s);opts.slideCount=els.length;if(opts.random){opts.randomMap.push(opts.slideCount-1);opts.randomMap.sort(function(a,b){return Math.random()-0.5;});}
$s.css('position','absolute');$s[prepend?'prependTo':'appendTo'](opts.$cont);if(prepend){opts.currSlide++;opts.nextSlide++;}
if(!$.support.opacity&&opts.cleartype&&!opts.cleartypeNoBg)
clearTypeFix($s);if(opts.fit&&opts.width)
$s.width(opts.width);if(opts.fit&&opts.height&&opts.height!='auto')
$s.height(opts.height);s.cycleH=(opts.fit&&opts.height)?opts.height:$s.height();s.cycleW=(opts.fit&&opts.width)?opts.width:$s.width();$s.css(opts.cssBefore);if(opts.pager||opts.pagerAnchorBuilder)
$.fn.cycle.createPagerAnchor(els.length-1,s,$(opts.pager),els,opts);if($.isFunction(opts.onAddSlide))
opts.onAddSlide($s);else
$s.hide();};}
$.fn.cycle.resetState=function(opts,fx){fx=fx||opts.fx;opts.before=[];opts.after=[];opts.cssBefore=$.extend({},opts.original.cssBefore);opts.cssAfter=$.extend({},opts.original.cssAfter);opts.animIn=$.extend({},opts.original.animIn);opts.animOut=$.extend({},opts.original.animOut);opts.fxFn=null;$.each(opts.original.before,function(){opts.before.push(this);});$.each(opts.original.after,function(){opts.after.push(this);});var init=$.fn.cycle.transitions[fx];if($.isFunction(init))
init(opts.$cont,$(opts.elements),opts);};function go(els,opts,manual,fwd){var p=opts.$cont[0],curr=els[opts.currSlide],next=els[opts.nextSlide];if(manual&&opts.busy&&opts.manualTrump){debug('manualTrump in go(), stopping active transition');$(els).stop(true,true);opts.busy=0;clearTimeout(p.cycleTimeout);}
if(opts.busy){debug('transition active, ignoring new tx request');return;}
if(p.cycleStop!=opts.stopCount||p.cycleTimeout===0&&!manual)
return;if(!manual&&!p.cyclePause&&!opts.bounce&&((opts.autostop&&(--opts.countdown<=0))||(opts.nowrap&&!opts.random&&opts.nextSlide<opts.currSlide))){if(opts.end)
opts.end(opts);return;}
var changed=false;if((manual||!p.cyclePause)&&(opts.nextSlide!=opts.currSlide)){changed=true;var fx=opts.fx;curr.cycleH=curr.cycleH||$(curr).height();curr.cycleW=curr.cycleW||$(curr).width();next.cycleH=next.cycleH||$(next).height();next.cycleW=next.cycleW||$(next).width();if(opts.multiFx){if(fwd&&(opts.lastFx===undefined||++opts.lastFx>=opts.fxs.length))
opts.lastFx=0;else if(!fwd&&(opts.lastFx===undefined||--opts.lastFx<0))
opts.lastFx=opts.fxs.length-1;fx=opts.fxs[opts.lastFx];}
if(opts.oneTimeFx){fx=opts.oneTimeFx;opts.oneTimeFx=null;}
$.fn.cycle.resetState(opts,fx);if(opts.before.length)
$.each(opts.before,function(i,o){if(p.cycleStop!=opts.stopCount)return;o.apply(next,[curr,next,opts,fwd]);});var after=function(){opts.busy=0;$.each(opts.after,function(i,o){if(p.cycleStop!=opts.stopCount)return;o.apply(next,[curr,next,opts,fwd]);});if(!p.cycleStop){queueNext();}};debug('tx firing('+fx+'); currSlide: '+opts.currSlide+'; nextSlide: '+opts.nextSlide);opts.busy=1;if(opts.fxFn)
opts.fxFn(curr,next,opts,after,fwd,manual&&opts.fastOnEvent);else if($.isFunction($.fn.cycle[opts.fx]))
$.fn.cycle[opts.fx](curr,next,opts,after,fwd,manual&&opts.fastOnEvent);else
$.fn.cycle.custom(curr,next,opts,after,fwd,manual&&opts.fastOnEvent);}
else{queueNext();}
if(changed||opts.nextSlide==opts.currSlide){var roll;opts.lastSlide=opts.currSlide;if(opts.random){opts.currSlide=opts.nextSlide;if(++opts.randomIndex==els.length){opts.randomIndex=0;opts.randomMap.sort(function(a,b){return Math.random()-0.5;});}
opts.nextSlide=opts.randomMap[opts.randomIndex];if(opts.nextSlide==opts.currSlide)
opts.nextSlide=(opts.currSlide==opts.slideCount-1)?0:opts.currSlide+1;}
else if(opts.backwards){roll=(opts.nextSlide-1)<0;if(roll&&opts.bounce){opts.backwards=!opts.backwards;opts.nextSlide=1;opts.currSlide=0;}
else{opts.nextSlide=roll?(els.length-1):opts.nextSlide-1;opts.currSlide=roll?0:opts.nextSlide+1;}}
else{roll=(opts.nextSlide+1)==els.length;if(roll&&opts.bounce){opts.backwards=!opts.backwards;opts.nextSlide=els.length-2;opts.currSlide=els.length-1;}
else{opts.nextSlide=roll?0:opts.nextSlide+1;opts.currSlide=roll?els.length-1:opts.nextSlide-1;}}}
if(changed&&opts.pager)
opts.updateActivePagerLink(opts.pager,opts.currSlide,opts.activePagerClass);function queueNext(){var ms=0,timeout=opts.timeout;if(opts.timeout&&!opts.continuous){ms=getTimeout(els[opts.currSlide],els[opts.nextSlide],opts,fwd);if(opts.fx=='shuffle')
ms-=opts.speedOut;}
else if(opts.continuous&&p.cyclePause)
ms=10;if(ms>0)
p.cycleTimeout=setTimeout(function(){go(els,opts,0,!opts.backwards);},ms);}}
$.fn.cycle.updateActivePagerLink=function(pager,currSlide,clsName){$(pager).each(function(){$(this).children().removeClass(clsName).eq(currSlide).addClass(clsName);});};function getTimeout(curr,next,opts,fwd){if(opts.timeoutFn){var t=opts.timeoutFn.call(curr,curr,next,opts,fwd);while(opts.fx!='none'&&(t-opts.speed)<250)
t+=opts.speed;debug('calculated timeout: '+t+'; speed: '+opts.speed);if(t!==false)
return t;}
return opts.timeout;}
$.fn.cycle.next=function(opts){advance(opts,1);};$.fn.cycle.prev=function(opts){advance(opts,0);};function advance(opts,moveForward){var val=moveForward?1:-1;var els=opts.elements;var p=opts.$cont[0],timeout=p.cycleTimeout;if(timeout){clearTimeout(timeout);p.cycleTimeout=0;}
if(opts.random&&val<0){opts.randomIndex--;if(--opts.randomIndex==-2)
opts.randomIndex=els.length-2;else if(opts.randomIndex==-1)
opts.randomIndex=els.length-1;opts.nextSlide=opts.randomMap[opts.randomIndex];}
else if(opts.random){opts.nextSlide=opts.randomMap[opts.randomIndex];}
else{opts.nextSlide=opts.currSlide+val;if(opts.nextSlide<0){if(opts.nowrap)return false;opts.nextSlide=els.length-1;}
else if(opts.nextSlide>=els.length){if(opts.nowrap)return false;opts.nextSlide=0;}}
var cb=opts.onPrevNextEvent||opts.prevNextClick;if($.isFunction(cb))
cb(val>0,opts.nextSlide,els[opts.nextSlide]);go(els,opts,1,moveForward);return false;}
function buildPager(els,opts){var $p=$(opts.pager);$.each(els,function(i,o){$.fn.cycle.createPagerAnchor(i,o,$p,els,opts);});opts.updateActivePagerLink(opts.pager,opts.startingSlide,opts.activePagerClass);}
$.fn.cycle.createPagerAnchor=function(i,el,$p,els,opts){var a;if($.isFunction(opts.pagerAnchorBuilder)){a=opts.pagerAnchorBuilder(i,el);debug('pagerAnchorBuilder('+i+', el) returned: '+a);}
else
a='<a href="#">'+(i+1)+'</a>';if(!a)
return;var $a=$(a);if($a.parents('body').length===0){var arr=[];if($p.length>1){$p.each(function(){var $clone=$a.clone(true);$(this).append($clone);arr.push($clone[0]);});$a=$(arr);}
else{$a.appendTo($p);}}
opts.pagerAnchors=opts.pagerAnchors||[];opts.pagerAnchors.push($a);var pagerFn=function(e){e.preventDefault();opts.nextSlide=i;var p=opts.$cont[0],timeout=p.cycleTimeout;if(timeout){clearTimeout(timeout);p.cycleTimeout=0;}
var cb=opts.onPagerEvent||opts.pagerClick;if($.isFunction(cb))
cb(opts.nextSlide,els[opts.nextSlide]);go(els,opts,1,opts.currSlide<i);};if(/mouseenter|mouseover/i.test(opts.pagerEvent)){$a.hover(pagerFn,function(){});}
else{$a.bind(opts.pagerEvent,pagerFn);}
if(!/^click/.test(opts.pagerEvent)&&!opts.allowPagerClickBubble)
$a.bind('click.cycle',function(){return false;});var cont=opts.$cont[0];var pauseFlag=false;if(opts.pauseOnPagerHover){$a.hover(function(){pauseFlag=true;cont.cyclePause++;triggerPause(cont,true,true);},function(){if(pauseFlag)
cont.cyclePause--;triggerPause(cont,true,true);});}};$.fn.cycle.hopsFromLast=function(opts,fwd){var hops,l=opts.lastSlide,c=opts.currSlide;if(fwd)
hops=c>l?c-l:opts.slideCount-l;else
hops=c<l?l-c:l+opts.slideCount-c;return hops;};function clearTypeFix($slides){debug('applying clearType background-color hack');function hex(s){s=parseInt(s,10).toString(16);return s.length<2?'0'+s:s;}
function getBg(e){for(;e&&e.nodeName.toLowerCase()!='html';e=e.parentNode){var v=$.css(e,'background-color');if(v&&v.indexOf('rgb')>=0){var rgb=v.match(/\d+/g);return'#'+hex(rgb[0])+hex(rgb[1])+hex(rgb[2]);}
if(v&&v!='transparent')
return v;}
return'#ffffff';}
$slides.each(function(){$(this).css('background-color',getBg(this));});}
$.fn.cycle.commonReset=function(curr,next,opts,w,h,rev){$(opts.elements).not(curr).hide();if(typeof opts.cssBefore.opacity=='undefined')
opts.cssBefore.opacity=1;opts.cssBefore.display='block';if(opts.slideResize&&w!==false&&next.cycleW>0)
opts.cssBefore.width=next.cycleW;if(opts.slideResize&&h!==false&&next.cycleH>0)
opts.cssBefore.height=next.cycleH;opts.cssAfter=opts.cssAfter||{};opts.cssAfter.display='none';$(curr).css('zIndex',opts.slideCount+(rev===true?1:0));$(next).css('zIndex',opts.slideCount+(rev===true?0:1));};$.fn.cycle.custom=function(curr,next,opts,cb,fwd,speedOverride){var $l=$(curr),$n=$(next);var speedIn=opts.speedIn,speedOut=opts.speedOut,easeIn=opts.easeIn,easeOut=opts.easeOut;$n.css(opts.cssBefore);if(speedOverride){if(typeof speedOverride=='number')
speedIn=speedOut=speedOverride;else
speedIn=speedOut=1;easeIn=easeOut=null;}
var fn=function(){$n.animate(opts.animIn,speedIn,easeIn,function(){cb();});};$l.animate(opts.animOut,speedOut,easeOut,function(){$l.css(opts.cssAfter);if(!opts.sync)
fn();});if(opts.sync)fn();};$.fn.cycle.transitions={fade:function($cont,$slides,opts){$slides.not(':eq('+opts.currSlide+')').css('opacity',0);opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts);opts.cssBefore.opacity=0;});opts.animIn={opacity:1};opts.animOut={opacity:0};opts.cssBefore={top:0,left:0};}};$.fn.cycle.ver=function(){return ver;};$.fn.cycle.defaults={activePagerClass:'activeSlide',after:null,allowPagerClickBubble:false,animIn:null,animOut:null,aspect:false,autostop:0,autostopCount:0,backwards:false,before:null,center:null,cleartype:!$.support.opacity,cleartypeNoBg:false,containerResize:1,continuous:0,cssAfter:null,cssBefore:null,delay:0,easeIn:null,easeOut:null,easing:null,end:null,fastOnEvent:0,fit:0,fx:'fade',fxFn:null,height:'auto',manualTrump:true,metaAttr:'cycle',next:null,nowrap:0,onPagerEvent:null,onPrevNextEvent:null,pager:null,pagerAnchorBuilder:null,pagerEvent:'click.cycle',pause:0,pauseOnPagerHover:0,prev:null,prevNextEvent:'click.cycle',random:0,randomizeEffects:1,requeueOnImageNotLoaded:true,requeueTimeout:250,rev:0,shuffle:null,skipInitializationCallbacks:false,slideExpr:null,slideResize:1,speed:1000,speedIn:null,speedOut:null,startingSlide:undefined,sync:1,timeout:4000,timeoutFn:null,updateActivePagerLink:null,width:null};})(jQuery);(function($){"use strict";$.fn.cycle.transitions.none=function($cont,$slides,opts){opts.fxFn=function(curr,next,opts,after){$(next).show();$(curr).hide();after();};};$.fn.cycle.transitions.fadeout=function($cont,$slides,opts){$slides.not(':eq('+opts.currSlide+')').css({display:'block','opacity':1});opts.before.push(function(curr,next,opts,w,h,rev){$(curr).css('zIndex',opts.slideCount+(rev!==true?1:0));$(next).css('zIndex',opts.slideCount+(rev!==true?0:1));});opts.animIn.opacity=1;opts.animOut.opacity=0;opts.cssBefore.opacity=1;opts.cssBefore.display='block';opts.cssAfter.zIndex=0;};$.fn.cycle.transitions.scrollUp=function($cont,$slides,opts){$cont.css('overflow','hidden');opts.before.push($.fn.cycle.commonReset);var h=$cont.height();opts.cssBefore.top=h;opts.cssBefore.left=0;opts.cssFirst.top=0;opts.animIn.top=0;opts.animOut.top=-h;};$.fn.cycle.transitions.scrollDown=function($cont,$slides,opts){$cont.css('overflow','hidden');opts.before.push($.fn.cycle.commonReset);var h=$cont.height();opts.cssFirst.top=0;opts.cssBefore.top=-h;opts.cssBefore.left=0;opts.animIn.top=0;opts.animOut.top=h;};$.fn.cycle.transitions.scrollLeft=function($cont,$slides,opts){$cont.css('overflow','hidden');opts.before.push($.fn.cycle.commonReset);var w=$cont.width();opts.cssFirst.left=0;opts.cssBefore.left=w;opts.cssBefore.top=0;opts.animIn.left=0;opts.animOut.left=0-w;};$.fn.cycle.transitions.scrollRight=function($cont,$slides,opts){$cont.css('overflow','hidden');opts.before.push($.fn.cycle.commonReset);var w=$cont.width();opts.cssFirst.left=0;opts.cssBefore.left=-w;opts.cssBefore.top=0;opts.animIn.left=0;opts.animOut.left=w;};$.fn.cycle.transitions.scrollHorz=function($cont,$slides,opts){$cont.css('overflow','hidden').width();opts.before.push(function(curr,next,opts,fwd){if(opts.rev)
fwd=!fwd;$.fn.cycle.commonReset(curr,next,opts);opts.cssBefore.left=fwd?(next.cycleW-1):(1-next.cycleW);opts.animOut.left=fwd?-curr.cycleW:curr.cycleW;});opts.cssFirst.left=0;opts.cssBefore.top=0;opts.animIn.left=0;opts.animOut.top=0;};$.fn.cycle.transitions.scrollVert=function($cont,$slides,opts){$cont.css('overflow','hidden');opts.before.push(function(curr,next,opts,fwd){if(opts.rev)
fwd=!fwd;$.fn.cycle.commonReset(curr,next,opts);opts.cssBefore.top=fwd?(1-next.cycleH):(next.cycleH-1);opts.animOut.top=fwd?curr.cycleH:-curr.cycleH;});opts.cssFirst.top=0;opts.cssBefore.left=0;opts.animIn.top=0;opts.animOut.left=0;};$.fn.cycle.transitions.slideX=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$(opts.elements).not(curr).hide();$.fn.cycle.commonReset(curr,next,opts,false,true);opts.animIn.width=next.cycleW;});opts.cssBefore.left=0;opts.cssBefore.top=0;opts.cssBefore.width=0;opts.animIn.width='show';opts.animOut.width=0;};$.fn.cycle.transitions.slideY=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$(opts.elements).not(curr).hide();$.fn.cycle.commonReset(curr,next,opts,true,false);opts.animIn.height=next.cycleH;});opts.cssBefore.left=0;opts.cssBefore.top=0;opts.cssBefore.height=0;opts.animIn.height='show';opts.animOut.height=0;};$.fn.cycle.transitions.shuffle=function($cont,$slides,opts){var i,w=$cont.css('overflow','visible').width();$slides.css({left:0,top:0});opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,true,true);});if(!opts.speedAdjusted){opts.speed=opts.speed/2;opts.speedAdjusted=true;}
opts.random=0;opts.shuffle=opts.shuffle||{left:-w,top:15};opts.els=[];for(i=0;i<$slides.length;i++)
opts.els.push($slides[i]);for(i=0;i<opts.currSlide;i++)
opts.els.push(opts.els.shift());opts.fxFn=function(curr,next,opts,cb,fwd){if(opts.rev)
fwd=!fwd;var $el=fwd?$(curr):$(next);$(next).css(opts.cssBefore);var count=opts.slideCount;$el.animate(opts.shuffle,opts.speedIn,opts.easeIn,function(){var hops=$.fn.cycle.hopsFromLast(opts,fwd);for(var k=0;k<hops;k++){if(fwd)
opts.els.push(opts.els.shift());else
opts.els.unshift(opts.els.pop());}
if(fwd){for(var i=0,len=opts.els.length;i<len;i++)
$(opts.els[i]).css('z-index',len-i+count);}
else{var z=$(curr).css('z-index');$el.css('z-index',parseInt(z,10)+1+count);}
$el.animate({left:0,top:0},opts.speedOut,opts.easeOut,function(){$(fwd?this:curr).hide();if(cb)cb();});});};$.extend(opts.cssBefore,{display:'block',opacity:1,top:0,left:0});};$.fn.cycle.transitions.turnUp=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,false);opts.cssBefore.top=next.cycleH;opts.animIn.height=next.cycleH;opts.animOut.width=next.cycleW;});opts.cssFirst.top=0;opts.cssBefore.left=0;opts.cssBefore.height=0;opts.animIn.top=0;opts.animOut.height=0;};$.fn.cycle.transitions.turnDown=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,false);opts.animIn.height=next.cycleH;opts.animOut.top=curr.cycleH;});opts.cssFirst.top=0;opts.cssBefore.left=0;opts.cssBefore.top=0;opts.cssBefore.height=0;opts.animOut.height=0;};$.fn.cycle.transitions.turnLeft=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,false,true);opts.cssBefore.left=next.cycleW;opts.animIn.width=next.cycleW;});opts.cssBefore.top=0;opts.cssBefore.width=0;opts.animIn.left=0;opts.animOut.width=0;};$.fn.cycle.transitions.turnRight=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,false,true);opts.animIn.width=next.cycleW;opts.animOut.left=curr.cycleW;});$.extend(opts.cssBefore,{top:0,left:0,width:0});opts.animIn.left=0;opts.animOut.width=0;};$.fn.cycle.transitions.zoom=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,false,false,true);opts.cssBefore.top=next.cycleH/2;opts.cssBefore.left=next.cycleW/2;$.extend(opts.animIn,{top:0,left:0,width:next.cycleW,height:next.cycleH});$.extend(opts.animOut,{width:0,height:0,top:curr.cycleH/2,left:curr.cycleW/2});});opts.cssFirst.top=0;opts.cssFirst.left=0;opts.cssBefore.width=0;opts.cssBefore.height=0;};$.fn.cycle.transitions.fadeZoom=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,false,false);opts.cssBefore.left=next.cycleW/2;opts.cssBefore.top=next.cycleH/2;$.extend(opts.animIn,{top:0,left:0,width:next.cycleW,height:next.cycleH});});opts.cssBefore.width=0;opts.cssBefore.height=0;opts.animOut.opacity=0;};$.fn.cycle.transitions.blindX=function($cont,$slides,opts){var w=$cont.css('overflow','hidden').width();opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts);opts.animIn.width=next.cycleW;opts.animOut.left=curr.cycleW;});opts.cssBefore.left=w;opts.cssBefore.top=0;opts.animIn.left=0;opts.animOut.left=w;};$.fn.cycle.transitions.blindY=function($cont,$slides,opts){var h=$cont.css('overflow','hidden').height();opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts);opts.animIn.height=next.cycleH;opts.animOut.top=curr.cycleH;});opts.cssBefore.top=h;opts.cssBefore.left=0;opts.animIn.top=0;opts.animOut.top=h;};$.fn.cycle.transitions.blindZ=function($cont,$slides,opts){var h=$cont.css('overflow','hidden').height();var w=$cont.width();opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts);opts.animIn.height=next.cycleH;opts.animOut.top=curr.cycleH;});opts.cssBefore.top=h;opts.cssBefore.left=w;opts.animIn.top=0;opts.animIn.left=0;opts.animOut.top=h;opts.animOut.left=w;};$.fn.cycle.transitions.growX=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,false,true);opts.cssBefore.left=this.cycleW/2;opts.animIn.left=0;opts.animIn.width=this.cycleW;opts.animOut.left=0;});opts.cssBefore.top=0;opts.cssBefore.width=0;};$.fn.cycle.transitions.growY=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,false);opts.cssBefore.top=this.cycleH/2;opts.animIn.top=0;opts.animIn.height=this.cycleH;opts.animOut.top=0;});opts.cssBefore.height=0;opts.cssBefore.left=0;};$.fn.cycle.transitions.curtainX=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,false,true,true);opts.cssBefore.left=next.cycleW/2;opts.animIn.left=0;opts.animIn.width=this.cycleW;opts.animOut.left=curr.cycleW/2;opts.animOut.width=0;});opts.cssBefore.top=0;opts.cssBefore.width=0;};$.fn.cycle.transitions.curtainY=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,false,true);opts.cssBefore.top=next.cycleH/2;opts.animIn.top=0;opts.animIn.height=next.cycleH;opts.animOut.top=curr.cycleH/2;opts.animOut.height=0;});opts.cssBefore.height=0;opts.cssBefore.left=0;};$.fn.cycle.transitions.cover=function($cont,$slides,opts){var d=opts.direction||'left';var w=$cont.css('overflow','hidden').width();var h=$cont.height();opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts);if(d=='right')
opts.cssBefore.left=-w;else if(d=='up')
opts.cssBefore.top=h;else if(d=='down')
opts.cssBefore.top=-h;else
opts.cssBefore.left=w;});opts.animIn.left=0;opts.animIn.top=0;opts.cssBefore.top=0;opts.cssBefore.left=0;};$.fn.cycle.transitions.uncover=function($cont,$slides,opts){var d=opts.direction||'left';var w=$cont.css('overflow','hidden').width();var h=$cont.height();opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,true,true);if(d=='right')
opts.animOut.left=w;else if(d=='up')
opts.animOut.top=-h;else if(d=='down')
opts.animOut.top=h;else
opts.animOut.left=-w;});opts.animIn.left=0;opts.animIn.top=0;opts.cssBefore.top=0;opts.cssBefore.left=0;};$.fn.cycle.transitions.toss=function($cont,$slides,opts){var w=$cont.css('overflow','visible').width();var h=$cont.height();opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,true,true);if(!opts.animOut.left&&!opts.animOut.top)
$.extend(opts.animOut,{left:w*2,top:-h/2,opacity:0});else
opts.animOut.opacity=0;});opts.cssBefore.left=0;opts.cssBefore.top=0;opts.animIn.left=0;};$.fn.cycle.transitions.wipe=function($cont,$slides,opts){var w=$cont.css('overflow','hidden').width();var h=$cont.height();opts.cssBefore=opts.cssBefore||{};var clip;if(opts.clip){if(/l2r/.test(opts.clip))
clip='rect(0px 0px '+h+'px 0px)';else if(/r2l/.test(opts.clip))
clip='rect(0px '+w+'px '+h+'px '+w+'px)';else if(/t2b/.test(opts.clip))
clip='rect(0px '+w+'px 0px 0px)';else if(/b2t/.test(opts.clip))
clip='rect('+h+'px '+w+'px '+h+'px 0px)';else if(/zoom/.test(opts.clip)){var top=parseInt(h/2,10);var left=parseInt(w/2,10);clip='rect('+top+'px '+left+'px '+top+'px '+left+'px)';}}
opts.cssBefore.clip=opts.cssBefore.clip||clip||'rect(0px 0px 0px 0px)';var d=opts.cssBefore.clip.match(/(\d+)/g);var t=parseInt(d[0],10),r=parseInt(d[1],10),b=parseInt(d[2],10),l=parseInt(d[3],10);opts.before.push(function(curr,next,opts){if(curr==next)return;var $curr=$(curr),$next=$(next);$.fn.cycle.commonReset(curr,next,opts,true,true,false);opts.cssAfter.display='block';var step=1,count=parseInt((opts.speedIn/13),10)-1;(function f(){var tt=t?t-parseInt(step*(t/count),10):0;var ll=l?l-parseInt(step*(l/count),10):0;var bb=b<h?b+parseInt(step*((h-b)/count||1),10):h;var rr=r<w?r+parseInt(step*((w-r)/count||1),10):w;$next.css({clip:'rect('+tt+'px '+rr+'px '+bb+'px '+ll+'px)'});(step++<=count)?setTimeout(f,13):$curr.css('display','none');})();});$.extend(opts.cssBefore,{display:'block',opacity:1,top:0,left:0});opts.animIn={left:0};opts.animOut={left:0};};})(jQuery);
(function(a){var r=a.fn.domManip,d="_tmplitem",q=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,b={},f={},e,p={key:0,data:{}},i=0,c=0,l=[];function g(g,d,h,e){var c={data:e||(e===0||e===false)?e:d?d.data:{},_wrap:d?d._wrap:null,tmpl:null,parent:d||null,nodes:[],calls:u,nest:w,wrap:x,html:v,update:t};g&&a.extend(c,g,{nodes:[],parent:d});if(h){c.tmpl=h;c._ctnt=c._ctnt||c.tmpl(a,c);c.key=++i;(l.length?f:b)[i]=c}return c}a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(f,d){a.fn[f]=function(n){var g=[],i=a(n),k,h,m,l,j=this.length===1&&this[0].parentNode;e=b||{};if(j&&j.nodeType===11&&j.childNodes.length===1&&i.length===1){i[d](this[0]);g=this}else{for(h=0,m=i.length;h<m;h++){c=h;k=(h>0?this.clone(true):this).get();a(i[h])[d](k);g=g.concat(k)}c=0;g=this.pushStack(g,f,i.selector)}l=e;e=null;a.tmpl.complete(l);return g}});a.fn.extend({tmpl:function(d,c,b){return a.tmpl(this[0],d,c,b)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(d,m,k){if(d[0]&&a.isArray(d[0])){var g=a.makeArray(arguments),h=d[0],j=h.length,i=0,f;while(i<j&&!(f=a.data(h[i++],"tmplItem")));if(f&&c)g[2]=function(b){a.tmpl.afterManip(this,b,k)};r.apply(this,g)}else r.apply(this,arguments);c=0;!e&&a.tmpl.complete(b);return this}});a.extend({tmpl:function(d,h,e,c){var i,k=!c;if(k){c=p;d=a.template[d]||a.template(null,d);f={}}else if(!d){d=c.tmpl;b[c.key]=c;c.nodes=[];c.wrapped&&n(c,c.wrapped);return a(j(c,null,c.tmpl(a,c)))}if(!d)return[];if(typeof h==="function")h=h.call(c||{});e&&e.wrapped&&n(e,e.wrapped);i=a.isArray(h)?a.map(h,function(a){return a?g(e,c,d,a):null}):[g(e,c,d,h)];return k?a(j(c,null,i)):i},tmplItem:function(b){var c;if(b instanceof a)b=b[0];while(b&&b.nodeType===1&&!(c=a.data(b,"tmplItem"))&&(b=b.parentNode));return c||p},template:function(c,b){if(b){if(typeof b==="string")b=o(b);else if(b instanceof a)b=b[0]||{};if(b.nodeType)b=a.data(b,"tmpl")||a.data(b,"tmpl",o(b.innerHTML));return typeof c==="string"?(a.template[c]=b):b}return c?typeof c!=="string"?a.template(null,c):a.template[c]||a.template(null,q.test(c)?c:a(c)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){b={}},afterManip:function(f,b,d){var e=b.nodeType===11?a.makeArray(b.childNodes):b.nodeType===1?[b]:[];d.call(f,b);m(e);c++}});function j(e,g,f){var b,c=f?a.map(f,function(a){return typeof a==="string"?e.key?a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+d+'="'+e.key+'" $2'):a:j(a,e,a._ctnt)}):e;if(g)return c;c=c.join("");c.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(f,c,e,d){b=a(e).get();m(b);if(c)b=k(c).concat(b);if(d)b=b.concat(k(d))});return b?b:k(c)}function k(c){var b=document.createElement("div");b.innerHTML=c;return a.makeArray(b.childNodes)}function o(b){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+a.trim(b).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(m,l,k,g,b,c,d){var j=a.tmpl.tag[k],i,e,f;if(!j)throw"Unknown template tag: "+k;i=j._default||[];if(c&&!/\w$/.test(b)){b+=c;c=""}if(b){b=h(b);d=d?","+h(d)+")":c?")":"";e=c?b.indexOf(".")>-1?b+h(c):"("+b+").call($item"+d:b;f=c?e:"(typeof("+b+")==='function'?("+b+").call($item):("+b+"))"}else f=e=i.$1||"null";g=h(g);return"');"+j[l?"close":"open"].split("$notnull_1").join(b?"typeof("+b+")!=='undefined' && ("+b+")!=null":"true").split("$1a").join(f).split("$1").join(e).split("$2").join(g||i.$2||"")+"__.push('"})+"');}return __;")}function n(c,b){c._wrap=j(c,true,a.isArray(b)?b:[q.test(b)?b:a(b).html()]).join("")}function h(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function s(b){var a=document.createElement("div");a.appendChild(b.cloneNode(true));return a.innerHTML}function m(o){var n="_"+c,k,j,l={},e,p,h;for(e=0,p=o.length;e<p;e++){if((k=o[e]).nodeType!==1)continue;j=k.getElementsByTagName("*");for(h=j.length-1;h>=0;h--)m(j[h]);m(k)}function m(j){var p,h=j,k,e,m;if(m=j.getAttribute(d)){while(h.parentNode&&(h=h.parentNode).nodeType===1&&!(p=h.getAttribute(d)));if(p!==m){h=h.parentNode?h.nodeType===11?0:h.getAttribute(d)||0:0;if(!(e=b[m])){e=f[m];e=g(e,b[h]||f[h]);e.key=++i;b[i]=e}c&&o(m)}j.removeAttribute(d)}else if(c&&(e=a.data(j,"tmplItem"))){o(e.key);b[e.key]=e;h=a.data(j.parentNode,"tmplItem");h=h?h.key:0}if(e){k=e;while(k&&k.key!=h){k.nodes.push(j);k=k.parent}delete e._ctnt;delete e._wrap;a.data(j,"tmplItem",e)}function o(a){a=a+n;e=l[a]=l[a]||g(e,b[e.parent.key+n]||e.parent)}}}function u(a,d,c,b){if(!a)return l.pop();l.push({_:a,tmpl:d,item:this,data:c,options:b})}function w(d,c,b){return a.tmpl(a.template(d),c,b,this)}function x(b,d){var c=b.options||{};c.wrapped=d;return a.tmpl(a.template(b.tmpl),b.data,c,b.item)}function v(d,c){var b=this._wrap;return a.map(a(a.isArray(b)?b.join(""):b).filter(d||"*"),function(a){return c?a.innerText||a.textContent:a.outerHTML||s(a)})}function t(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]);a(b).remove()}})(jQuery);;(function($){var helper={},current,title,tID,IE=$.browser.msie&&/MSIE\s(5\.5|6\.)/.test(navigator.userAgent),track=false;$.tooltip={blocked:false,defaults:{delay:200,fade:false,showURL:true,extraClass:"",top:15,left:15,id:"tooltip"},block:function(){$.tooltip.blocked=!$.tooltip.blocked;}};$.fn.extend({tooltip:function(settings){settings=$.extend({},$.tooltip.defaults,settings);createHelper(settings);return this.each(function(){$.data(this,"tooltip",settings);this.tOpacity=helper.parent.css("opacity");this.tooltipText=this.title;$(this).removeAttr("title");this.alt="";}).mouseover(save).mouseout(hide).click(hide);},fixPNG:IE?function(){return this.each(function(){var image=$(this).css('backgroundImage');if(image.match(/^url\(["']?(.*\.png)["']?\)$/i)){image=RegExp.$1;$(this).css({'backgroundImage':'none','filter':"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+image+"')"}).each(function(){var position=$(this).css('position');if(position!='absolute'&&position!='relative')$(this).css('position','relative');});}});}:function(){return this;},unfixPNG:IE?function(){return this.each(function(){$(this).css({'filter':'',backgroundImage:''});});}:function(){return this;},hideWhenEmpty:function(){return this.each(function(){$(this)[$(this).html()?"show":"hide"]();});},url:function(){return this.attr('href')||this.attr('src');}});function createHelper(settings){if(helper.parent)return;helper.parent=$('<div id="'+settings.id+'"><h3></h3><div class="body"></div><div class="url"></div></div>').appendTo(document.body).hide();if($.fn.bgiframe)helper.parent.bgiframe();helper.title=$('h3',helper.parent);helper.body=$('div.body',helper.parent);helper.url=$('div.url',helper.parent);}function settings(element){return $.data(element,"tooltip");}function handle(event){if(settings(this).delay)tID=setTimeout(show,settings(this).delay);else
show();track=!!settings(this).track;$(document.body).bind('mousemove',update);update(event);}function save(){if($.tooltip.blocked||this==current||(!this.tooltipText&&!settings(this).bodyHandler))return;current=this;title=this.tooltipText;if(settings(this).bodyHandler){helper.title.hide();var bodyContent=settings(this).bodyHandler.call(this);if(bodyContent.nodeType||bodyContent.jquery){helper.body.empty().append(bodyContent)}else{helper.body.html(bodyContent);}helper.body.show();}else if(settings(this).showBody){var parts=title.split(settings(this).showBody);helper.title.html(parts.shift()).show();helper.body.empty();for(var i=0,part;(part=parts[i]);i++){if(i>0)helper.body.append("<br/>");helper.body.append(part);}helper.body.hideWhenEmpty();}else{helper.title.html(title).show();helper.body.hide();}if(settings(this).showURL&&$(this).url())helper.url.html($(this).url().replace('http://','')).show();else
helper.url.hide();helper.parent.addClass(settings(this).extraClass);if(settings(this).fixPNG)helper.parent.fixPNG();handle.apply(this,arguments);}function show(){tID=null;if((!IE||!$.fn.bgiframe)&&settings(current).fade){if(helper.parent.is(":animated"))helper.parent.stop().show().fadeTo(settings(current).fade,current.tOpacity);else
helper.parent.is(':visible')?helper.parent.fadeTo(settings(current).fade,current.tOpacity):helper.parent.fadeIn(settings(current).fade);}else{helper.parent.show();}update();}function update(event){if($.tooltip.blocked)return;if(event&&event.target.tagName=="OPTION"){return;}if(!track&&helper.parent.is(":visible")){$(document.body).unbind('mousemove',update)}if(current==null){$(document.body).unbind('mousemove',update);return;}helper.parent.removeClass("viewport-right").removeClass("viewport-bottom");var left=helper.parent[0].offsetLeft;var top=helper.parent[0].offsetTop;if(event){left=event.pageX+settings(current).left;top=event.pageY+settings(current).top;var right='auto';if(settings(current).positionLeft){right=$(window).width()-left;left='auto';}helper.parent.css({left:left,right:right,top:top});}var v=viewport(),h=helper.parent[0];if(v.x+v.cx<h.offsetLeft+h.offsetWidth){left-=h.offsetWidth+20+settings(current).left;helper.parent.css({left:left+'px'}).addClass("viewport-right");}if(v.y+v.cy<h.offsetTop+h.offsetHeight){top-=h.offsetHeight+20+settings(current).top;helper.parent.css({top:top+'px'}).addClass("viewport-bottom");}}function viewport(){return{x:$(window).scrollLeft(),y:$(window).scrollTop(),cx:$(window).width(),cy:$(window).height()};}function hide(event){if($.tooltip.blocked)return;if(tID)clearTimeout(tID);current=null;var tsettings=settings(this);function complete(){helper.parent.removeClass(tsettings.extraClass).hide().css("opacity","");}if((!IE||!$.fn.bgiframe)&&tsettings.fade){if(helper.parent.is(':animated'))helper.parent.stop().fadeTo(tsettings.fade,0,complete);else
helper.parent.stop().fadeOut(tsettings.fade,complete);}else
complete();if(settings(this).fixPNG)helper.parent.unfixPNG();}})(jQuery);(function(c){c.extend(c.fn,{validate:function(a){if(this.length){var b=c.data(this[0],"validator");if(b)return b;this.attr("novalidate","novalidate");b=new c.validator(a,this[0]);c.data(this[0],"validator",b);if(b.settings.onsubmit){a=this.find("input, button");a.filter(".cancel").click(function(){b.cancelSubmit=true});b.settings.submitHandler&&a.filter(":submit").click(function(){b.submitButton=this});this.submit(function(d){function e(){if(b.settings.submitHandler){if(b.submitButton)var f=c("<input type='hidden'/>").attr("name",b.submitButton.name).val(b.submitButton.value).appendTo(b.currentForm);b.settings.submitHandler.call(b,b.currentForm);b.submitButton&&f.remove();return false}return true}b.settings.debug&&d.preventDefault();if(b.cancelSubmit){b.cancelSubmit=false;return e()}if(b.form()){if(b.pendingRequest){b.formSubmitted=true;return false}return e()}else{b.focusInvalid();return false}})}return b}else a&&a.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing")},valid:function(){if(c(this[0]).is("form"))return this.validate().form();else{var a=true,b=c(this[0].form).validate();this.each(function(){a&=b.element(this)});return a}},removeAttrs:function(a){var b={},d=this;c.each(a.split(/\s/),function(e,f){b[f]=d.attr(f);d.removeAttr(f)});return b},rules:function(a,b){var d=this[0];if(a){var e=c.data(d.form,"validator").settings,f=e.rules,g=c.validator.staticRules(d);switch(a){case"add":c.extend(g,c.validator.normalizeRule(b));f[d.name]=g;if(b.messages)e.messages[d.name]=c.extend(e.messages[d.name],b.messages);break;case"remove":if(!b){delete f[d.name];return g}var h={};c.each(b.split(/\s/),function(j,i){h[i]=g[i];delete g[i]});return h}}d=c.validator.normalizeRules(c.extend({},c.validator.metadataRules(d),c.validator.classRules(d),c.validator.attributeRules(d),c.validator.staticRules(d)),d);if(d.required){e=d.required;delete d.required;d=c.extend({required:e},d)}return d}});c.extend(c.expr[":"],{blank:function(a){return!c.trim(""+a.value)},filled:function(a){return!!c.trim(""+a.value)},unchecked:function(a){return!a.checked}});c.validator=function(a,b){this.settings=c.extend(true,{},c.validator.defaults,a);this.currentForm=b;this.init()};c.validator.format=function(a,b){if(arguments.length==1)return function(){var d=c.makeArray(arguments);d.unshift(a);return c.validator.format.apply(this,d)};if(arguments.length>2&&b.constructor!=Array)b=c.makeArray(arguments).slice(1);if(b.constructor!=Array)b=[b];c.each(b,function(d,e){a=a.replace(RegExp("\\{"+d+"\\}","g"),e)});return a};c.extend(c.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:c([]),errorLabelContainer:c([]),onsubmit:true,ignore:":hidden",ignoreTitle:false,onfocusin:function(a){this.lastActive=a;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass);this.addWrapper(this.errorsFor(a)).hide()}},onfocusout:function(a){if(!this.checkable(a)&&(a.name in this.submitted||!this.optional(a)))this.element(a)},onkeyup:function(a){if(a.name in this.submitted||a==this.lastElement)this.element(a)},onclick:function(a){if(a.name in this.submitted)this.element(a);else a.parentNode.name in this.submitted&&this.element(a.parentNode)},highlight:function(a,b,d){a.type==="radio"?this.findByName(a.name).addClass(b).removeClass(d):c(a).addClass(b).removeClass(d)},unhighlight:function(a,b,d){a.type==="radio"?this.findByName(a.name).removeClass(b).addClass(d):c(a).removeClass(b).addClass(d)}},setDefaults:function(a){c.extend(c.validator.defaults,a)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:c.validator.format("Please enter no more than {0} characters."),minlength:c.validator.format("Please enter at least {0} characters."),rangelength:c.validator.format("Please enter a value between {0} and {1} characters long."),range:c.validator.format("Please enter a value between {0} and {1}."),max:c.validator.format("Please enter a value less than or equal to {0}."),min:c.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){function a(e){var f=c.data(this[0].form,"validator"),g="on"+e.type.replace(/^validate/,"");f.settings[g]&&f.settings[g].call(f,this[0],e)}this.labelContainer=c(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||c(this.currentForm);this.containers=c(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var b=this.groups={};c.each(this.settings.groups,function(e,f){c.each(f.split(/\s/),function(g,h){b[h]=e})});var d=this.settings.rules;c.each(d,function(e,f){d[e]=c.validator.normalizeRule(f)});c(this.currentForm).validateDelegate("[type='text'], [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",a).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",a);this.settings.invalidHandler&&c(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){this.checkForm();c.extend(this.submitted,this.errorMap);this.invalid=c.extend({},this.errorMap);this.valid()||c(this.currentForm).triggerHandler("invalid-form",[this]);this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=this.currentElements=this.elements();b[a];a++)this.check(b[a]);return this.valid()},element:function(a){this.lastElement=a=this.validationTargetFor(this.clean(a));this.prepareElement(a);this.currentElements=c(a);var b=this.check(a);if(b)delete this.invalid[a.name];else this.invalid[a.name]=true;if(!this.numberOfInvalids())this.toHide=this.toHide.add(this.containers);this.showErrors();return b},showErrors:function(a){if(a){c.extend(this.errorMap,a);this.errorList=[];for(var b in a)this.errorList.push({message:a[b],element:this.findByName(b)[0]});this.successList=c.grep(this.successList,function(d){return!(d.name in a)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){c.fn.resetForm&&c(this.currentForm).resetForm();this.submitted={};this.lastElement=null;this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(a){var b=0,d;for(d in a)b++;return b},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{c(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(a){}},findLastActive:function(){var a=this.lastActive;return a&&c.grep(this.errorList,function(b){return b.element.name==a.name}).length==1&&a},elements:function(){var a=this,b={};return c(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&a.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in b||!a.objectLength(c(this).rules()))return false;return b[this.name]=true})},clean:function(a){return c(a)[0]},errors:function(){return c(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=c([]);this.toHide=c([]);this.currentElements=c([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(a){this.reset();this.toHide=this.errorsFor(a)},check:function(a){a=this.validationTargetFor(this.clean(a));var b=c(a).rules(),d=false,e;for(e in b){var f={method:e,parameters:b[e]};try{var g=c.validator.methods[e].call(this,a.value.replace(/\r/g,""),a,f.parameters);if(g=="dependency-mismatch")d=true;else{d=false;if(g=="pending"){this.toHide=this.toHide.not(this.errorsFor(a));return}if(!g){this.formatAndAdd(a,f);return false}}}catch(h){this.settings.debug&&window.console&&console.log("exception occured when checking element "+
a.id+", check the '"+f.method+"' method",h);throw h;}}if(!d){this.objectLength(b)&&this.successList.push(a);return true}},customMetaMessage:function(a,b){if(c.metadata){var d=this.settings.meta?c(a).metadata()[this.settings.meta]:c(a).metadata();return d&&d.messages&&d.messages[b]}},customMessage:function(a,b){var d=this.settings.messages[a];return d&&(d.constructor==String?d:d[b])},findDefined:function(){for(var a=0;a<arguments.length;a++)if(arguments[a]!==undefined)return arguments[a]},defaultMessage:function(a,b){return this.findDefined(this.customMessage(a.name,b),this.customMetaMessage(a,b),!this.settings.ignoreTitle&&a.title||undefined,c.validator.messages[b],"<strong>Warning: No message defined for "+a.name+"</strong>")},formatAndAdd:function(a,b){var d=this.defaultMessage(a,b.method),e=/\$?\{(\d+)\}/g;if(typeof d=="function")d=d.call(this,b.parameters,a);else if(e.test(d))d=jQuery.format(d.replace(e,"{$1}"),b.parameters);this.errorList.push({message:d,element:a});this.errorMap[a.name]=d;this.submitted[a.name]=d},addWrapper:function(a){if(this.settings.wrapper)a=a.add(a.parent(this.settings.wrapper));return a},defaultShowErrors:function(){for(var a=0;this.errorList[a];a++){var b=this.errorList[a];this.settings.highlight&&this.settings.highlight.call(this,b.element,this.settings.errorClass,this.settings.validClass);this.showLabel(b.element,b.message)}if(this.errorList.length)this.toShow=this.toShow.add(this.containers);if(this.settings.success)for(a=0;this.successList[a];a++)this.showLabel(this.successList[a]);if(this.settings.unhighlight){a=0;for(b=this.validElements();b[a];a++)this.settings.unhighlight.call(this,b[a],this.settings.errorClass,this.settings.validClass)}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return c(this.errorList).map(function(){return this.element})},showLabel:function(a,b){var d=this.errorsFor(a);if(d.length){d.removeClass(this.settings.validClass).addClass(this.settings.errorClass);d.attr("generated")&&d.html(b)}else{d=c("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(a),generated:true}).addClass(this.settings.errorClass).html(b||"");if(this.settings.wrapper)d=d.hide().show().wrap("<"+this.settings.wrapper+"/>").parent();this.labelContainer.append(d).length||(this.settings.errorPlacement?this.settings.errorPlacement(d,c(a)):d.insertAfter(a))}if(!b&&this.settings.success){d.text("");typeof this.settings.success=="string"?d.addClass(this.settings.success):this.settings.success(d)}this.toShow=this.toShow.add(d)},errorsFor:function(a){var b=this.idOrName(a);return this.errors().filter(function(){return c(this).attr("for")==b})},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(a){if(this.checkable(a))a=this.findByName(a.name).not(this.settings.ignore)[0];return a},checkable:function(a){return/radio|checkbox/i.test(a.type)},findByName:function(a){var b=this.currentForm;return c(document.getElementsByName(a)).map(function(d,e){return e.form==b&&e.name==a&&e||null})},getLength:function(a,b){switch(b.nodeName.toLowerCase()){case"select":return c("option:selected",b).length;case"input":if(this.checkable(b))return this.findByName(b.name).filter(":checked").length}return a.length},depend:function(a,b){return this.dependTypes[typeof a]?this.dependTypes[typeof a](a,b):true},dependTypes:{"boolean":function(a){return a},string:function(a,b){return!!c(a,b.form).length},"function":function(a,b){return a(b)}},optional:function(a){return!c.validator.methods.required.call(this,c.trim(a.value),a)&&"dependency-mismatch"},startRequest:function(a){if(!this.pending[a.name]){this.pendingRequest++;this.pending[a.name]=true}},stopRequest:function(a,b){this.pendingRequest--;if(this.pendingRequest<0)this.pendingRequest=0;delete this.pending[a.name];if(b&&this.pendingRequest==0&&this.formSubmitted&&this.form()){c(this.currentForm).submit();this.formSubmitted=false}else if(!b&&this.pendingRequest==0&&this.formSubmitted){c(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false}},previousValue:function(a){return c.data(a,"previousValue")||c.data(a,"previousValue",{old:null,valid:true,message:this.defaultMessage(a,"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(a,b){a.constructor==String?this.classRuleSettings[a]=b:c.extend(this.classRuleSettings,a)},classRules:function(a){var b={};(a=c(a).attr("class"))&&c.each(a.split(" "),function(){this in c.validator.classRuleSettings&&c.extend(b,c.validator.classRuleSettings[this])});return b},attributeRules:function(a){var b={};a=c(a);for(var d in c.validator.methods){var e;if(e=d==="required"&&typeof c.fn.prop==="function"?a.prop(d):a.attr(d))b[d]=e;else if(a[0].getAttribute("type")===d)b[d]=true}b.maxlength&&/-1|2147483647|524288/.test(b.maxlength)&&delete b.maxlength;return b},metadataRules:function(a){if(!c.metadata)return{};var b=c.data(a.form,"validator").settings.meta;return b?c(a).metadata()[b]:c(a).metadata()},staticRules:function(a){var b={},d=c.data(a.form,"validator");if(d.settings.rules)b=c.validator.normalizeRule(d.settings.rules[a.name])||{};return b},normalizeRules:function(a,b){c.each(a,function(d,e){if(e===false)delete a[d];else if(e.param||e.depends){var f=true;switch(typeof e.depends){case"string":f=!!c(e.depends,b.form).length;break;case"function":f=e.depends.call(b,b)}if(f)a[d]=e.param!==undefined?e.param:true;else delete a[d]}});c.each(a,function(d,e){a[d]=c.isFunction(e)?e(b):e});c.each(["minlength","maxlength","min","max"],function(){if(a[this])a[this]=Number(a[this])});c.each(["rangelength","range"],function(){if(a[this])a[this]=[Number(a[this][0]),Number(a[this][1])]});if(c.validator.autoCreateRanges){if(a.min&&a.max){a.range=[a.min,a.max];delete a.min;delete a.max}if(a.minlength&&a.maxlength){a.rangelength=[a.minlength,a.maxlength];delete a.minlength;delete a.maxlength}}a.messages&&delete a.messages;return a},normalizeRule:function(a){if(typeof a=="string"){var b={};c.each(a.split(/\s/),function(){b[this]=true});a=b}return a},addMethod:function(a,b,d){c.validator.methods[a]=b;c.validator.messages[a]=d!=undefined?d:c.validator.messages[a];b.length<3&&c.validator.addClassRules(a,c.validator.normalizeRule(a))},methods:{required:function(a,b,d){if(!this.depend(d,b))return"dependency-mismatch";switch(b.nodeName.toLowerCase()){case"select":return(a=c(b).val())&&a.length>0;case"input":if(this.checkable(b))return this.getLength(a,b)>0;default:return c.trim(a).length>0}},remote:function(a,b,d){if(this.optional(b))return"dependency-mismatch";var e=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});e.originalMessage=this.settings.messages[b.name].remote;this.settings.messages[b.name].remote=e.message;d=typeof d=="string"&&{url:d}||d;if(this.pending[b.name])return"pending";if(e.old===a)return e.valid;e.old=a;var f=this;this.startRequest(b);var g={};g[b.name]=a;c.ajax(c.extend(true,{url:d,mode:"abort",port:"validate"+b.name,dataType:"json",data:g,success:function(h){f.settings.messages[b.name].remote=e.originalMessage;var j=h===true;if(j){var i=f.formSubmitted;f.prepareElement(b);f.formSubmitted=i;f.successList.push(b);f.showErrors()}else{i={};h=h||f.defaultMessage(b,"remote");i[b.name]=e.message=c.isFunction(h)?h(a):h;f.showErrors(i)}e.valid=j;f.stopRequest(b,j)}},d));return"pending"},minlength:function(a,b,d){return this.optional(b)||this.getLength(c.trim(a),b)>=d},maxlength:function(a,b,d){return this.optional(b)||this.getLength(c.trim(a),b)<=d},rangelength:function(a,b,d){a=this.getLength(c.trim(a),b);return this.optional(b)||a>=d[0]&&a<=d[1]},min:function(a,b,d){return this.optional(b)||a>=d},max:function(a,b,d){return this.optional(b)||a<=d},range:function(a,b,d){return this.optional(b)||a>=d[0]&&a<=d[1]},email:function(a,b){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},url:function(a,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},date:function(a,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(a))},dateISO:function(a,b){return this.optional(b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},number:function(a,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(a)},digits:function(a,b){return this.optional(b)||/^\d+$/.test(a)},creditcard:function(a,b){if(this.optional(b))return"dependency-mismatch";if(/[^0-9 -]+/.test(a))return false;var d=0,e=0,f=false;a=a.replace(/\D/g,"");for(var g=a.length-1;g>=0;g--){e=a.charAt(g);e=parseInt(e,10);if(f)if((e*=2)>9)e-=9;d+=e;f=!f}return d%10==0},accept:function(a,b,d){d=typeof d=="string"?d.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(b)||a.match(RegExp(".("+d+")$","i"))},equalTo:function(a,b,d){d=c(d).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){c(b).valid()});return a==d.val()}}});c.format=c.validator.format})(jQuery);(function(c){var a={};if(c.ajaxPrefilter)c.ajaxPrefilter(function(d,e,f){e=d.port;if(d.mode=="abort"){a[e]&&a[e].abort();a[e]=f}});else{var b=c.ajax;c.ajax=function(d){var e=("port"in d?d:c.ajaxSettings).port;if(("mode"in d?d:c.ajaxSettings).mode=="abort"){a[e]&&a[e].abort();return a[e]=b.apply(this,arguments)}return b.apply(this,arguments)}}})(jQuery);(function(c){!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener&&c.each({focus:"focusin",blur:"focusout"},function(a,b){function d(e){e=c.event.fix(e);e.type=b;return c.event.handle.call(this,e)}c.event.special[b]={setup:function(){this.addEventListener(a,d,true)},teardown:function(){this.removeEventListener(a,d,true)},handler:function(e){arguments[0]=c.event.fix(e);arguments[0].type=b;return c.event.handle.apply(this,arguments)}}});c.extend(c.fn,{validateDelegate:function(a,b,d){return this.bind(b,function(e){var f=c(e.target);if(f.is(a))return d.apply(f,arguments)})}})})(jQuery);(function(a){var d=a.validator,b,e="unobtrusiveValidation";function c(a,b,c){a.rules[b]=c;if(a.message)a.messages[b]=a.message}function j(a){return a.replace(/^\s+|\s+$/g,"").split(/\s*,\s*/g)}function f(a){return a.replace(/([!"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])/g,"\\$1")}function h(a){return a.substr(0,a.lastIndexOf(".")+1)}function g(a,b){if(a.indexOf("*.")===0)a=a.replace("*.",b);return a}function m(c,d){var b=a(this).find("[data-valmsg-for='"+f(d[0].name)+"']"),e=a.parseJSON(b.attr("data-valmsg-replace"))!==false;b.removeClass("field-validation-valid").addClass("field-validation-error");c.data("unobtrusiveContainer",b);if(e){b.empty();c.removeClass("input-validation-error").appendTo(b)}else c.hide()}function l(e,d){var c=a(this).find("[data-valmsg-summary=true]"),b=c.find("ul");if(b&&b.length&&d.errorList.length){b.empty();c.addClass("validation-summary-errors").removeClass("validation-summary-valid");a.each(d.errorList,function(){a("<li />").html(this.message).appendTo(b)})}}function k(c){var b=c.data("unobtrusiveContainer"),d=a.parseJSON(b.attr("data-valmsg-replace"));if(b){b.addClass("field-validation-valid").removeClass("field-validation-error");c.removeData("unobtrusiveContainer");d&&b.empty()}}function n(){var b=a(this);b.data("validator").resetForm();b.find(".validation-summary-errors").addClass("validation-summary-valid").removeClass("validation-summary-errors");b.find(".field-validation-error").addClass("field-validation-valid").removeClass("field-validation-error").removeData("unobtrusiveContainer").find(">*").removeData("unobtrusiveContainer")}function i(c){var b=a(c),d=b.data(e),f=a.proxy(n,c);if(!d){d={options:{errorClass:"input-validation-error",errorElement:"span",errorPlacement:a.proxy(m,c),invalidHandler:a.proxy(l,c),messages:{},rules:{},success:a.proxy(k,c)},attachValidation:function(){b.unbind("reset."+e,f).bind("reset."+e,f).validate(this.options)},validate:function(){b.validate();return b.valid()}};b.data(e,d)}return d}d.unobtrusive={adapters:[],parseElement:function(b,h){var d=a(b),f=d.parents("form")[0],c,e,g;if(!f)return;c=i(f);c.options.rules[b.name]=e={};c.options.messages[b.name]=g={};a.each(this.adapters,function(){var c="data-val-"+this.name,i=d.attr(c),h={};if(i!==undefined){c+="-";a.each(this.params,function(){h[this]=d.attr(c+this)});this.adapt({element:b,form:f,message:i,params:h,rules:e,messages:g})}});a.extend(e,{__dummy__:true});!h&&c.attachValidation()},parse:function(b){var c=a(b).parents("form").andSelf().add(a(b).find("form")).filter("form");a(b).find(":input[data-val=true]").each(function(){d.unobtrusive.parseElement(this,true)});c.each(function(){var a=i(this);a&&a.attachValidation()})}};b=d.unobtrusive.adapters;b.add=function(c,a,b){if(!b){b=a;a=[]}this.push({name:c,params:a,adapt:b});return this};b.addBool=function(a,b){return this.add(a,function(d){c(d,b||a,true)})};b.addMinMax=function(e,g,f,a,d,b){return this.add(e,[d||"min",b||"max"],function(b){var e=b.params.min,d=b.params.max;if(e&&d)c(b,a,[e,d]);else if(e)c(b,g,e);else d&&c(b,f,d)})};b.addSingleVal=function(a,b,d){return this.add(a,[b||"val"],function(e){c(e,d||a,e.params[b])})};d.addMethod("__dummy__",function(){return true});d.addMethod("regex",function(b,c,d){var a;if(this.optional(c))return true;a=(new RegExp(d)).exec(b);return a&&a.index===0&&a[0].length===b.length});b.addSingleVal("accept","exts").addSingleVal("regex","pattern");b.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url");b.addMinMax("length","minlength","maxlength","rangelength").addMinMax("range","min","max","range");b.add("equalto",["other"],function(b){var i=h(b.element.name),j=b.params.other,d=g(j,i),e=a(b.form).find(":input[name='"+f(d)+"']")[0];c(b,"equalTo",e)});b.add("required",function(a){(a.element.tagName.toUpperCase()!=="INPUT"||a.element.type.toUpperCase()!=="CHECKBOX")&&c(a,"required",true)});b.add("remote",["url","type","additionalfields"],function(b){var d={url:b.params.url,type:b.params.type||"GET",data:{}},e=h(b.element.name);a.each(j(b.params.additionalfields||b.element.name),function(i,h){var c=g(h,e);d.data[c]=function(){return a(b.form).find(":input[name='"+f(c)+"']").val()}});c(b,"remote",d)});a(function(){d.unobtrusive.parse(document)})})(jQuery);(function(j){function A(a){return a.replace(B,h).replace(C,function(a,d,b){for(var a=b.split(","),b=0,e=a.length;b<e;b++){var s=D(a[b].replace(E,h).replace(F,h))+o,l=[];a[b]=s.replace(G,function(a,b,c,d,e){if(b){if(l.length>0){var a=l,f,e=s.substring(0,e).replace(H,i);if(e==i||e.charAt(e.length-1)==o)e+="*";try{f=t(e)}catch(k){}if(f){e=0;for(c=f.length;e<c;e++){for(var d=f[e],h=d.className,j=0,m=a.length;j<m;j++){var g=a[j];if(!RegExp("(^|\\s)"+g.className+"(\\s|$)").test(d.className)&&g.b&&(g.b===!0||g.b(d)===!0))h=u(h,g.className,!0)}d.className=h}}l=[]}return b}else{if(b=c?I(c):!v||v.test(d)?{className:w(d),b:!0}:null)return l.push(b),"."+b.className;return a}})}return d+a.join(",")})}function I(a){var c=!0,d=w(a.slice(1)),b=a.substring(0,5)==":not(",e,f;b&&(a=a.slice(5,-1));var l=a.indexOf("(");l>-1&&(a=a.substring(0,l));if(a.charAt(0)==":")switch(a.slice(1)){case"root":c=function(a){return b?a!=p:a==p};break;case"target":if(m==8){c=function(a){function c(){var d=location.hash,e=d.slice(1);return b?d==i||a.id!=e:d!=i&&a.id==e}k(j,"hashchange",function(){g(a,d,c())});return c()};break}return!1;case"checked":c=function(a){J.test(a.type)&&k(a,"propertychange",function(){event.propertyName=="checked"&&g(a,d,a.checked!==b)});return a.checked!==b};break;case"disabled":b=!b;case"enabled":c=function(c){if(K.test(c.tagName))return k(c,"propertychange",function(){event.propertyName=="$disabled"&&g(c,d,c.a===b)}),q.push(c),c.a=c.disabled,c.disabled===b;return a==":enabled"?b:!b};break;case"focus":e="focus",f="blur";case"hover":e||(e="mouseenter",f="mouseleave");c=function(a){k(a,b?f:e,function(){g(a,d,!0)});k(a,b?e:f,function(){g(a,d,!1)});return b};break;default:if(!L.test(a))return!1}return{className:d,b:c}}function w(a){return M+"-"+(m==6&&N?O++:a.replace(P,function(a){return a.charCodeAt(0)}))}function D(a){return a.replace(x,h).replace(Q,o)}function g(a,c,d){var b=a.className,c=u(b,c,d);if(c!=b)a.className=c,a.parentNode.className+=i}function u(a,c,d){var b=RegExp("(^|\\s)"+c+"(\\s|$)"),e=b.test(a);return d?e?a:a+o+c:e?a.replace(b,h).replace(x,h):a}function k(a,c,d){a.attachEvent("on"+c,d)}function r(a,c){if(/^https?:\/\//i.test(a))return c.substring(0,c.indexOf("/",8))==a.substring(0,a.indexOf("/",8))?a:null;if(a.charAt(0)=="/")return c.substring(0,c.indexOf("/",8))+a;var d=c.split(/[?#]/)[0];a.charAt(0)!="?"&&d.charAt(d.length-1)!="/"&&(d=d.substring(0,d.lastIndexOf("/")+1));return d+a}function y(a){if(a)return n.open("GET",a,!1),n.send(),(n.status==200?n.responseText:i).replace(R,i).replace(S,function(c,d,b,e,f){return y(r(b||f,a))}).replace(T,function(c,d,b){d=d||i;return" url("+d+r(b,a)+d+") "});return i}function U(){var a,c;a=f.getElementsByTagName("BASE");for(var d=a.length>0?a[0].href:f.location.href,b=0;b<f.styleSheets.length;b++)if(c=f.styleSheets[b],c.href!=i&&(a=r(c.href,d)))c.cssText=A(y(a));q.length>0&&setInterval(function(){for(var a=0,c=q.length;a<c;a++){var b=q[a];if(b.disabled!==b.a)b.disabled?(b.disabled=!1,b.a=!0,b.disabled=!0):b.a=b.disabled}},250)}if(!true){var f=document,p=f.documentElement,n=function(){if(j.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){return null}}(),m=/MSIE (\d+)/.exec(navigator.userAgent)[1];if(!(f.compatMode!="CSS1Compat"||m<6||m>8||!n)){var z={NW:"*.Dom.select",MooTools:"$$",DOMAssistant:"*.$",Prototype:"$$",YAHOO:"*.util.Selector.query",Sizzle:"*",jQuery:"*",dojo:"*.query"},t,q=[],O=0,N=!0,M="slvzr",R=/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)\s*/g,S=/@import\s*(?:(?:(?:url\(\s*(['"]?)(.*)\1)\s*\))|(?:(['"])(.*)\3))[^;]*;/g,T=/\burl\(\s*(["']?)(?!data:)([^"')]+)\1\s*\)/g,L=/^:(empty|(first|last|only|nth(-last)?)-(child|of-type))$/,B=/:(:first-(?:line|letter))/g,C=/(^|})\s*([^\{]*?[\[:][^{]+)/g,G=/([ +~>])|(:[a-z-]+(?:\(.*?\)+)?)|(\[.*?\])/g,H=/(:not\()?:(hover|enabled|disabled|focus|checked|target|active|visited|first-line|first-letter)\)?/g,P=/[^\w-]/g,K=/^(INPUT|SELECT|TEXTAREA|BUTTON)$/,J=/^(checkbox|radio)$/,v=m>6?/[\$\^*]=(['"])\1/:null,E=/([(\[+~])\s+/g,F=/\s+([)\]+~])/g,Q=/\s+/g,x=/^\s*((?:[\S\s]*\S)?)\s*$/,i="",o=" ",h="$1";(function(a,c){function d(){try{p.doScroll("left")}catch(a){setTimeout(d,50);return}b("poll")}function b(d){if(!(d.type=="readystatechange"&&f.readyState!="complete")&&((d.type=="load"?a:f).detachEvent("on"+d.type,b,!1),!e&&(e=!0)))c.call(a,d.type||d)}var e=!1,g=!0;if(f.readyState=="complete")c.call(a,i);else{if(f.createEventObject&&p.doScroll){try{g=!a.frameElement}catch(h){}g&&d()}k(f,"readystatechange",b);k(a,"load",b)}})(j,function(){for(var a in z){var c,d,b=j;if(j[a]){for(c=z[a].replace("*",a).split(".");(d=c.shift())&&(b=b[d]););if(typeof b=="function"){t=b;U();break}}}})}}})(this);(function(a,b,c,d){var e=a(b);a.fn.lazyload=function(c){function i(){var b=0;f.each(function(){var c=a(this);if(h.skip_invisible&&!c.is(":visible"))return;if(!a.abovethetop(this,h)&&!a.leftofbegin(this,h))if(!a.belowthefold(this,h)&&!a.rightoffold(this,h))c.trigger("appear"),b=0;else if(++b>h.failure_limit)return!1})}var f=this,g,h={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:b,data_attribute:"original",skip_invisible:!0,appear:null,load:null};return c&&(d!==c.failurelimit&&(c.failure_limit=c.failurelimit,delete c.failurelimit),d!==c.effectspeed&&(c.effect_speed=c.effectspeed,delete c.effectspeed),a.extend(h,c)),g=h.container===d||h.container===b?e:a(h.container),0===h.event.indexOf("scroll")&&g.bind(h.event,function(a){return i()}),this.each(function(){var b=this,c=a(b);b.loaded=!1,c.one("appear",function(){if(!this.loaded){if(h.appear){var d=f.length;h.appear.call(b,d,h)}a("<img />").bind("load",function(){c.hide().attr("src",c.data(h.data_attribute))[h.effect](h.effect_speed),b.loaded=!0;var d=a.grep(f,function(a){return!a.loaded});f=a(d);if(h.load){var e=f.length;h.load.call(b,e,h)}}).attr("src",c.data(h.data_attribute))}}),0!==h.event.indexOf("scroll")&&c.bind(h.event,function(a){b.loaded||c.trigger("appear")})}),e.bind("resize",function(a){i()}),/iphone|ipod|ipad.*os 5/gi.test(navigator.appVersion)&&e.bind("pageshow",function(b){b.originalEvent.persisted&&f.each(function(){a(this).trigger("appear")})}),a(b).load(function(){i()}),this},a.belowthefold=function(c,f){var g;return f.container===d||f.container===b?g=e.height()+e.scrollTop():g=a(f.container).offset().top+a(f.container).height(),g<=a(c).offset().top-f.threshold},a.rightoffold=function(c,f){var g;return f.container===d||f.container===b?g=e.width()+e.scrollLeft():g=a(f.container).offset().left+a(f.container).width(),g<=a(c).offset().left-f.threshold},a.abovethetop=function(c,f){var g;return f.container===d||f.container===b?g=e.scrollTop():g=a(f.container).offset().top,g>=a(c).offset().top+f.threshold+a(c).height()},a.leftofbegin=function(c,f){var g;return f.container===d||f.container===b?g=e.scrollLeft():g=a(f.container).offset().left,g>=a(c).offset().left+f.threshold+a(c).width()},a.inviewport=function(b,c){return!a.rightoffold(b,c)&&!a.leftofbegin(b,c)&&!a.belowthefold(b,c)&&!a.abovethetop(b,c)},a.extend(a.expr[":"],{"below-the-fold":function(b){return a.belowthefold(b,{threshold:0})},"above-the-top":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-screen":function(b){return a.rightoffold(b,{threshold:0})},"left-of-screen":function(b){return!a.rightoffold(b,{threshold:0})},"in-viewport":function(b){return a.inviewport(b,{threshold:0})},"above-the-fold":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-fold":function(b){return a.rightoffold(b,{threshold:0})},"left-of-fold":function(b){return!a.rightoffold(b,{threshold:0})}})})(jQuery,window,document)


;

(function(a){a.fn.numeric=function(){return this.keyup(a.fn.numeric.keyup)};a.fn.numeric.keyup=function(){this.value=this.value.replace(/[^0-9\.]/g,"")};a.fn.numericInt=function(){return this.live("paste",a.fn.numericInt.paste).live("keypress",a.fn.numericInt.keypress)};a.fn.numericInt.paste=function(){var b=a(this);setTimeout(function(){var a=b.val().replace(/[^0-9]/g,"");b.val(a)},10)};a.fn.numericInt.keypress=function(b){var c=b.which,f=b.ctrlKey||b.metaKey,e=[88,67,86,97,99,118,120],d=[0,8];if(f&&e.indexOf(c)>-1||d.indexOf(c)>-1)return true;var g=a(this).val()+String.fromCharCode(c);return!/\D/.test(g)};a.fn.loading=function(a){EC.Loading({after:this,replace:a});return this};a.fn.stopLoading=function(){EC.StopLoading(this);return this};a.fn.isLoading=function(){return a(this).data("loading")===true};a.fn.addError=function(b){return a(this).each(function(){b&&a(this).after("<span class='field-validation-error'>"+b+"</span>");return a(this).addClass("input-validation-error")})};a.fn.removeError=function(){return a(this).each(function(){var b=a(this).next();b.hasClass("field-validation-error")&&b.remove();return a(this).removeClass("input-validation-error")})};a.fn.onEnterClick=function(b){return a(this).live("keypress",function(c){var d=c.keyCode?c.keyCode:c.which;if(d===13){c.preventDefault();if(a.isFunction(b))b(c,this);else if(b.jquery)b.trigger("click");else a(b).trigger("click");return false}})};a.fn.onEnter=function(b){return a(this).live("keypress",function(c){var d=c.keyCode?c.keyCode:c.which;if(d===13){c.preventDefault();a.isFunction(b)&&b();return false}})};a.fn.lazyLoadContent=function(f){var b=this,e=false,d=a(window);function c(){if(!e){e=true;if(b.length>0)b.eachAsync({progress:function(b){if(a.inviewport(b,{threshold:0})){a(b).trigger("appear");counter=0}else if(counter++>5)return false},done:function(){e=false}});else d.unbind("scroll",c)}}d.bind("scroll",c);d.bind("resize",c);b.eachAsync({progress:function(c){this.loaded=false;var d=a(c);d.one("appear",function(){if(!c.loaded){c.loaded=true;var d=a.grep(b,function(a){return!a.loaded});b=a(d);f(a(c))}})},done:function(){c()}})};a.fn.eachAsync=function(a){asyncFor({total:this.length,context:this}).progress(function(b){a.progress(this[b])}).done(a.done);return this};a.eachAsync=function(a,b){asyncFor({total:a.length,context:a}).progress(function(a){b.progress(this[a])}).done(b.done);return this};a.fn.isChecked=function(){return a(this).hasClass("eccheckbox")&&a(this).hasClass("active")||a(this).parent("span.eccheckbox").hasClass("active")};a.fn.showValidationMessage=function(e){var d=a(this),c=d.data("vlderrid"),b;if(c)b=a("#"+c);else{c=EC.Guid();b=a("<span/>").attr("id",c);d.data("vlderrid",c);d.after(b)}d.addClass("input-validation-error");b.removeClass("field-validation-valid");b.addClass("field-validation-error");b.html(e);b.show()};a.fn.removeValidationMessage=function(){var b=a(this).data("vlderrid");if(b!==undefined&&b.length>0){var c=a("#"+b);a(this).data("vlderrid","");c.remove()}a(this).removeClass("input-validation-error")};a.fn.hasValue=function(){return a.trim(a(this).val()).length>0};a.fn.valueRequired=function(c){var b=true;a(this).each(function(h,e){var f=a(e).hasValue();b=b&&f;if(!f){var d=c;if(!d){var g=a(e).getName();d=g+" is required."}a(e).showValidationMessage(d)}});return b};a.fn.enable=function(){return a(this).removeAttr("disabled")};a.fn.disable=function(){return a(this).attr("disabled","disabled")};a.fn.active=function(){return a(this).addClass("active")};a.fn.inactive=function(){return a(this).removeClass("active")};a.fn.isActive=function(){return a(this).hasClass("active")};a.fn.fadeThenSlideToggle=function(d,b,e){var c=a(this);return c.is(":hidden")?c.slideDown(d,b).fadeTo(d,1,b,e):c.fadeTo(d,0,b).slideUp()};a.fn.stopLoadingToast=function(b){EC.StopLoadingToast(b,a(this));return this};a.fn.stopLoadingToastSuccess=function(){var b=a(this);b.html("Success!!").addClass("success").removeClass("info");setTimeout(function(){b.fadeThenSlideToggle()},1e3);return this};a.fn.stopLoadingToastError=function(c){var b=a(this);b.html(c).addClass("error").removeClass("info");setTimeout(function(){b.fadeThenSlideToggle()},1e4);return this};a.fn.highlightSuccess=function(){a(this).effect("highlight",{color:"#007f46"},2e3)};a.fn.highlightError=function(){a(this).effect("highlight",{color:"#CB0B0E"},2e3)};a.fn.allVisible=function(){return a(this).filter(function(){return a(this).css("display")!=="none"})};a.fn.anyVisible=function(){return a(this).allVisible().length>0};a.fn.konami=function(c,b){if(b==undefined)b="38,38,40,40,37,39,37,39,66,65";return this.each(function(){var d=[];a(this).keydown(function(e){d.push(e.keyCode);if(d.toString().indexOf(b)>=0){a(this).unbind("keydown",arguments.callee);c(e)}})})};a.fn.getCollectionSibling=function(d){var c=a(this).attr("id"),b=c.indexOf("__");if(b>-1){var e=c.substring(0,b+2);return a("#"+e+d)}};a.fn.getName=function(){var b=a(this).attr("name").split("."),c=b[b.length-1];return c.depascalise()};a.fn.print=function(){if(this.size()>1){this.eq(0).print();return}else if(!this.size())return;var d="printer-"+ +new Date,e=a("<iframe name='"+d+"'>");e.css("width","1px").css("height","1px").css("position","absolute").css("left","-9999px").appendTo(a("body:first"));var c=window.frames[d],b=c.document,f=a("<div>").append(a("style").clone());b.open();b.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');b.write("<html>");b.write("<body>");b.write("<head>");b.write("<title>");b.write(document.title);b.write("</title>");b.write(f.html());b.write("</head>");b.write(this.html());b.write("</body>");b.write("</html>");b.close();c.focus();c.print();setTimeout(function(){e.remove()},60*1e3)}})(jQuery);var asyncFor=function(f){var e={total:0,limit:100,pause:10,context:this},a=$.extend(e,f),d=$.Deferred(),c=0,b=0;this.loop=function(){if(b<a.total){c=0;for(;c<a.limit;c+=1,b+=1)d.notifyWith(a.context,[b]);this.setTimeout(this.loop,a.pause)}else d.resolveWith(a.context)};this.setTimeout(this.loop,a.pause);return d};$.arrayIntersect=function(a,b){return $.grep(a,function(a){return $.inArray(a,b)>-1})};jQuery.fn.sortElements=function(){var a=[].sort;return function(c,b){b=b||function(){return this};var d=this.map(function(){var d=b.call(this),a=d.parentNode,c=a.insertBefore(document.createTextNode(""),d.nextSibling);return function(){if(a===this)throw new Error("You can't sort elements if any one is a descendant of another.");a.insertBefore(this,c);a.removeChild(c)}});return a.call(this,c).each(function(a){d[a].call(b.call(this))})}}();if(typeof String.prototype.startsWith!="function")String.prototype.startsWith=function(a){return this.slice(0,a.length)==a};if(typeof String.prototype.depascalise!="function")String.prototype.depascalise=function(){return this.replace(/([a-z](?=[A-Z]))/g,"$1 ")};if(typeof String.prototype.trimEnd!="function")String.prototype.trimEnd=function(a){a=a||"\\s";return this.replace(new RegExp("["+a+"]+$","g"),"")};if(typeof String.prototype.trimStart!="function")String.prototype.trimStart=function(a){a=a||"\\s";return this.replace(new RegExp("^["+a+"]+","g"),"")};RegExp.escape=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};Array.prototype.intersect=function(c){var b=[];for(var d in this){var a=this[d];c.indexOf(a)>-1&&b.push(a)}return b};if(!Array.prototype.filter)Array.prototype.filter=function(c){"use strict";if(this===void 0||this===null)throw new TypeError;var b=Object(this),g=b.length>>>0;if(typeof c!=="function")throw new TypeError;for(var d=[],f=arguments[1],a=0;a<g;a++)if(a in b){var e=b[a];c.call(f,e,a,b)&&d.push(e)}return d};function EC(){}var ECWidget={},ECPage={},ECValidate={},ECTicketing={};EC.Guid=function b(a){return a?(a^Math.random()*16>>a/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,b)};EC.Loading=function(b){var d=EC.Guid(),g='<div class="ec-loading" id="'+d+'"></div>';if(b===undefined)b={};if(b.after!==undefined){var a=$(b.after);if(a.siblings(".ec-loading").length===0){a.data("loader",d);a.data("loading",true);a.after(g)}if(b.replace){a.data("hidden",true);var f=a.outerWidth(),h=a.outerHeight(),e=a.css("float");a.hide();var c=$("#"+d);e&&c.css("float",e);c.width(f);c.css("margin",0)}b.after.trigger("postLoading")}};EC.StopLoading=function(a){if(a===undefined)$(".ec-loading").remove();else{$(a).data("loading",false);var b=EC.GetLoader(a);b.length>0&&b.remove();a.trigger("postStopLoading")}};EC.GetLoader=function(a){var b=$(a).data("loader");$(a).data("hidden")&&$(a).show();return $.trim(b).length>0?$("[id="+b+"]"):[]};EC.ShowModal=function(c,b){if(c!==undefined&&c.length>0){b=b||{};EC.CloseModal();var a=$("<div/>").attr("id","modal-popup").addClass("simple_overlay").append("<div class='modal-wrapper'><div id='modal-content'></div></div><a href='#' class='close'></a>").appendTo("body");b.additionalClass&&a.addClass(b.additionalClass);var d=$("#mask").length>0?$("#mask"):$("<div/>").attr("id","mask").prependTo("body");$(window).bind("resize",function(){d.css({width:$(window).width(),height:$(document).height()});a.css("top",$(window).height()/2-a.height()/2);a.css("left",$(window).width()/2-a.width()/2);$(".modal-wrapper",a).css({height:a.height()-20})});$("#modal-content",a).html(c);$("#modal-popup .close").unbind("click");$("#modal-popup .close").click(function(){b.close!==undefined&&b.close();$("#mask, .simple_overlay").remove();return false});$("#mask").click(function(){return EC.CloseModal()});$(".ecalert-ok").click(function(){return EC.CloseModal()});b.width!==undefined&&a.width(b.width);b.height!==undefined&&a.height(b.height);$(window).trigger("resize");$("#mask").fadeTo("fast",.8);a.fadeIn("fast");a.focus();EC.ModalShowing=true}};EC.ModalShowing=false;EC.CloseModal=function(){$("#modal-popup .close").trigger("click");return false};EC.Alert=function(b,a){EC.Message("Warning",b,a)};EC.Success=function(b,a){if(!a)a={};a.headerClass="success";EC.Message("Success!",b,a)};EC.Message=function(e,b,a){b=b.replace(/\n/g,"<br />");if(!a)a={};if(!a.headerClass)a.headerClass="alert";var c='<p class="'+a.headerClass+'">'+e+'</p><div class="message"><b>'+b+"</b></div>",d='<div><a href="#" class="btn grey ecalert-ok">Ok</a></div>';EC.ShowModal(c+d,a)};EC.ShowModalRegion=function(b,a){if(a===undefined)a={};var c=a.close;a.close=function(){$("body").append($(b).hide());c!==undefined&&c()};EC.ShowModal($(b).show(),a)};EC.Toast=function(d,a){if(!a)a={};var c=$("#toast");if(c.length==0)c=$("<div/>").attr("id","toast").appendTo("body");var e=EC.Guid();if(!a.toastClass)a.toastClass="info";if(!a.timeout)a.timeout=1500;var b=$("<div/>").attr("id",e).addClass(a.toastClass).html(d).appendTo(c);b.css("right",-b.outerWidth(true));b.animate({right:0},"fast");!a.keepAlive&&setTimeout(function(){b.fadeThenSlideToggle()},a.timeout);return b};EC.LoadingToast=function(a){if(!a)a="sending..";return EC.Toast(a,{keepAlive:true})};EC.StopLoadingToast=function(a,b){if(a.Success)b.stopLoadingToastSuccess();else b.stopLoadingToastError(a.Message)};EC.ErrorToast=function(a){return EC.Toast(a,{toastClass:"error",duration:8e3})};EC.get=function(a){EC.AjaxBase(a,"GET")};EC.post=function(a){EC.AjaxBase(a,"POST")};EC.AjaxBase=function(a,d){var b=a.error;a.error=function(){$.isFunction(b)&&b(a.errorMessage)};if($.isFunction(a.success)){var c=a.success;a.success=function(f){var d=a.toast;if(f.Success){d&&d.stopLoadingToastSuccess();c(f.Data)}else if(isTrue(f.Reauthenticate)){d&&d.stopLoadingToastError("authentication required");$("body").trigger("reauthenticate",a)}else if($.isFunction(a.error)){var e=f.Message;if(a.errorMessage&&(!e||e==="Server Error"))e=a.errorMessage;$.isFunction(b)&&b(e);d&&d.stopLoadingToastError(e)}}}a.type=d;$.ajax(a)};EC.ParseDate=function(b){if(!b)return null;var a=b.split(/[- :T]/);return a.length===6?new Date(a[0],a[1]-1,a[2],a[3],a[4],a[5]):a.length===5?new Date(a[0],a[1]-1,a[2],a[3],a[4],0):new Date(a[0],a[1]-1,a[2])};EC.money=function(a){return"$"+parseFloat(a).toFixed(2)};EC.ga=function(a,b,c,d){typeof ga!="undefined"&&$.isFunction(ga)&&ga("send","event",a,b,c,d)};function isTrue(a){return a!=undefined?typeof a=="boolean"?a:a.toLowerCase()=="true":false}function waitForCdnImage(b,a){$.ajax({url:b,cache:false,type:"GET",success:a,error:function(){setTimeout(function(){waitForCdnImage(b,a)},1e3)}})}function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+a+"=([^&#]*)",d=new RegExp(c),b=d.exec(window.location.search);return b==null?"":decodeURIComponent(b[1].replace(/\+/g," "))}function getParam(a){return[getParameterByName(a),$.deparam.fragment()[a]].filter(function(a){return a}).join()}var delay=function(){var a=0;return function(b,c){clearTimeout(a);a=setTimeout(b,c)}}();!window.console&&(function(){var b=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"],a,c=b.length;window.console={};for(a=0;a<c;a++)window.console[b[a]]=function(){}})();var dateScroller,timerSearch,triviaReload,selected_movies=[],items_shown=0,items_total=0,slide_amount=0,total_slides=0,current_slide=1,slide_interval=5e3,rememberSkin="",selected_dates=[],baseCdnUrl=$("#cdnUrl").attr("path"),sessionTimeTemplate='<a data-id="${Id}" data-showseating="${SeatAllocation}" data-attributes="${JSON.stringify(Attributes)}" class="btn ${FormatSessionClass(Attributes, ScreenType, Is3d)}" href="/ticketing/step2?sessionid=${Id}">${FormatSessionTime(StartTime)}{{html RenderSessionIcon(Attributes, ScreenType, Is3d)}}</a>',cinemaRowLoadingTemplate='<span class="cinema-row" id="${Id}"><span class="title">${Name}</span><span class="cinema-row-wrapper"><div class="dates-row"><span class="width-wrap"><img src="'+$("#cdnUrl").attr("path")+'img/loader-red.gif" alt="loading" /></span></div><span class="shadow-right"></span><span class="shadow-left"></span></span><div class="reveal-more">&#8250;</div><div class="reveal-less">&#8249;</div></span>';EC.indexOf=function(b,a){if(typeof someVar==="string")a=a.split("");return $.inArray(b,a)};EC.CdnUrl=function(a){return baseCdnUrl.trimEnd("/")+"/"+a.trimStart("/")};EC.BackgroundImages={};EC.MovieViewMode={"set":function(a,b){$.cookie(a,b);return $.cookie(a)},"get":function(a){return $.cookie(a)}};EC.PreferredCinemas={collection:Array,init:function(){console.log("Init cinemas");collection=[];if($.cookie("preferred_cinemas")!=null)collection=$.parseJSON($.cookie("preferred_cinemas"));console.log("init cinemas loaded "+this.count());return this},add:function(c,b){var a=parseInt(c);if(!this.contains(a)){collection.push({Id:a,Name:b});this.save()}return this},remove:function(b){var a=-1,c=parseInt(b);$.each(collection,function(d,b){if(c==b.Id){a=d;return}});if(a!=-1){collection.splice(a,1);this.save()}return this},clear:function(){collection=[];this.save(true);return this},save:function(a){console.log("saving cinemas");this.sort();$.cookie("preferred_cinemas",JSON.stringify(collection),{path:"/",expires:7300});(a==null||!a)&&isUserLoggedIn()&&$.ajax({traditional:true,type:"post",url:"/sessionfilter/preferredcinemas",dataType:"text",data:{cinemaIds:this.select("Id")}});return this},"get":function(a){return collection[a]},getCinemaName:function(b){var a="";$.each(collection,function(d,c){if(c.Id==b){a=c.Name;return}});return a},contains:function(a){var b=false;$.each(collection,function(d,c){if(c.Id==a||c.Name==a){b=true;return}});return b},sort:function(){collection.sort(function(c,d){var a=c.Name,b=d.Name;return a<b?-1:a>b?1:0})},count:function(){return typeof collection=="undefined"||collection==null?0:collection.length},any:function(){return typeof collection=="undefined"||collection==null?false:collection.length>0},all:function(){this.sort();return collection},select:function(b){var a=[];$.each(collection,function(d,c){a.push(c[b])});return a},orderedIds:function(){return $.map(collection,function(a){return a.Id}).sort(function(a,b){return a-b})}};EC.Scroller={init:function(a){if(!a)a=$("body");$(".slider:visible .reveal-more",a).hide();$(".slider:visible .shadow-right",a).hide();$(".slider:visible",a).each(function(){if($(".width-wrap",this).width()>$(".row-wrapper",this).width()){$(".reveal-more",this).show();$(".shadow-right",this).show()}var a=$(".row-container",this).outerHeight(true);a>0&&$(".row-wrapper",this).height(a)});var b=null;$(".slider .reveal-more",a).unbind("hover");$(".slider .reveal-more",a).hover(function(){$(this).siblings(".reveal-less").show();var a=$(this),c=$(this).siblings(".row-wrapper");b=setInterval(function(){EC.Scroller.scrollLeft(c,a)},5)},function(){clearInterval(b)});$(".slider .reveal-less",a).unbind("hover");$(".slider .reveal-less",a).hover(function(){$(this).siblings(".reveal-more").show();var a=$(this),c=$(this).siblings(".row-wrapper");b=setInterval(function(){EC.Scroller.scrollRight(c,a)},5)},function(){clearInterval(b)})},scrollLeft:function(b,c){var a=$(".row-container",b),d=a.position().left;if(d>b.width()-$(".width-wrap",b).width())if(ie)$(a).css({left:"-=4px"}).show();else $(a).css({left:"-=2px"});else $(c).hide()},scrollRight:function(c,b){var a=$(".row-container",c),d=a.position().left;if(d<0)if(ie)$(a).css({left:"+=4px"}).show();else $(a).css({left:"+=2px"});else $(b).hide()},ensureElementVisible:function(a,c){var g=a.offset().left,h=c.offset().left,e=c.outerWidth(),i=a.width(),b=h+e,d=g+i;if(b>d){var f=a.siblings(".reveal-more");while(b>d){EC.Scroller.scrollLeft(a,f);b=c.offset().left+e}a.siblings(".reveal-less").show()}else a.position().left<0&&a.siblings(".reveal-less").show()}};EC.SessionFilter={WherePopup:$(".where-blowout"),WhenPopup:$(".when-blowout"),WhatPopup:$(".what-blowout"),DateTemplate:"<li data-value=${value}>${text}</li>",DatesGet:function(){if($("li",this.WhenPopup).length<=1){var b=[],a=Date.today();b.push({Id:0,Text:"Today",Value:a.toString("yyyy-MM-dd")});b.push({Id:1,Text:"Tomorrow",Value:a.addDays(1).toString("yyyy-MM-dd")});for(var c=2;c<7;c++){a.addDays(1);b.push({text:a.toString("dddd MMMM dd"),value:a.toString("yyyy-MM-dd")})}$.each(b,function(a){$("ul",this.WhenPopup).append($.tmpl(this.DateTemplate,a))})}},CinemaEmptyTemplate:"<div class='columns'>No cinemas with sessions in ${state}</div><div class='clearfix'></div>",CinemaTemplate:"<div class='columns' id='${state}'>{{each cinemas}}<span {{if !EC.SessionFilter.CinemaShow(IsActive,HasSessions) }} style='display:none;' {{/if}} ><div value='${Name}' id='${Id}' data-code='${Code}' class='checkbox'></div>{{if Offline}}<label for='${Id}' class='offline' title='${Name} is currently offline'>${Name}</label>{{else}}<label for='${Id}'>${Name}</label>{{/if}}</span>{{/each}}</div><div class='clearfix'></div>",CinemaLoadingTemplate:"<div class='columns loading'><img src='"+$("#cdnUrl").attr("path")+"img/loader-red.gif' /> Loading cinemas...</div><div class='clearfix'></div>",CinemaShow:function(b,a){return b&&a},CinemasGetByState:function(c,a){$(".head li",this.WherePopup).unbind("click");$(".head li",this.WherePopup).bind("click",function(){$(".head li",this.WherePopup).removeClass("active");$(this).addClass("active");var b=$("a",this).text();EC.SessionFilter.CinemasGetByState(b,a)});$("div.columns",this.WherePopup).remove();$("div.clearfix",this.WherePopup).remove();$(".explain",this.WherePopup).after(this.CinemaLoadingTemplate);var b="";a!=null&&a.length>0&&$.each(a,function(c,a){b+="&movieIds="+a});$.ajax({url:"/SessionFilter/GetCinemasByState?state="+encodeURIComponent(c)+b,dataType:"json",success:function(a){EC.SessionFilter.CinemasRender({state:c,cinemas:a})}})},CinemasRender:function(c){$("div.columns",this.WherePopup).remove();$("div.clearfix",this.WherePopup).remove();var b,a=false;$.each(c.cinemas,function(c,b){a=a||EC.SessionFilter.CinemaShow(b.IsActive,b.HasSessions)});if(!a)b=$.tmpl(this.CinemaEmptyTemplate,c);else b=$.tmpl(this.CinemaTemplate,c);$(".explain",this.WherePopup).after(b);$.each(EC.PreferredCinemas.all(),function(b,a){$("div[id="+a.Id+"]").parent().addClass("active")})},MovieLoadingTemplate:"<div class='loading'><img src='"+$("#cdnUrl").attr("path")+"img/loader-red.gif'/> Loading movies...</div>",MovieTemplate:"{{each m}}<li data-id='${Id}' data-attributes='${Attributes}' data-hasvmax='${HasVmax}' data-hasdeluxe='${HasDeluxe}' data-hasgc='${HasGoldClass}' data-has3d='${Has3D}'><span><div class='image-wrapper'><img class='lazy' data-original='"+$("#cdnUrl").attr("path")+"../resources/movies/${Id}/images/movie.jpg' src='"+$("#cdnUrl").attr("path")+"img/unavailable_poster105x50.jpg' alt='${Name}' width=105 height=154 /><div class='hover'><p class='title' data-id='${Id}'>${Name}</p><a href='${MovieUrl}'>&#8250; more details</a>{{if HasTrailers}}<a href='#' onclick='LoadTrailer(${Id})'>&#8250; view trailer</a>{{/if}}</div></div><div class='select'><div class='checkbox'></div><label>Select movie</label></div></span></li>{{/each}}",MovieEmptyTemplate:"<div class='empty'>There are no movies showing</div>",Return:null,MovieNowShowing:function(){$(".movie-overview",this.WhatPopup).hide();$(".movie-overview li",this.WhatPopup).remove();$(".bottom",this.WhatPopup).before(this.MovieLoadingTemplate);var c=$("li.active",$(".when-blowout")).data("value"),a=EC.PreferredCinemas.orderedIds(),b={date:c,cinemaIds:a};$.ajax({url:"/SessionFilter/GetNowShowingMovies",traditional:true,success:function(a){EC.SessionFilter.MoviesRender(a)},data:b})},MovieAdvancedTickets:function(){},MoviesRender:function(a){$(".loading",this.WhatPopup).remove();$(".empty",this.WhatPopup).remove();if(a==null||a.length==0)$(".bottom",this.WhatPopup).before(this.MovieEmptyTemplate);else{var b=$.tmpl(this.MovieTemplate,{m:a});$(".movie-overview",this.WhatPopup).append(b);$(".movie-overview").show()}this.FilterMovies();CheckSelectedMovies();$(".movie-overview",this.WhatPopup).scrollTop(0);LazyLoadImages(this.WhatPopup)},FilterMovies:function(){if($("ul.filters span.active").length>0){$(".movie-overview li",EC.SessionFilter.WhatPopup).hide();$('ul.filters span[data-type="screen-type"].active,ul.filters span[data-type="three-d"].active',this.WhatPopup).each(function(){var a=$(this).attr("id");a&&$(".movie-overview li:not(visible)",EC.SessionFilter.WhatPopup).each(function(){var b=$(this).data("has"+a);b&&$(this).show()})});$("ul.filters span[data-type='attribute'].active",this.WhatPopup).each(function(){var a=$(this).data("code");if(a){a=a.toUpperCase();$(".movie-overview li:not(visible)",EC.SessionFilter.WhatPopup).each(function(){var b=$(this).data("attributes");if(b){var c=b.split(",");$.inArray(a,c)>-1&&$(this).show()}})}})}else $(".movie-overview li",EC.SessionFilter.WhatPopup).show()}};function isUserLoggedIn(){var a=$("#cine-buzz");return a.length>0?a.data("loggedin"):$("body").data("loggedin")}function initAnimatedSlider(){$("#slider img").one("error",function(){SetMovieDefaultImageLandscape($(this))});items_shown=$("#slider").width()/$("#slider .items a:visible").width();console.log("items_shown: "+items_shown);items_total=$("#slider .items a:visible").length;console.log("items_total: "+items_total);slide_amount=Math.floor(items_shown)*158+Math.floor(items_shown)*10;console.log("slide_amount: "+slide_amount);if(items_total>items_shown)slide_amount=$($("#slider .items a")[Math.floor(items_shown)]).position().left;total_slides=Math.ceil(items_total/Math.floor(items_shown));console.log("total_slides: "+total_slides);$("#slider .items").attr("style","left: 10px;");$("#slider .arrow-left").hide();total_slides>1&&$("#slider .arrow-right").show();current_slide=1;!ECWidget.movierotator.isHomePageTakeOver&&ECWidget.movierotator.setActive($("#slider a.active"))}function resetSlider(){$("#slider a.active").removeClass("active");$("#slider a:visible:first").addClass("active");$("#slider .items").animate({left:"10px"},300,function(){current_slide=1;$("#slider .arrow-left").hide();!$("#slider .arrow-right").is(":visible")&&$("#slider .arrow-right").show()})}function animatedSlider(){if($("#slider a.active").find("img").data("isstatic"))return;if(isTrue($("#slider").attr("disableSlider")))return;if($("#slider a.active").nextAll(":visible").length==0){$("#slider a.active").removeClass("active");$("#slider a:visible:first").addClass("active");$("#slider .items").animate({left:"10px"},300,function(){current_slide=1;$("#slider .arrow-left").hide();!$("#slider .arrow-right").is(":visible")&&$("#slider .arrow-right").show()})}else{$("#slider a.active").removeClass("active").nextAll(":visible:first").addClass("active");var a=$("#slider a.active").prevAll(":visible").length%Math.floor(items_shown);a==0&&moveSliderRight()}ECWidget.movierotator.setActive($("#slider a.active"))}function changeSkin(i){var a=$("#slider.animate a.active img"),g=isTrue(a.data("ismovie")),b=a.attr("movieid"),j=g?baseCdnUrl+"../resources/movies/"+b+"/images/skinTitle.png":baseCdnUrl+"../resources/featureditems/"+b+"/skinTitle.png",f=g?baseCdnUrl+"../resources/movies/"+b+"/images/skin.jpg":baseCdnUrl+"../resources/featureditems/"+b+"/skin.jpg",d=$("#slider.animate a.active img").parent().next().children("img"),c=d.attr("movieid"),h=d.data("ismovie"),e=h?baseCdnUrl+"../resources/movies/"+c+"/images/skin.jpg":baseCdnUrl+"../resources/featureditems/"+c+"/skin.jpg";if(a.attr("skin")!=null){f=a.attr("skin");e=d.attr("skin")}!(i&&$("#slider").attr("disableSlider")!=null&&$("#slider").attr("disableSlider").toLowerCase()=="true")&&changeSkinBackground(b,f,c,e);changeCallToActionInfo(a.attr("movieid"),a.attr("movieUrl"),j,a);if(a.attr("align-title")=="left")$(".call-to-action .button-wrapper").css("float",a.attr("align-title"));else $(".call-to-action .button-wrapper").css("float","right");if(a.attr("hastrailer")=="false")$(".call-to-action .poptrailer").hide();else $(".call-to-action .poptrailer").show();$(".call-to-action .btn.blue").text(a.attr("btn-title"));if($(".call-to-action .btn.blue").text().length==0)$(".call-to-action .btn.blue").attr("style","display: none;");else $(".call-to-action .btn.blue").attr("style","");if(a.attr("details-title")!=null&&a.attr("details-title").length==0)$(".call-to-action .btn.details").text("Details");else $(".call-to-action .btn.details").text(a.attr("details-title"))}function changeSkinBackground(e,d,b,a){var c=e+"-"+d;if(EC.BackgroundImages[c]==null)EC.BackgroundImages[c]=loadImage(e,d,function(a){changeSkinBackgroundSet($(a).attr("src"))},function(){changeSkinBackgroundSet("")});else changeSkinBackgroundSet($(EC.BackgroundImages[c]).attr("src"));if(b!=null&&a!=null){var f=b+"-"+a;if(EC.BackgroundImages[f]==null)EC.BackgroundImages[f]=loadImage(b,a,null,function(a){$(a).unbind("error");$(a).attr("src","")})}}function changeSkinBackgroundSet(a){$("#background-wrap").fadeOut(200,function(){if(a==null||a.length==0){$(this).css("background-image","url("+$("#cdnUrl").attr("path")+"img/Empty.png)");$("body").addClass("lights")}else{$(this).css("background-image","url("+a+")");$("body").removeClass("lights")}$(this).fadeIn(600)})}function changeCallToActionInfo(d,c,b,a){loadImage(d,b,function(){},function(){b=EC.getCdnImage("Empty.png")});$(".call-to-action").not("hptakeover").fadeOut(200,function(){$(".call-to-action.hptakeover").size()>0&&$(".call-to-action.hptakeover").remove();var e=$(this);$("#takeover-title img.title",e).attr("src",b);var f=[],g;if(a){if(isTrue(a.data("hasimax3d")))f.push("im3d");else isTrue(a.data("hasimax"))&&f.push("im");isTrue(a.data("hasdeluxe"))&&f.push("de");isTrue(a.data("hasgc"))&&f.push("gc");isTrue(a.data("hasvmax"))&&f.push("vmax");isTrue(a.data("has3d"))&&f.push("3d");g=a.data("subskintitle")}if(f.length>0)g=EC.getCdnImage("experience-it-in/"+f.join().replace(/,/g,"-")+".png");$("#takeover-title img.exp",e).attr("src",EC.getCdnImage("Empty.png")).data("original",g);g&&LazyLoadImages(e);$(".details",e).attr("href",c);if(isExternalLink(c))$(".details",e).prop("target","_blank");else $(".details",e).removeAttr("target");$(".opengallery",e).attr("href",c+"/gallery");$(".poptrailer",e).attr("movieId",d);$(".find-times-and-book",e).attr("id",d);e.fadeIn(600)})}function isExternalLink(a){if(a==null)return false;if(a.indexOf("..")==0||a.indexOf("/")==0)return false;var b=new RegExp("//"+location.host+"($|/)");return b.test(a)?false:true}function moveSliderRight(){slide_amount==0&&initAnimatedSlider();if(current_slide>=total_slides){$("#slider .arrow-right").hide();return}current_slide=current_slide+1;$("#slider .items").animate({left:"-="+slide_amount},300,function(){current_slide==total_slides&&$("#slider .arrow-right").hide();!$("#slider .arrow-left").is(":visible")&&$("#slider .arrow-left").show();LazyLoadImages($("#slider"))})}function moveSliderLeft(){slide_amount==0&&initAnimatedSlider();if(current_slide<=1){$("#slider .arrow-left").hide();return}current_slide=current_slide-1;$("#slider .items").animate({left:"+="+slide_amount},300,function(){current_slide==1&&$("#slider .arrow-left").hide();!$("#slider .arrow-right").is(":visible")&&$("#slider .arrow-right").show();LazyLoadImages($("#slider"))})}function removeByElement(b,c){for(var a=0;a<b.length;a++)b[a]==c&&b.splice(a,1)}function LoadTrailer(b,a){ECWidget.movierotator.hasRotator()&&ECWidget.movierotator.stopRotator();if(b!==undefined){var c={movieId:b};$.ajax({url:"/Movie/TrailerWithInfo",data:c,dataType:"json",success:function(b){if(b.Success){var c=$("div.#trailer");c.html(b.Data);$("#cover").show();$("#trailer").show();showTrailer($("#trailer li.active"));LazyLoadImages($("#trailer"))}else EC.Alert("Error retrieving Trailer");a&&typeof a==="function"&&a()}})}}function showTrailer(a){$("#trailer li.active").removeClass("active");a.addClass("active");if(isTrue(a.attr("data-isyoutube")))$("#trailer #videoArea").html("<iframe src='http://www.youtube.com/embed/"+a.attr("data-trailerid")+"' class='video' frameborder='0' allowfullscreen></iframe>");else{if(isAppleDevice()||a.data("flvurl")==undefined)$("#trailer #videoArea").html("<a class='video' href='"+a.data("m4vurl")+"' id='player'></a>");else $("#trailer #videoArea").html("<a class='video' href='"+a.data("flvurl")+"' id='player'></a>");$f("player",$("#cdnUrl").attr("path")+"img/flowplayer-3.2.12.swf").ipad()}}function isAppleDevice(){return navigator.userAgent.toLowerCase().indexOf("ipad")>-1||navigator.userAgent.toLowerCase().indexOf("iphone")>-1||navigator.userAgent.toLowerCase().indexOf("ipod")>-1}function textOverflowEllipsis(a,b){return a!==undefined&&a!==null&&a.length>b?a.substring(0,b)+"...":a}function closeTrailer(){var a=$("#trailer video");a.length>0&&a[0].pause();$("#cover").hide();$("#trailer").hide();$("div.#trailer").html("");ECWidget.movierotator.hasRotator()&&ECWidget.movierotator.startRotator()}function showQuickTimesWidget(){if(EC.PreferredCinemas.any()){var f=$(this).attr("id");if(f==null)return;ECWidget.movierotator.hasRotator()&&ECWidget.movierotator.stopRotator();var a=$("#quick-times-widget-upon-hover .quick-times-select-widget");a.data("movieid",f);var b=$(".arrow",a),c="",h=window.location.pathname.toLowerCase();if(h.startsWith("/movie/"))c="WWW|Movies";else if(h.startsWith("/cinema/"))c="WWW|Cinemas";else if(h==="/")c="WWW|Home";if($(this).hasClass("btn")){var d=$(this).position(),e=Date.today().toString("yyyy-MM-dd"),q=$("a.find-times-and-book").attr("data-lastsession"),i=EC.PreferredCinemas.orderedIds(),k=$("#experience-filters div[value='gc']").parent().hasClass("active"),m=$("#experience-filters div[value='vmax']").parent().hasClass("active"),l=$("#experience-filters div[value='deluxe']").parent().hasClass("active"),n=$("#experience-filters div[value='three-d']").parent().hasClass("active"),p=$(this).data("attributes"),o={cinemaIds:i,movieId:f,startDate:e,endDate:null,selectedDate:e,dateDisplayFormat:"ddd dd/MM",hasGoldClass:k,hasVmax:m,has3d:n,attributesFilter:p,hasDeluxe:l,source:c};$("ul.dates",a).remove();$("span.datesrow",a).remove();$("#noSessionsAtSelectCinemas",a).remove();$(".cinema-row",a).remove();b.stopLoading();b.loading();$.ajax({url:"/Movie/QuickTimesSelect",data:o,traditional:true,success:function(d){b.stopLoading();a.html(d);EC.Scroller.init(a);var c=ECWidget.movielistfilter.get_selectedExperiences();FilterSessions(c,null,a);$(".quick-times-select-widget .dates-row .btn").showSeatsHover()}});var g=$(".quick-times-select-widget");g.css({left:d.left-386,top:d.top+50});g.show()}else if($("#cinema-filters span.active").length>0){var d=$(this).parent().parent().position(),e=Date.today().toString("yyyy-MM-dd"),q=Date.today().addDays(7).toString("yyyy-MM-dd"),i=[];$("#cinema-filters span.active").each(function(){var a=$("div",this).data("id");a!=null&&!window.isNaN(a)&&i.push(a)});var k=$("#experience-filters div[value='gc']").parent().hasClass("active"),m=$("#experience-filters div[value='vmax']").parent().hasClass("active"),l=$("#experience-filters div[value='deluxe']").parent().hasClass("active"),n=$("#experience-filters div[value='three-d']").parent().hasClass("active"),o={cinemaIds:i,movieId:f,startDate:e,endDate:null,selectedDate:e,dateDisplayFormat:"ddd dd/MM",hasGoldClass:k,hasVmax:m,has3d:n,hasDeluxe:l,source:c};$("ul.dates",a).remove();$("span.datesrow",a).remove();$("#noSessionsAtSelectCinemas",a).remove();$(".cinema-row",a).remove();b.stopLoading();b.loading();$.ajax({url:"/Movie/QuickTimesSelect",data:o,traditional:true,success:function(e){b.stopLoading();a.html(e);postitionQuickTimesWidget(a,d);EC.Scroller.init(a);var c=ECWidget.movielistfilter.get_selectedExperiences();FilterSessions(c,null,a);$(".quick-times-select-widget .dates-row .btn").showSeatsHover()}});var j=$(".arrow",g);j.css({"border-bottom":"8px solid #333334"});j.css({"border-top":"none"});j.css({top:"-8px"});a.css({left:d.left-200,top:d.top+20});a.show()}}}function postitionQuickTimesWidget(a,c){console.log("positioning");var b=$(".arrow",a),d=$(".hidden-area",a);if(c.top+200+a.height()>$("footer").position().top){a.css({left:c.left-200,top:c.top-a.height()-40});b.css({top:a.height()+20});d.css({top:a.height()+20});b.css({"border-top":"8px solid #333334"});b.css({"border-bottom":"none"})}else{b.css({"border-bottom":"8px solid #333334"});b.css({"border-top":"none"});b.css({top:"-8px"});d.css({top:"-30px "})}}function hideQuickTimesWidget(){$(".quick-times-select-widget").hide();$("#quick-view-seats").hide();if(ECWidget.movierotator.hasRotator()){ECWidget.movierotator.stopRotator();ECWidget.movierotator.startRotator()}}function showQuickSeats(){var f=$(this).offset(),e=isTrue($(this).data("showseating")),b=$(this).data("attributes");if(!e&&(b==null||b.length==0))return;var a=$("#quick-view-seats");a.data("sessionid",$(this).data("id"));$(".attribute",a).remove();var c=$(".content",a);if(e)c.html("<a class='quick-view'>Quick view available seats</a>");else c.html("");if(b!=null){var h="<a class='attribute' title='${Name}'>${Code}</a>";$.each(b,function(b,a){$.tmpl(h,a).appendTo(c)});$("a.attribute",a).tooltip({track:true,delay:0,showURL:false,showBody:" - ",fade:100,extraClass:"tooltip"})}var g=$(this).width(),d=$("#quick-view-seats").width(),i=$("#quick-view-seats").height();$(".inner-arrow",a).css({left:d/2});$(".outer-arrow",a).css({left:d/2-2});a.css({left:f.left-d/2+g/2,top:f.top-(i+0)}).fadeIn()}function showAvailableSeatsLink(){var b=$(this).parent().parent().parent().parent().position(),a=$(this).position();$(".view-seats-link").css({left:a.left+100,top:b.top-40});$(".view-seats-link").show()}function emptyFunction(){console.log("empty")}function toggleGallery(){$(".main .movie-detail nav").toggle();$(".main .movie-detail .movie-info").toggle();$(".main .movie-detail .movie-detail-items").toggle();$(".call-to-action").toggle();$("footer").toggle();$(".gallery-items").toggle();$("#gallery-close").toggle()}function showState(a){$("div.columns").hide();$(".where-blowout #NoCineamsForState").hide();$("div#"+a).show(0,0,function(){$("span:visible",this).length==0&&$(".where-blowout #NoCineamsForState").show()})}function GetBaseUrl(){return window.location.protocol+"//"+window.location.host}function loadImage(e,a,c,b){var d=new Image;if(a==null||a.length==0||a.toString().toLowerCase().indexOf("empty.png")>0)b!=null&&b();else $(d).load(function(){$(this).hide();c!=null&&c(this)}).error(function(){b!=null&&b(this)}).attr("src",a);return d}function addLoader(a,b){$(".loading",$(a)).remove();$(a).append("<span class='loading'><img src='"+baseCdnUrl+"img/loader-red.gif' /> Loading "+b+"...</span>")}function removeLoader(a){$(a+" span.loading").remove()}function SetMovieDefaultImageLandscape(a){a.attr("src",$("#cdnUrl").attr("path")+"img/unavailable_poster156x80.jpg")}function SetMovieDefaultImagePoster(a){a.attr("src",$("#cdnUrl").attr("path")+"img/unavailable_poster105x50.jpg")}function CheckSelectedMovies(){$(".what-blowout ul.movie-overview li span").removeClass("active");for(var a=0;a<selected_movies.length;a++){var b=selected_movies[a].id,c=$("ul.movie-overview li p.title[data-id="+b+"]").parents("span");c.addClass("active")}var f=ECWidget.sessionfilter.readMoviesFromUrl();for(a=0;a<f.length;a++){b=f[a];if(b!=""&&b!=null){for(var c=$("li[data-id='"+b+"'] span",this.WhatPopup),g={title:$(".title",c).text(),id:$(".title",c).data("id")},d=false,e=0;e<selected_movies.length;e++)d=d||selected_movies[e].id==b;!d&&selected_movies.push(g);c.addClass("active")}}}function RenderNowShowing(){console.log("RenderNowShowing");var a=$(".what-blowout ul.movie-overview"),b=a.data("NowShowing");$("li",a).fadeOut(100).delay(200).remove();a.html(b);$("li",a).fadeIn();CheckSelectedMovies()}function FilterMovies(){var d=$(".what-blowout ul.movie-overview");if($(".what-blowout").is(":hidden"))$("li",d).hide();else $("li",d).fadeOut(100).delay(100);var b=[];$("div.where-blowout span.active div").each(function(){b.push($(this).attr("id"))});for(var a="",c=0;c<b.length;c++){a+="li."+b[c];if(c!=b.length-1)a+=","}if(a=="")a="li";var f=$(a,d);a="";var g=[];$(".filters li.active").each(function(){a+="li."+$(this).attr("id").toLowerCase()+","});if(a=="")a="li";else a=a.substr(0,a.length-1);var e=f.filter(a),h=$(".when-blowout ul li.active").data("id");if($(".what-blowout").is(":hidden"))e.show();else e.fadeIn()}function rotatorAlternateContent(b){var a=$("#slider.AlternateContentSlider");$(".top li",a).removeClass("active");b.addClass("active");var c=a.data(b.html());if(c==null){$("a",a).remove();addLoader($(".items",a),"movies");$.ajax({url:"/SSW/MovieListNowShowingController/GetAlternateContentMovies",data:{genre:b.html()},dataType:"json",success:function(c){a.data(b.html(),c);rotatorRenderAlternateContent(c);removeLoader("#slider.AlternateContentSlider")}})}else rotatorRenderAlternateContent(c)}var movieRotatorAlternateContentTemplate='<a href="${MovieUrl}"><img class="lazy" data-original="${PosterUrl}" src="'+$("#cdnUrl").attr("path")+'img/unavailable_poster156x80.jpg" movieid="${Id}" alt="${Name}" width="156" height="80" /><p>${Name}</p></a>',movieRotatorAlternateContentEmptyTemplate='<div class="empty">There are no alternate content showing for this genre</div>';function rotatorRenderAlternateContent(b){var a=$("#slider.AlternateContentSlider .items");$("a",a).fadeOut(100).delay(200);$("a",a).remove();$(".empty",a).remove();if(b==null||b.length==0){a.append(movieRotatorAlternateContentEmptyTemplate);return}$.tmpl(movieRotatorAlternateContentTemplate,b).appendTo(a);$("a",a).fadeIn();var c=$("#slider.AlternateContentSlider").attr("currentmovieid");$("[movieid='"+c+"']",a).parent().addClass("current");LazyLoadImages(a)}function loadSessionError(a){$("div.movie-list-item[data-id='"+a+"'] span.cinema-row").html("<span class='title'>Error loading sessions</span>")}function showSessionTime(f,a,e,j,b){if(a==null)a=Date.parse(new Date).toString("yyyy-MM-dd HH:mm");var d=Date.parse(a),i=d.clone().addDays(1);b.data("movieId",f);var g=getScreenTypes(),h=getAttributeCodes(),c=[];$.each(e,function(b,a){c.push(a.Id)});var k=getHas3d(),l={cinemaIds:c,movieId:f,startDate:d.toString("yyyy-MM-dd HH:mm"),endDate:i.toString("yyyy-MM-dd"),attributeCodes:h,screenTypeCodes:g,has3d:k};$.ajax({url:"/SessionFilter/FindTimesAndBook",data:l,traditional:true,success:function(a){j(e,a,b)},error:function(){}})}function renderSessions(g,b,e){if((b==null||b.length==0)&&$("#noSessionsAtSelectCinemas").length>0){$(".cinema-row").hide();$("#noSessionsAtSelectCinemas").show();return}$("#noSessionsAtSelectCinemas").hide();$(".cinema-row").show();var a={};if(b!=null)for(var c=0;c<b.length;c++){var d=b[c].CinemaId;if(a[d]==null)a[d]=[];a[d].push(b[c])}$.each(g,function(f,c){var b=$("span[id='"+c.Id+"']",e),d=$("span.width-wrap",b);d.html("");if(a[c.Id]==null||a[c.Id].length==0)$(".cinema-row-wrapper",b).append("<p class='nosessions'>No sessions available</p>");else{$(".cinema-row-wrapper p.nosessions",b).remove();$.tmpl(sessionTimeTemplate,a[c.Id]).appendTo(d);EC.Scroller.init(b)}});$(".quick-times-select-widget .dates-row .btn").showSeatsHover();var f=ECWidget.movielistfilter.get_selectedExperiences();FilterSessions(f,null,e,true)}function FilterCinemaMovies(){var b=$("div.movie-list-item");b.hide();var a=$(".movie-overview-list .filters li.active"),c=a.filter("[data-id='gc']").length>0,g=a.filter("[data-id='vmax']").length>0,f=a.filter("[data-id='imax']").length>0,d=a.filter("[data-id='deluxe']").length>0,e=a.filter("[data-id='3d']").length>0;if(a.length==0)b.fadeIn();else b.each(function(){$("div.icons div.three-d-icon",this).length>0&&e&&$(this).fadeIn();$("div.icons div.goldclass-icon",this).length>0&&c&&$(this).fadeIn();$("div.icons div.vmax-icon",this).length>0&&g&&$(this).fadeIn();$("div.icons div.imax-icon",this).length>0&&f&&$(this).fadeIn();$("div.icons div.deluxe-icon",this).length>0&&d&&$(this).fadeIn()})}function ShowMovieIcons(c){if(c==null)$("div.movie-list-item").each(function(){var a=$("div.icons",this);a.html("");$("span.three-d-icon",this).length>0&&a.append("<div class='three-d-icon'></div>");$("span.goldclass-icon",this).length>0&&a.append("<div class='goldclass-icon'></div>");$("span.vmax-icon",this).length>0&&a.append("<div class='vmax-icon'></div>");$("span.imax-icon",this).length>0&&a.append("<div class='imax-icon'></div>");$("span.deluxe-icon",this).length>0&&a.append("<div class='deluxe-icon'></div>")});else{var b=$("div.movie-list-item[data-id='"+c+"']"),a=$("div.icons",b);a.html("");$("span.three-d-icon",b).length>0&&a.append("<div class='three-d-icon'></div>");$("span.goldclass-icon",b).length>0&&a.append("<div class='goldclass-icon'></div>");$("span.vmax-icon",b).length>0&&a.append("<div class='vmax-icon'></div>");$("span.imax-icon",b).length>0&&a.append("<div class='imax-icon'></div>");$("span.deluxe-icon",b).length>0&&a.append("<div class='deluxe-icon'></div>")}}function CinemaRefreshExperience(){$("#cinema-NowShowing ul.filters li").each(function(){var a=$(this).data("id")+"-icon";$(".cinema-row-wrapper ."+a).length>0&&$(this).show()})}function FormatSessionTime(a){var b=Date.parse(a);return b.toString("h:mm tt")}function FormatSessionClass(d,b,e){var a=[],c=false;if(b!=null&&b.toString().toLowerCase()=="gc"){c=true;a.push("goldclass-btn")}else if(b!=null&&b.toString().toLowerCase()=="vmax"){c=true;a.push("vmax-btn")}else if(b!=null&&b.toString().toLowerCase()=="deluxe"){c=true;a.push("deluxe-btn")}else if(e)a.push("three-d-btn");else if(d.length>0){var f=false;$.each(d,function(d,b){if(b.ShowOnSessionButton){c=true;a.push(b.Code.toLowerCase().replace(" ","-")+"-btn")}})}!c&&a.push("grey");return a.join(" ")}function FilterCinemaNowShowing(){var a=[];$("#cinema-NowShowing ul.filters li.active").each(function(){a.push($(this).data("id"))});var b=[];$("#cinema-NowShowing ul.filters li.active[data-type='session']").each(function(){b.push($(this).data("attr"))});$(".movie-list-item").show();FilterSessions(a,b)}function toJSON(a){return $.parseJSON(a)}function RenderSessionIcon(c,b,d){var a=[];d&&a.push("<span class='three-d-icon'></span>");if(b!=null&&b.toString().toLowerCase()=="gc")a.push("<span class='goldclass-icon'></span>");else if(b!=null&&b.toString().toLowerCase()=="vmax")a.push("<span class='vmax-icon'></span>");else b!=null&&b.toString().toLowerCase()=="deluxe"&&a.push("<span class='deluxe-icon'></span>");c!=null&&c.length>0&&$.each(c,function(c,b){b.Code&&a.push("<span class='"+b.Code.toLowerCase().replace(" ","-")+"-icon'></span>")});return a.length>0?a.join(""):""}function RefreshGenre(){var a=[],c=$(".movie-list-item");c.each(function(){var b=$(this).data("genres").toString().split(/[\s,]+/);$.each(b,function(c,b){$.inArray(b,a)==-1&&a.push(b)})});var b=$("#MovieGenreFilter div.wrap span");b.hide();b.each(function(){$.inArray($("label",$(this)).html(),a)>-1&&$(this).show()})}function FilterSessions(c,b,a,d){if(!a)a=$(".movie-list-item");if((c==null||c.length==0)&&(b==null||b.length==0))$(".btn",a).show();else{$(".btn:not(.find-times-and-book)",a).hide();$.each(c,function(c,b){$("."+b+"-btn",a).show()});b!=undefined&&$.each(b,function(c,b){$('.btn[data-attributes*=\'"Code":"'+b+"\"']",a).show()});!d&&$.each(a,function(c,a){if($(".cinema-row",$(this)).length>0){var b=$(".dates-row .btn",a).filter(function(){return $(this).css("display")!=="none"}).length;b===0&&$(a).closest(".movie-list-item").hide()}})}$(".cinema-row p.nosessions",a).remove();$.each($(".cinema-row",a),function(){var a=$(".cinema-row-wrapper",this),b=$(".btn",a).filter(function(){return $(this).css("display")!=="none"}).length;b==0&&a.append("<p class='nosessions'>No sessions available</p>")});EC.Scroller.init()}function getHas3d(){return $("#experience-filters span.active div[value='three-d']").length>0}function getScreenTypes(){var b=[],a=$("#experience-filters span.active div");a.length>0&&a.each(function(){$(this).data("type")=="screen"&&b.push($(this).attr("value"))});return b}function getAttributeCodes(){var b=[],a=$("#experience-filters span.active div");a.length>0&&a.each(function(){$(this).data("type")=="attribute"&&b.push($(this).attr("value"))});return b}function filterByExperience(){var a=[];$("ul.filters li.active").each(function(){if($(this).data("id")==="3d")a.push("three-d");else a.push($(this).data("id"))});FilterSessions(a,null)}function LazyLoadImages(a){console.log("lazy");if(typeof $().lazyload=="function")if(a==null){$("img.lazy").show().lazyload({threshold:200,skip_invisible:false});$(window).trigger("scroll")}else{if(!a.jquery)a=$(a);$("img.lazy",a).show().lazyload({threshold:200,skip_invisible:false});var b=a.data("events");if(b!==undefined&&b.scroll==null)a.trigger("scroll");else $(window).trigger("scroll")}}function movieCountdown(){var f=Date.parse($("#CountdownTimer").attr("releaseDate")),a=Math.floor((f-new Date)/1e3);if(a<=0){clearInterval(counter);$("#CountdownTimer").hide();return}var c=Math.floor(a/days);a-=c*days;var b=Math.floor(a/hours);a-=b*hours;var d=Math.floor(a/minutes);a-=d*minutes;var e=Math.floor(a);$("div.timer").text("OPENING IN "+c.toString()+" DAYS "+b.toString()+" HOURS "+d.toString()+" MINUTES AND "+e.toString()+" SECONDS")}(function(a){a.cookie=function(h,c,b){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(c))||c===null||c===undefined)){b=a.extend({},b);if(c===null||c===undefined)b.expires=-1;if(typeof b.expires==="number"){var j=b.expires,i=b.expires=new Date;i.setDate(i.getDate()+j)}c=String(c);return document.cookie=[encodeURIComponent(h),"=",b.raw?c:encodeURIComponent(c),b.expires?"; expires="+b.expires.toUTCString():"",b.path?"; path="+b.path:"",b.domain?"; domain="+b.domain:"",b.secure?"; secure":""].join("")}b=c||{};for(var f=b.raw?function(a){return a}:decodeURIComponent,g=document.cookie.split("; "),e=0,d;d=g[e]&&g[e].split("=");e++)if(f(d[0])===h)return f(d[1]||"");return null};baseCdnUrl=a("#cdnUrl").attr("path")})(jQuery);function showShareButtons(f,d,b,c){if(typeof gigya!="undefined"){var a=new gigya.socialize.UserAction;a.setTitle(f);a.setLinkBack(d);b!=null&&b.length>0&&a.setDescription(b);c!=null&&c.length>0&&a.addMediaItem({type:"image",src:c,href:d});var e={containerID:"divButtons",shareButtons:"Facebook-Like,Twitter-Tweet",userAction:a};gigya.socialize.showShareBarUI(e)}}function selectSeat(a,c){if(a.attr("data-seat").length==0||a.hasClass("blacken"))return;if(!a.hasClass("selected")){if($(".seat-selection .seats li.selected").length>=c){EC.Alert("ALL SEATS HAVE BEEN SELECTED<br />You have already selected all of your seats.<br />To make alternative choices please toggle your seats(s) on and off<br />by clicking on them again.");return}a.addClass("selected")}else a.removeClass("selected");var b=[];$(".seat-selection .selected").each(function(){var a=$(this);b.push(a.data("seat"))});$("#SelectedSeats").val(b.join(";"));var e={count:b.length,total:parseInt($("#TotalSeats").val())},d="<strong>Seats</strong><div>${count} of ${total} seat(s)</div>";$("#SummaryOfSeats").html("");$.tmpl(d,e).appendTo($("#SummaryOfSeats"))}function getMovieName(){var a=$(".what-blowout .movie-overview p.title[data-id="+5253+"]");return a.length>0?a.text():""}function getCinemaUrl(c){for(var b=$(".cinemaItem a"),a=0;a<b.length;a++)if($(b[a]).text().toLowerCase()==$.trim(c.toLowerCase()))return $(b[a]).attr("href");return"#"}function updateTicketBarCinemas(){if(EC.PreferredCinemas.count()>1)$("#where").html("<em class='star'></em>My preferred cinemas <em class='arrow-down'></em>");else if(EC.PreferredCinemas.count()==1)$("#where").html("<em class='star'></em>"+EC.PreferredCinemas.getCinemaName(EC.PreferredCinemas.get(0).Id)+"<em class='arrow-down'></em>");else if(EC.PreferredCinemas.count()==0){$("#where").html("Select cinema(s)<em class='arrow-down'></em>");$(".find-times-and-book").addClass("set-preferred-cinemas")}$.each(EC.PreferredCinemas.all(),function(b,a){$(".where-blowout span div[id="+a.Id+"]").parent().addClass("active")})}function getSeatingPlan(d,c,a,b){var e={sessionId:d,useLiveData:c,showCinemaDetails:true,seatData:null};$.ajax({url:"/Ticketing/SessionSeating",data:e,success:function(b){a!=null&&a(b)},error:function(a){b!=null&&b(a)}})}function GetUserFilter(){$(".filters li").each(function(){$(this).removeClass();if($(this).is(":visible"))if($(this).attr("data-id")!==undefined)$(this).addClass($.cookie($(this).attr("data-id")));else $(this).addClass($.cookie($(this).attr("id")))});$("#cinema-NowShowing").length>0&&FilterCinemaNowShowing();filterByExperience()}function CreateClickEventsToStoreUserFilter(){$(".filters").on("filter-clicked","li",function(){if($(this).attr("data-id")!==undefined)$.cookie($(this).attr("data-id"),$(this).attr("class"),{path:"/",expires:7300});else $.cookie($(this).attr("id"),$(this).attr("class"),{path:"/",expires:7300})})}function updateBirthDate(){$("#User_BirthDay").val(Date.parse($("#year").val()+"-"+$("#month").val()+"-"+$("#day").val()).toString("yyyy-MM-dd"))}function MetresToKilometres(a){var b=a/1e3;return b.toFixed(2)}function formatPhoneNumber(a){return a.replace(/[\s()-]/g,"")}var cinebuzzCardTemplate="<input type='hidden' name='CinebuzzCards.index' value='${Guid}' /><input type='tel' class='cinebuzz-number' name='CinebuzzCards[${Guid}]' id='CinebuzzCards_${Guid}__Id' />";function showMovieClassification(){$.ajax({url:"/Movie/Classification",dataType:"text",success:function(a){EC.Message("Classification Descriptions",a)}})}function onGigyaServiceReady(){console.log("gigyaloaded");$(document).trigger("gigyaloaded")}function isFunction(a){return typeof a==="function"}function pad(a,c,b){b=b||"0";a=a+"";return a.length>=c?a:new Array(c-a.length+1).join(b)+a}EC.getCdnImage=function(a){return baseCdnUrl+"img/"+a};$(function(){$("span.eccheckbox").live("click",function(){if($(this).hasClass("active")){$(this).removeClass("active");$("input",this).val(false);$(this).trigger("unchecked")}else{$(this).addClass("active");$("input",this).val(true);$(this).trigger("checked")}$(this).trigger("filter-clicked")});EC.PreferredCinemas.init();$.trim($("#errormessage").html())!=""&&EC.Alert($("#errormessage").html());$("#ErrorMessage").length>0&&EC.Alert($("#ErrorMessage").val());var a=$.bbq.getState().error;if(a){EC.Alert(a);location.replace("#");$.isFunction(history.replaceState)&&history.replaceState({},"",window.location.href.slice(0,-1))}$(".ratings a").live("click",function(){showMovieClassification()});$(".logout").live("click",function(){$.cookie("Cinebuzz",null,{path:"/"});EC.post({url:"/Cinebuzz/logout",success:function(){EC.PreferredCinemas.clear();$.cookie("Cinebuzz",null,{path:"/"});window.location.reload();$("#cine-buzz").data("loggedin",false);var a=$("#cdnUrl").attr("path")+"img/cinebuzz-rewards.png";$("#cine-buzz").html("<img src="+a+' alt="cinebuzz-rewards" /><p><a href="/Cinebuzz/join">Sign up</a> | <a href="/Cinebuzz">Login</a></p>')}});return false});$(".set-preferred-cinemas").die("click");$(".set-preferred-cinemas").live("click",function(){ECWidget.movierotator.hasRotator()&&ECWidget.movierotator.stopRotator();$("#cover").show();$(this).addClass("active");$(".where-blowout").addClass("in-the-middle").show();var c=$("div.where-blowout ul.head li.active a").html();$(".where-blowout .btn").addClass("wider").text("continue booking");var b=$(this).attr("id"),a=[];b!=null&&a.push(b);$(".where-blowout span").show();EC.SessionFilter.CinemasGetByState(c,a);$(this).removeClass("active")});$(".main .movies .image-wrapper img").unbind("click");$(".main .movies .image-wrapper img").click(function(){var a=$(this).parent().find(".details-link");if(a.length!=0)window.location.href=$(a).attr("href")});$(".main .movies .image-wrapper .title").unbind("click");$(".main .movies .image-wrapper .title").click(function(){var a=$(this).siblings(".details-link");if(a.length!=0)window.location.href=$(a).attr("href")});$("#siteSearch input.red-search-btn").click(function(){window.location="/Search#s="+$("#siteSearch .search").val();return false});$("#siteSearch :input").onEnterClick("#siteSearch input.red-search-btn");$("#BackgroundImage").length>0&&changeSkinBackgroundSet($("#BackgroundImage").val());LazyLoadImages();$("#ticket-bar").length>0&&ECWidget.sessionfilter.init();location.protocol=="http:"&&$.cookie("_ecloki")!=null&&document.referrer!==document.location.href.replace(document.location.hash,"");$(".btn.manual-cinema").live("click",function(){if(!$("body").hasClass("editable")){EC.Alert("Unfortunately you cannot buy tickets online for this cinema");return false}});$("label a[href]").click(function(){if(this.getAttribute("target")==="_blank")window.open(this.href,"_blank");else window.location=this.href;return false});iePlaceholder();$("body").on("click","footer a",function(){EC.ga("Footer","Link",$(this).parent().hasClass("mashup")?"Mashup":$(this).text())})});(function(a,f,e,g,b,c,d){a.GoogleAnalyticsObject=b;a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date;c=f.createElement(e),d=f.getElementsByTagName(e)[0];c.async=1;c.src=g;d.parentNode.insertBefore(c,d)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-230551-1","auto");ga("require","displayfeatures");ga("send","pageview");$(function(){$(document).bind("gigyaloaded",function(){console.log("menu");var b={containerID:"shareDiv",iconSize:25,buttons:[{provider:"facebook",actionURL:"http://www.facebook.com/EventCinemas",action:"dialog",iconURL:$("#cdnUrl").attr("path")+"img/fb.png"},{provider:"twitter",action:"dialog",followUsers:"eVent_cinemas",iconURL:$("#cdnUrl").attr("path")+"img/tw.png"},{provider:"youtube",action:"window",actionURL:"http://www.youtube.com/user/eventcinemas",iconURL:$("#cdnUrl").attr("path")+"img/yt.png"},{provider:"custom",action:"window",actionURL:"http://instagram.com/event_cinemas",iconURL:$("#cdnUrl").attr("path")+"img/insta.png"}]};gigya.socialize.showFollowBarUI(b);var a=new gigya.socialize.UserAction;a.setTitle("Event Cinemas");a.setLinkBack("");a.setDescription("");$(".share_li").click(function(){gigya.socialize.showShareUI({userAction:a})});if($("#divButtons").length>0){console.log("Social buttons: "+$("#divButtons").length);$("#divButtons").each(function(){var c=document.title,d=window.location.href,a=$("#Synopsis",this).val(),b=$("#ImageUrl",this).val();console.log("showShareButtons");showShareButtons(c,d,a,b)})}})});console.log("05_Movies");var counter,days=24*60*60,hours=60*60,minutes=60;function nav(d,a){var b="";if(EC.MovieViewMode.get(d)!=null)b=EC.MovieViewMode.get(d);var c=GetBaseUrl();console.log("query string: "+a);console.log("relativePath:"+d);console.log("search: "+b);if(a.indexOf("/")!=0&&a.indexOf("?")==-1)a="?"+a;if(d!=null&&d.length>0){c+=d;if(a!=null&&a.length>0){if(a.indexOf("?")>0)a=a.substr(a.indexOf("?"));console.log("trimmed query string:"+a);c+=a;if(b!=null&&b.length>0)c+="&"+b}else if(b!=null&&b.length>0)c+="?"+b}else if(a!=null&&a.length>0){c+=a;if(b.length>0)c+="&"+b}EC.MovieViewMode.set(d,b);console.log("nav to url: "+c);window.location=c}function cancelTimeline(){$("#timeline-section").hide();$("#movie-overview-list").show();ECWidget.sessionfinderfilter.filterMovies()}function timelineNoFilter(){$("#movie-overview-list").hide();$("#timeline-section").show();var a=getSessions();$("#timeline").html("");addSessionTable(a);ECPage.movie.currentTimeLineFilter=timelineNoFilter;return false}function timelineFilterByMovie(){$("#movie-overview-list").hide();$("#timeline-section").show();ECPage.movie.currentTimeLineFilter=timelineFilterByMovie;var b=getSessions();b=b.sort(function(a,b){return a.movieId-b.movieId});$("#timeline").html("");var a=[],c=undefined;$.each(b,function(){if(!c||this.movieId!=c){c=this.movieId;if(a.length>0){addSessionTable(a,a[0].movieName,a[0].rating);a=[]}}this.fMovie=true;a.push(this)});if(a.length>0){addSessionTable(a,a[0].movieName,a[0].rating);a=[]}return false}function timelineFilterByCinema(){$("#movie-overview-list").hide();$("#timeline-section").show();ECPage.movie.currentTimeLineFilter=timelineFilterByCinema;var b=getSessions();b=b.sort(function(a,b){return a.cinemaId-b.cinemaId});$("#timeline").html("");var a=[],c=undefined;$.each(b,function(){if(!c||this.cinemaId!=c){c=this.cinemaId;if(a.length>0){addSessionTable(a,a[0].cinemaName);a=[]}}this.fCinema=true;a.push(this)});if(a.length>0){addSessionTable(a,a[0].cinemaName);a=[]}return false}function setTimelineSlider(a){var b=new Date(a[0].startTime);b.setMinutes(0);var d=getLastSessionFromArray(a),c=Math.round(diffMs/36e5)}function getSessions(){var c=[],a=0,b=0,d=$("#movie-overview-list");$(".movie-list-item",d).each(function(j,i){a=0;var d=$(i),h=d.data("id"),f=d.data("runningtime"),e=$(".cinema-movie-times-info > .title",d).html(),g=$(".cinema-movie-times-info > .ratings",d).clone();b++;$(".cinema-row",d).each(function(k,b){var d=$(b),j=b.id,i=$("span.title",d).html();a++;$(".btn",d).each(function(o,d){var a=$(d);if(a.css("display")!="none"){var n=a.data("id"),b=Date.parse(a.data("starttime")),k=a.attr("href"),m=a.attr("class"),p=a.html(),l=$("<div/>").append($("span",a).clone()).html();c.push({movieId:h,runningTime:f,cinemaId:j,cinemaName:i,sessionId:n,startTime:b,link:k,type:m,movieName:e,time:formatAMPM(b),rating:g,icon:l,showSeating:a.data("showseating"),attributes:a.data("attributes"),screenId:a.data("screenid")})}})})});a==1&&$("#timeline-group-cinema").hide();b==1&&$("#timeline-group-cinema").hide();a==1&&b==1&&$("#timeline-buttons").hide();return c}function getLastSessionFromArray(b){var a;$.each(b,function(){var b=new Date(this.startTime.getTime()+(this.runningTime+15)*6e4);if(!a||b>a)a=b});a.setHours(a.getHours()+1);a.setMinutes(0);return a}function addSessionTable(a,i,k){a=a.sort(function(a,b){return a.startTime-b.startTime});var c=$("<div/>").addClass("timeline-inner"),b=$("<table/>").addClass("timeline-back").append($("<thead/>")).append($("<tr/>"));c.append(b);i&&$("#timeline").append($("<strong/>").addClass("title").html(i)).append(k);$("#timeline").append(c);var j=getLastSessionFromArray(a),f=new Date(a[0].startTime);f.setMinutes(0);var e=new Date(f),h=0;while(e<j){var l=$("thead",b).append("<td>"+formatAMPM(e)+"</td>");$("tr",b).append("<td/>");e=new Date(e.getTime()+36e5);h+=100}b.width(h);var d=30,g={};$.each(a,function(){var a=$.tmpl($("#timelineSessionTemplate"),this),k=Math.floor((this.startTime-f)/1e3/60),h=(this.runningTime+15)*1.667-16,l=k*1.667;this.attributes&&a.data("attributes",this.attributes);if($("span",a).length>0){var b=5,j=8;$.each($("span",a),function(){var c=$(this);c.css("right",b);b+=20;a.css("padding-right",b+j)});h-=b}var i=d,e=this.screenId;if(g[e]!=undefined)i=g[e];else{g[e]=d;d+=35}a.width(h);a.css("top",i);a.css("left",l);c.append(a)});b.height(d+30);$(".btn",c).showSeatsHover()}function formatAMPM(c){var a=c.getHours(),b=c.getMinutes(),e=a>=12?"PM":"AM";a=a%12;a=a?a:12;b=b<10?"0"+b:b;var d=a+":"+b+" "+e;return d}function FormatDateComingSoon(a){return a!==undefined?Date.parse(a).toString("dd MMMM"):""}$(function(){$(".poptrailer").click(function(){var b=isTrue($(this).data("showloading")),c=$(this);b&&c.loading(true);var a=$(this).data("movieid");if(!a)a=$(this).attr("movieid");LoadTrailer(a,function(){b&&c.stopLoading()})});$("#trailer").on("click",".items li:not(.add)",function(){showTrailer($(this))});$("#trailer").on("click",".close",function(){closeTrailer()});$("#awesome-trailer .items a").live("click",function(){showAwesomeTrailer($(this))});$("#awesome-trailer .close").live("click",function(){closeAwesomeTrailer()});$("#cover").click(function(){closeTrailer()});$(".trailer-scroller-right").live("click",function(){moveSliderRight()});$(".trailer-scroller-left").live("click",function(){moveSliderLeft()})});(function(a){var b=false;a.fn.showSeatsHover=function(){a("#quick-view-seats").mouseenter(function(){b=true;clearTimeout(a(".quick-times-select-widget").data("timeoutId"))}).mouseleave(function(){b=false});var c={over:showQuickSeats,timeout:500,out:emptyFunction};a(this).mouseleave(function(){setTimeout(function(){!b&&a("#quick-view-seats").fadeOut(100)},10)});a(this).hoverIntent(c)}})(jQuery);EC.QuickTimesSeats={init:function(){$(".quick-times-select-widget .dates li").live("click",function(){$(this).parent().find(".active").removeClass("active");$(this).addClass("active");var c=$(this).data("value"),b=$(this).parents(".quick-times-select-widget"),d=b.data("movieid"),a=[];if($("#cinema-filters").length==1)$("#cinema-filters span.active").each(function(){var b=$("div",this).data("id");a.push({Id:b,Name:EC.PreferredCinemas.getCinemaName(b)})});else $.each(EC.PreferredCinemas.all(),function(c,b){a.push({Id:b.Id,Name:b.Name})});showSessionTime(d,c,a,renderSessions,b)});$(".quick-times-select-widget .btn").showSeatsHover();$(".find-times-and-book").hoverIntent({over:showQuickTimesWidget,timeout:500,out:emptyFunction});$(".quick-times-select-widget").mouseenter(function(){clearTimeout($(this).data("timeoutId"))}).mouseleave(function(){if(!$(this).parent().hasClass("movie-list-item")){var a=setTimeout(function(){hideQuickTimesWidget()},150);$(this).data("timeoutId",a)}});$("#quick-view-seats a.quick-view").unbind("click");$("#quick-view-seats a.quick-view").live("click",function(){$("#quick-view-seats").hide();$("#quick-times-widget-upon-hover .quick-times-select-widget").hide();$("#cover").show();$(".seat-selection#onpop").html("<a class='close' /><p><img src='"+baseCdnUrl+"/img/loader-red.gif' /> Loading seating plan...</p>");$(".seat-selection#onpop .close").click(function(){$("#cover").hide();$(".seat-selection#onpop").hide()});$(".seat-selection#onpop").show();var a=$(this).parents("#quick-view-seats").data("sessionid");getSeatingPlan(a,false,function(a){$(".seat-selection#onpop").remove();$("body").append(a);$(".seat-selection").attr("id","onpop");$(".seat-selection").prepend("<a class='close'></a>");$(".seat-selection#onpop .close").click(function(){$("#cover").hide();$(".seat-selection#onpop").hide()});$(".seat-selection#onpop .close").click(function(){$("#cover").hide();$(".seat-selection#onpop").hide()});$(".seat-selection#onpop").show()},function(a){$(".seat-selection#onpop").remove();$("body").append(a.responseText);$(".seat-selection").attr("id","onpop");$(".seat-selection").prepend("<a class='close'></a>");$(".seat-selection#onpop .close").click(function(){$("#cover").hide();$(".seat-selection#onpop").hide()});$(".seat-selection#onpop .close").click(function(){$("#cover").hide();$(".seat-selection#onpop").hide()});$(".seat-selection#onpop").show()})});$("#cover").click(function(){$(this).hide();$(".seat-selection#onpop").hide()});$(".seat-selection#onpop .close").unbind("click");$(".seat-selection#onpop .close").click(function(){$("#cover").hide();$(".seat-selection#onpop").hide()})}};$(function(){ie&&$(".quick-times-select-widget .cinema-row .btn").each(function(){var a=60;$("span",this).each(function(){a+=$(this).width()});$(this).width(a)})});function iePlaceholder(){$.fn.placeholder&&$("input, textarea").placeholder()}ECWidget.cinemaenquiry={init:function(){var a=this;$("#enquiry").bind("click",function(){a.showForm();return false});$(".overlay").click(function(a){a.preventDefault();a.stopPropagation();return false});$(".overlay .close").click(function(){$("#cover").hide();$(".overlay").hide();return false});$("#enquirySubmit").click(function(){if($("#enquiryText").valid()){var b=$(this);if(b.isLoading())return false;b.loading(true);var a=$(".overlay"),c={Id:$("#Id",a).val(),FirstName:$("#FirstName",a).val(),Surname:$("#Surname",a).val(),Date:$("#Date",a).val(),Time:$("#Time",a).val(),Telephone:$("#Telephone",a).val(),EmailAddress:$("#EmailAddress",a).val(),Comments:$("#Comments",a).val()};EC.post({url:"/Cinema/Enquiry",data:c,success:function(){$(".overlay").hide();$("#cover").hide();EC.Message("Enquiry Sent","Your enquiry has been sent");$(".overlay input:text").val("");$(".overlay textarea").val("");b.stopLoading()},error:function(){EC.Alert("There was an error sending your enquiry");b.stopLoading()}})}return false})},showForm:function(){$("#cover").show();$(".overlay").show()}};ECWidget.cinemanowshowing={dateScroller:null,init:function(){EC.Scroller.init();$("#cinema-NowShowing").data("cinemaid")==512&&$('img[title="ec-logo"]').attr("src",EC.CdnUrl("img/embassy-logo.png"));if($('.widget[data-controller="manualcinema"]').length>0){var c=$(".cinema-print").closest(".strip");c.siblings(".movie-overview-list").hide();c.hide()}var a=$("#cinema-NowShowing"),b=$(".dates ul",a);$(window).bind("hashchange",function(){var c=$.bbq.getState();if(typeof c.date=="undefined"){$("li:first",b).addClass("active");loadCinemaNowShowingMovies(a.data("cinemaid"),$("li:first",b).data("value"))}else{loadCinemaNowShowingMovies(a.data("cinemaid"),c.date);$("li.active",b).removeClass("active");$("li[data-value='"+c.date+"']",b).addClass("active")}});$(".filters li",a).click(function(){if($(this).hasClass("active"))$(this).removeClass("active");else $(this).addClass("active");$(this).trigger("filter-clicked")});$(".filters li",a).bind("filter-clicked",function(){FilterCinemaNowShowing()});$("#trailer .close").on("click","a",function(){closeTrailer()});$("#cover").click(function(){closeTrailer()});$(".cinema-promo-slider").cycle({fx:"fade",speed:1e3,timeout:4e3,next:".arrow-right",prev:".arrow-left",cleartype:1,cleartypeNoBg:1});$(".datesrow li").click(function(){var a=$(this).data("value");$.bbq.pushState({date:a})});$(window).trigger("hashchange");EC.QuickTimesSeats.init()}};function loadCinemaNowShowingMovies(b,d){var a=$("#cinema-NowShowing");$("div.movie-list-item",a).remove();addLoader("#cinema-NowShowing","movies");var c={cinemaId:b,day:d,source:"WWW|Cinemas"};EC.get({url:"/Cinema/DailySessions",data:c,success:function(a){removeLoader("#cinema-NowShowing");$("#cinema-NowShowing").append(a);EC.Scroller.init($("#cinema-NowShowing"));ShowMovieIcons();CinemaRefreshExperience();LazyLoadImages("#cinema-NowShowing");$(".quick-times-select-widget .btn").showSeatsHover();$("#quick-view-seats a.quick-view").click(function(){$("#cover").show();$(".seat-selection#onpop").show()});FilterCinemaNowShowing()}})}ECWidget.findcinemas={loadCinemas:function(b){console.log("load cinemas: ");console.log(b);$("#geolocateMessage").hide();if(b.length==0)EC.Alert("Sorry we could not find any cinemas near your location.  Please search cinemas by state below.");else{$("div.listing").hide();$(".cinema-pref-list li").removeClass("active");var a=$("div[id='Current Location']");a.html("");$.tmpl(ECWidget.findcinemas.cinemaTemplate,b).appendTo(a);a.append("<div class='clearfix'></div>");a.fadeIn(200);$("ul.head li").last().addClass("active").fadeIn(200);$('input[name="PreferredCinemas"]').each(function(){$(".cinemasByLocation label[for='"+$(this).val()+"']").closest(".eccheckbox").addClass("active")})}},loadCinemasNearMe:function(b,a){EC.get({url:"/Cinema/CinemasNearMe",data:{latitude:b,longitude:a,numToReturn:5},success:function(a){ECWidget.findcinemas.loadCinemas(a)}})},cinemaTemplate:"<span class='eccheckbox preferred-cinema'><div class='checkbox'  data-id='${Id}'></div><label for='${Id}'>${Name} <dd>${MetresToKilometres(Distance)} km away</dd></label></span>"};ECWidget.homepremiumcinemabox={init:function(){$("#premium-cinema-box .top a").click(function(){$("#premium-cinema-box .top .active").removeClass("active");$(this).parent().addClass("active");$("#premium-cinema-box .items a").hide();$("#premium-cinema-box .items a#"+$(this).parent().attr("id")+"_item").show()});var c=$.cookie("hunger"),e=c==null&&!($("html.ie8").length>0||$("html.ie8").length>0),b=new Date(2013,11-1,21),a=b;if($("html.nz").length===0)a=new Date(b-(660+b.getTimezoneOffset())*6e4);var d=baseCdnUrl+"img/hunger/hanger3.jpg",f=baseCdnUrl+"img/hunger/bg2.jpg",g=baseCdnUrl+"img/hunger/new_timer3.png";if(new Date<a){if(e){showHungerModal(a,f,g);$.cookie("hunger",true,{path:"/",expires:7300})}$("#whereBlowout").after($("<div/>").attr("id","promo-hanger").addClass("footer-wrapper").html('<img src="'+d+'" /><a class="close-hanger">x</a><div class="timer"><div class="days"></div><div class="hours"></div><div class="mins"></div><div class="secs"></div></div>'));$(".close-hanger").click(function(){$("#promo-hanger").slideUp();return false});setTimeout(function(){$("#promo-hanger").slideDown();$(window).trigger("resize")},2e3);$("<div/>").countdown({digits:[,'<div class="t1"></div>','<div class="t2"></div>','<div class="t3"></div>','<div class="t4"></div>','<div class="t5"></div>','<div class="t6"></div>','<div class="t7"></div>','<div class="t8"></div>','<div class="t9"></div>'],until:a,onTick:function(a){var b=$("#promo-hanger");$(".days",b).html(ECWidget.homepremiumcinemabox.getInnerDiv(a[3]));$(".hours",b).html(ECWidget.homepremiumcinemabox.getInnerDiv(a[4]));$(".mins",b).html(ECWidget.homepremiumcinemabox.getInnerDiv(a[5]));$(".secs",b).html(ECWidget.homepremiumcinemabox.getInnerDiv(a[6]))},tickInterval:1});$("#promo-hanger").click(function(){window.location="/movie/The-Hunger-Games-Catching-Fire";return false});$(window).bind("resize",function(){$("#promo-hanger .timer").css("left",$("#promo-hanger img").offset().left-$("#promo-hanger").offset().left+653)})}},getInnerDiv:function(a){var b=parseInt(a/10),c=a%10;return jQuery.validator.format(countdownDivFormat,b)+jQuery.validator.format(countdownDivFormat,c)},movieHanger:function(){var c=new Date(2014,11-1,26);if(new Date<c){var b=baseCdnUrl+"img/million/1M_Small.png",a=$("<div/>").attr("id","promo-hanger").addClass("footer-wrapper").html('<a href="/EventsPromotions/1MillionCompetition"><img src="'+b+'" /></a><a class="close-hanger">x</a>');$("#whereBlowout").after(a);$(".close-hanger").click(function(){$("#promo-hanger").slideUp();return false});setTimeout(function(){a.slideDown()},3e3)}}};var countdownDivFormat='<div class="digit t{0}"></div>';function showHungerModal(c,a,b){$("#whereBlowout").after($("<div/>").attr("id","promo-modal"));$("#promo-modal").html('<img src="'+a+'" /><span class="close-here">Click here to close  X</span><div class="timer"><img src="'+b+'" /><div class="days"></div><div class="hours"></div><div class="mins"></div><div class="secs"></div></div>');$("#promo-modal").click(function(){$("#promo-modal").fadeOut()});setTimeout(function(){$("#promo-modal").fadeIn("slow");$(window).trigger("resize")},1e3);$("<div/>").countdown({digits:[,'<div class="t1"></div>','<div class="t2"></div>','<div class="t3"></div>','<div class="t4"></div>','<div class="t5"></div>','<div class="t6"></div>','<div class="t7"></div>','<div class="t8"></div>','<div class="t9"></div>'],until:c,onTick:function(a){var b=$("#promo-modal .timer");$(".days",b).html(ECWidget.homepremiumcinemabox.getInnerDiv(a[3]));$(".hours",b).html(ECWidget.homepremiumcinemabox.getInnerDiv(a[4]));$(".mins",b).html(ECWidget.homepremiumcinemabox.getInnerDiv(a[5]));$(".secs",b).html(ECWidget.homepremiumcinemabox.getInnerDiv(a[6]))},tickInterval:1});$(window).bind("resize",function(){var a=$("#promo-modal img:first").width()*.564+$("#promo-modal img:first").offset().left;$("#promo-modal .timer").css("left",a)})}ECWidget.movieinfo={init:function(){console.log("ECWidget.movieinfo.init");var b=$("h1#movie-info"),d=b.data("id"),f=b.data("hasgallery")=="True",c=b.data("hastrailer")=="True",g=b.data("skin"),e=b.data("skintitle");changeSkinBackground(d,g);var a=window.location.pathname;if(a[a.length-1]=="/")a=a.substr(0,a.length-1);changeCallToActionInfo(d,a,e);!f&&$(".call-to-action .opengallery").hide();!c&&$(".call-to-action .poptrailer").hide();c&&isTrue(getParam("media"))&&setTimeout(function(){$(".call-to-action .poptrailer").trigger("click")},1e3)}};ECWidget.movieinfogallery={init:function(){console.log("ECWidget.movieinfogallery.init");if($("#slider.animate").length>0&&$("#slider.animate").is(":visible")){initAnimatedSlider();ECWidget.movierotator.timer==null&&ECWidget.movierotator.startRotator()}$("#slider .arrow-right").click(function(){moveSliderRight()});$("#slider .arrow-left").click(function(){moveSliderLeft()});$("#slider.animate").on("click","a",function(){ECWidget.movierotator.stopRotator();$("#slider.animate").find("a.active").removeClass("active");$(this).addClass("active");if($("img",this).data("isstatic"))ECWidget.movierotator.stopRotator();else ECWidget.movierotator.startRotator();changeSkin(false)})}};ECWidget.movielist={init:function(){var a=null;$(".where-blowout").on("selectCinema","span",function(){var b=1;if(ie)b=500;a!=null&&clearTimeout(a);a=setTimeout(function(){var a=$(".tools .list").hasClass("active");if(a){$("#movie-overview-list .movie-list-item .quick-times-select-widget").html("");$(".no-preferred-cinemas-set").hide();$("a.list").trigger("initListLoad")}ECWidget.movielistfilter.filterMovies()},b)});this.initListThumbButtons();EC.QuickTimesSeats.init()}};ECWidget.movielistfilter={_movieFilter:null,_cinemaFilter:null,$movieFilter:function(){if(this._movieFilter==null)this._movieFilter=$("#movie-filter");return this._movieFilter},$cinemaFilter:function(){if(this._cinemaFilter==null)this._cinemaFilter=$("#cinema-filters",this.$movieFilter());return this._cinemaFilter},whereBlowoutHandler:function(b,d,e){var a=$("#cinema-filters");if(e)if($("#cinema-filters div[data-id='"+b+"']").size()>0)$("#cinema-filters div[data-id='"+b+"']").parent().addClass("active");else a.prepend("<span class='active eccheckbox'><div class='checkbox' value='"+d+"' data-id='"+b+"'></div> <label for='"+b+"'>"+d+"</label></span>");else $("span div[data-id='"+b+"']",a).parent().remove();$("span",a).addClass("active");var c=$("span",a).get();c.sort(function(c,d){var a=$("div",c).attr("value").toLowerCase(),b=$("div",d).attr("value").toLowerCase();return a<b?-1:a>b?1:0});$.each(c,function(c,b){$("a",a).before(b)})},_get_experiencesFromParams:function(){var a=getParameterByName("experience");return a!=null&&a.length>0?a.split(/[\s,]+/):[]},_get_sessionAttributesFromParams:function(){var a=getParameterByName("attributes");return a!=null&&a.length>0?a.split(/[\s,]+/):[]},_get_genresFromParams:function(){var a=getParameterByName("genres");return a!=null&&a.length>0?a.split(/[\s,]+/):[]},_get_keywordsFromParams:function(){var a=getParameterByName("keyword");return a!=null&&a.length>0?a:null},get_keyword:function(){return $.trim($("#movie-filter input#movieKeywordTextbox").val())},get_selectedCinemas:function(){var a=[];$("#cinema-filters span.active div",this.$movieFilter).each(function(){var b=$(this).data("id");a.push(b.toString())});return a},get_selectedSessionAttribute:function(){var a=[];$("#experience-filters span.active div[data-type='attribute']",this.$movieFilter).each(function(){var b=$(this).data("value");a.push(b.toString())});return a},get_selectedGenres:function(){var a=[];$("#MovieGenreFilter span.active label").each(function(c,b){a.push($(b).text())});return a},get_selectedExperiences:function(){var a=[];$("#experience-filters span.active div[data-type!='attribute']",this.$movieFilter).each(function(d,c){var b=$(c).data("value");b==="gc"&&a.push("goldclass");a.push(b)});return a},init:function(){console.log("ECWidget.movielistfilter.init");$("span",this.$cinemaFilter()).remove();EC.PreferredCinemas.sort();$.each(EC.PreferredCinemas.all(),function(b,a){if(ECWidget.movielistfilter.$cinemaFilter().length>0)if(a.Id!="")a.Name!=null&&a.Name!=""&&ECWidget.movielistfilter.$cinemaFilter().prepend("<span class='active eccheckbox'><div class='checkbox' value='"+a.Name+"' data-id='"+a.Id+"'></div> <label for='"+a.Id+"'>"+a.Name+"</label></span>")});var a=$("span",ECWidget.movielistfilter.$cinemaFilter()).get();a.sort(function(c,d){var a=$("div",c).attr("value").toLowerCase(),b=$("div",d).attr("value").toLowerCase();return a<b?-1:a>b?1:0});$.each(a,function(b,a){$("a",ECWidget.movielistfilter.$cinemaFilter()).before(a)});$.each(this._get_experiencesFromParams(),function(c,b){var a=$("#experience-filters div[data-value='"+b+"']");a.length>0&&a.parent().addClass("active")});$.each(this._get_sessionAttributesFromParams(),function(c,b){var a=$("#experience-filters div[data-value='"+b+"']");a.length>0&&a.parent().addClass("active")});$.each(this._get_genresFromParams(),function(c,b){var a=$("#MovieGenreFilter div[value='"+b+"']");a.length>0&&a.parent().addClass("active")});$("#movieKeywordTextbox").val(this._get_keywordsFromParams());$("#MovieGenreFilter").length>0&&RefreshGenre();$("#movie-filter").off("filter-clicked");$("#movie-filter").on("filter-clicked",".filter-element span",function(){ECWidget.movielistfilter.filterMovies();$("#cinema-filters span.active").length==0&&$(".find-times-and-book").addClass("set-preferred-cinemas")});$("#movie-filter .filters li").unbind("click");$("#movie-filter.filters li").bind("click",function(){if($(this).hasClass("active"))$(this).removeClass("active");else $(this).addClass("active");$(this).trigger("filter-clicked")});$("#movie-filter input#movieKeywordTextbox").keyup(function(){delay(function(){ECWidget.movielistfilter.filterMovies()},500)});ECWidget.sessionfilter.$whereBlowout.on("selectCinema","span",function(){var a=$("div",this),c=a.attr("id"),b=a.attr("value");ECWidget.movielistfilter.whereBlowoutHandler(c,b,$(this).hasClass("active"))})},filterMovies:function(){this.$movieFilter().trigger("movieFilter");console.log("triggering movieFilter")}};ECWidget.movielistnowshowing={init:function(){if($("#slider.AlternateContentSlider").length>0){$("#slider.AlternateContentSlider .top li").unbind("click");$("#slider.AlternateContentSlider .top li").click(function(){rotatorAlternateContent($(this))});rotatorAlternateContent($("#slider.AlternateContentSlider .top li.active"))}}};ECWidget.movierotator={timer:null,init:function(){var a=this;if($(".rialto-bar").length===0&&$("html.nz").length===0){var b=new Date,d=new Date(2014,8-1,14,0,0,0,0),c=new Date(2014,7-1,31,0,0,0,0);b<d&&b>c&&a.HomePageTakeOver()}FilterMovies();ECWidget.sessionfilter.$whereBlowout!=null&&ECWidget.sessionfilter.$whereBlowout.length>0&&ECWidget.sessionfilter.$whereBlowout.bind("setcinema",function(){if($("#rotatorNowShowing").hasClass("active"))a.rotatorNowShowing(true);else $("#rotatorAdvancedTickets").hasClass("active")&&a.rotatorAdvancedTickets(true)});$("#slider.animate").length>0&&$("#slider.animate").is(":visible")&&a.rotatorNowShowing(true);$("#slider .arrow-right").click(function(){moveSliderRight()});$("#slider .arrow-left").click(function(){moveSliderLeft()});$("#slider.animate").on("click","a",function(){ECWidget.movierotator.setActive($(this))});$("li#rotatorNowShowing").click(function(){ECWidget.movierotator.rotatorNowShowing()});$("li#rotatorComingSoon").click(function(){ECWidget.movierotator.rotatorComingSoon()});$("li#rotatorAdvancedTickets").click(function(){ECWidget.movierotator.rotatorAdvancedTickets()});$("li#rotatorFeaturedPromotions").click(function(){ECWidget.movierotator.rotatorFeaturedPromotions()});a.filterRotatorByCinema()},rotatorNowShowing:function(c){this.rotatorClearClassAndSaveNowShowing();var a=$("div.rotatorMovies"),b=a.data("RotatorNowShowing");if(c||b==null){$("div.rotatorMovies a").remove();addLoader("div.rotatorMovies","movies");var d={cinemaIds:EC.PreferredCinemas.select("Id")};$.ajax({url:"/MovieRotator/GetNowShowingMovies",data:d,dataType:"json",traditional:true,success:function(b){a.data("RotatorNowShowing",b);ECWidget.movierotator.rotatorRenderMovies(b);removeLoader("div.rotatorMovies");LazyLoadImages("#slider")}})}else{this.rotatorRenderMovies(b);LazyLoadImages("#slider")}$("li#rotatorNowShowing").addClass("active")},rotatorComingSoon:function(c){this.rotatorClearClassAndSaveNowShowing();var a=$("div.rotatorMovies"),b=a.data("RotatorComingSoon");if(c||b==null){$("div.rotatorMovies a").remove();addLoader("div.rotatorMovies","movies");$.ajax({url:"/MovieRotator/ComingSoonMovies",dataType:"json",success:function(b){a.data("RotatorComingSoon",b);ECWidget.movierotator.rotatorRenderMovies(b);removeLoader("div.rotatorMovies");LazyLoadImages("#slider")}})}else{this.rotatorRenderMovies(b);LazyLoadImages("#slider")}$("li#rotatorComingSoon").addClass("active")},rotatorAdvancedTickets:function(c){ECWidget.movierotator.rotatorClearClassAndSaveNowShowing();var a=$("div.rotatorMovies"),b=a.data("RotatorAdvancedTickets");if(c||b==null){$("div.rotatorMovies a").remove();addLoader("div.rotatorMovies","movies");var d={cinemaIds:EC.PreferredCinemas.select("Id")};$.ajax({url:"/MovieRotator/AdvancedTicketMovies",data:d,traditional:true,dataType:"json",success:function(b){a.data("RotatorAdvancedTickets",b);ECWidget.movierotator.rotatorRenderMovies(b);removeLoader("div.rotatorMovies");LazyLoadImages("#slider")}})}else{this.rotatorRenderMovies(b);LazyLoadImages("#slider")}$("li#rotatorAdvancedTickets").addClass("active")},filterRotatorByCinema:function(){var a=[];$("span.active div",ECWidget.sessionfilter.$whereBlowout).each(function(){a.push($(this).attr("id"))});if(a.length>0){$("#slider .items a").each(function(){var d=$(this).data("cinemas");if(d!=null&&d!=""){for(var e=$(this).data("cinemas").toString().split(/[\s,]+/),b=false,c=0;c<a.length;c++)b=b||$.inArray(a[c].toString(),e)>=0;if(b)$(this).show();else $(this).hide()}});this.resetSlider()}},rotatorFeaturedPromotions:function(c){ECWidget.movierotator.rotatorClearClassAndSaveNowShowing();var a=$("div.rotatorMovies"),b=a.data("RotatorFeaturedPromotions");if(c||b==null){$("div.rotatorMovies a").remove();addLoader("div.rotatorMovies","movies");var d={cinemaIds:EC.PreferredCinemas.select("Id")};$.ajax({url:"/MovieRotator/FeaturedPromotions",data:d,traditional:true,dataType:"json",success:function(b){a.data("RotatorFeaturedPromotions",b);ECWidget.movierotator.rotatorRenderMovies(b);removeLoader("div.rotatorMovies");LazyLoadImages("#slider")}})}else{this.rotatorRenderMovies(b);LazyLoadImages("#slider")}$("li#rotatorFeaturedPromotions").addClass("active")},movieRotatorTemplate:'<a>{{if FeaturedSlashText != "" && FeaturedSlashText != null }}<div class="banner"><p>${FeaturedSlashText}</p></div>{{/if}}<img class="lazy" data-isstatic="${IsStatic}" data-ismovie="${IsMovie}" data-hasdeluxe="${HasDeluxe}" data-hasvmax="${HasVmax}" data-hasimax="${HasImax}" data-hasimax3d="${HasImax3D}" data-hasgc="${HasGoldclass}" data-has3d="${Has3d}" data-original="${ECWidget.movierotator.getRotatorThumbnailUrl(IsMovie,Id)}" src="'+baseCdnUrl+'img/unavailable_poster156x80.jpg" hastrailer="${HasTrailer}" movieid="${Id}" movieUrl="${MovieUrl}" details-title="${DetailsButtonText}" btn-title="${ActionButtonTitle}" alt="${Name}" width="156" height="80" /><p>${Name}</p></a>',movieRotatorEmptyTemplate:'<div class="empty">There are no movies showing for your preferred cinemas</div>',getRotatorThumbnailUrl:function(b,a){return b?ECWidget.movierotator.getMovieBaseUrl(a)+"landscape_156x80.jpg":ECWidget.movierotator.getFeaturedItemBaseUrl(a)+"landscape_156x80.jpg"},getFeaturedItemBaseUrl:function(a){return baseCdnUrl+"../resources/featureditems/"+a+"/"},getMovieBaseUrl:function(a){return baseCdnUrl+"../resources/movies/"+a+"/images/"},rotatorRenderMovies:function(b){console.log("rotatorRenderMovies");var a=$("div.rotatorMovies");$("a",a).fadeOut(100).delay(200);$("a",a).remove();$(".empty",a).remove();if(b==null||b.length==0){a.append(ECWidget.movierotator.movieRotatorEmptyTemplate);return}$.tmpl(ECWidget.movierotator.movieRotatorTemplate,b).appendTo(a);$("a",a).fadeIn();!ECWidget.movierotator.isHomePageTakeOver&&$("a:first",a).addClass("active");ECWidget.movierotator.stopRotator();initAnimatedSlider();!ECWidget.movierotator.isHomePageTakeOver&&ECWidget.movierotator.startRotator();LazyLoadImages(a)},rotatorClearClassAndSaveNowShowing:function(){$("li#rotatorNowShowing").removeClass("active");$("li#rotatorComingSoon").removeClass("active");$("li#rotatorAdvancedTickets").removeClass("active");$("li#rotatorFeaturedPromotions").removeClass("active");var a=$("div.rotatorMovies");if(a.data("RotatorNowShowing")==null){a.data("RotatorNowShowing",a.html());$("a",a).remove()}},hasRotator:function(){return $(".home-items #slider, .movie-detail-items.slider #slider").length>0},stopRotator:function(){clearTimeout(ECWidget.movierotator.timer)},startRotator:function(){ECWidget.movierotator.stopRotator();ECWidget.movierotator.timer=setTimeout(function(){animatedSlider()},slide_interval)},setActive:function(a){$("#slider.animate").find("a.active").removeClass("active");a.addClass("active");!isTrue($("img",a).data("isstatic"))&&ECWidget.movierotator.startRotator();if($('body[controller="premiumcinema"]').length>0)changeSkin2(false);else changeSkin(false)},isHomePageTakeOver:false};ECWidget.pagebackgroundmultiple={init:function(){var a=$("#background-wrap");a.attr("id","background-wrap-multiple");a.fadeOut(200,function(){if($("#PageBackgroundMultiple").html().length>0){$(this).html($("#PageBackgroundMultiple").html());$("body").removeClass("lights")}else $("body").addClass("lights");$(this).attr("style","");$(this).fadeIn(600)});this.bindArrows(a)},bindArrows:function(c){var b=$(".premium-cinema-call-to-action"),a=c;$(".background-arrow-right",b).click(function(){if($(".active",a).nextAll().length==0)$(".active",a).fadeOut(function(){$(this).removeClass("active");$("div:first-child",a).addClass("active").fadeIn()});else $(".active",a).fadeOut(function(){$(this).removeClass("active").next().addClass("active");$(".active",a).fadeIn()})});$(".background-arrow-left",b).click(function(){console.log("clicked");if($(".active",a).prevAll().length==0)$(".active",a).fadeOut(function(){$(this).removeClass("active");$("div:last-child",a).addClass("active").fadeIn()});else $(".active",a).fadeOut(function(){$(this).removeClass("active").prev().addClass("active");$(".active",a).fadeIn()})})}};ECWidget.pagebackgroundsingle={init:function(){changeSkinBackgroundSet($("#PageBackgroundSingle").attr("backgroundUrl"))}};ECWidget.search={init:function(){$("#searchResults .image-wrapper img").click(function(){var a=$(this).parents(".movie-list-item").data("url");if(a!=null&&a.length>0)window.location=a});$("#searchResults .cinema-movie-times-info .title").click(function(){var a=$(this).parents(".movie-list-item").data("url");if(a!=null&&a.length>0)window.location=a});EC.QuickTimesSeats.init()}};ECWidget.sessionfilter={$ticketBar:null,$where:null,$what:null,$when:null,$whereBlowout:null,$whenBlowout:null,$whatBlowout:null,init:function(){var b=null,a=Array();console.log("ECWidget.sessionfilter.init");updateTicketBarCinemas();this.$ticketBar=$("#ticket-bar");this.$where=$("#where",ECWidget.sessionfilter.$ticketBar);this.$whereBlowout=$("#whereBlowout");this.$when=$("#when",ECWidget.sessionfilter.$ticketBar);this.$whenBlowout=$("#whenBlowout");this.$what=$("#what",ECWidget.sessionfilter.$ticketBar);this.$whatBlowout=$("#whatBlowout");if(selected_movies.length>1)this.$what.html("Your selected movies<em class='arrow-down'></em>");else if(selected_movies.length==1)this.$what.html(selected_movies[0].Name+"<em class='arrow-down'></em>");else this.$what.html("Any movie now showing<em class='arrow-down'></em>");$(".btn",ECWidget.sessionfilter.$ticketBar).click(function(){if(!EC.PreferredCinemas.any()){ECWidget.sessionfilter.$where.click();return false}$(this).attr("href",ECWidget.sessionfilter.buildQueryString());return true});$("#wrapper").click(function(){ECWidget.sessionfilter.hideAllTicketBarBlowouts()});$("#cover").click(function(){ECWidget.sessionfilter.hideAllTicketBarBlowouts()});this.$where.click(function(){if(ECWidget.sessionfilter.$whereBlowout.is(":visible"))ECWidget.sessionfilter.hideAllTicketBarBlowouts();else{$("#cover").show();ECWidget.sessionfilter.ticketBarZIndex(9980);$(this).addClass("active");ECWidget.sessionfilter.$whereBlowout.show();var a=$("ul.head li.active a",ECWidget.sessionfilter.$whereBlowout).html();EC.SessionFilter.CinemasGetByState(a);ECWidget.sessionfilter.$whereBlowout.removeClass("in-the-middle").show();ECWidget.sessionfilter.$what.removeClass("active");ECWidget.sessionfilter.$whatBlowout.hide().trigger("close");ECWidget.sessionfilter.$when.removeClass("active");ECWidget.sessionfilter.$whenBlowout.hide().trigger("close")}});$("ul.head li",this.$whereBlowout).click(function(){$("ul.head li",ECWidget.sessionfilter.$whereBlowout).removeClass("active");$(this).addClass("active");EC.SessionFilter.CinemasGetByState($("a",this).text())});this.$whereBlowout.on("click","span",function(d){d.stopPropagation();d.preventDefault();if($(this).hasClass("active")){EC.PreferredCinemas.remove($("div",this).attr("id"));$(this).removeClass("active")}else{EC.PreferredCinemas.add($("div",this).attr("id"),$("div",this).attr("value"));$(this).addClass("active")}clearTimeout(b);var c=1;if(ie)c=1e3;a.push($(this));b=setTimeout(function(){updateTicketBarCinemas();ECWidget.sessionfilter.$ticketBar.trigger("updated");ECWidget.sessionfilter.$whereBlowout.trigger("setcinema");while(a.length>0){thisObj=a.shift();thisObj.trigger("selectCinema")}},c)});$(".done",this.$whereBlowout).click(function(){ECWidget.sessionfilter.hideAllTicketBarBlowouts();$("#cinema-filters span").addClass("active");FilterMovies();$('body[data-controller="search"]').length>0&&ECPage.search.init()});this.$what.click(function(){console.log(selected_movies);if(ECWidget.sessionfilter.$whatBlowout.is(":visible"))ECWidget.sessionfilter.hideAllTicketBarBlowouts();else{$("#cover").show();ECWidget.sessionfilter.ticketBarZIndex(9980);if($("#advancedTickets",ECWidget.sessionfilter.$whatBlowout).parent().hasClass("active"))$(".movie-overview",ECWidget.sessionfilter.$whatBlowout).show();else EC.SessionFilter.MovieNowShowing();$(this).addClass("active");ECWidget.sessionfilter.$whatBlowout.show();ECWidget.sessionfilter.$where.removeClass("active");ECWidget.sessionfilter.$whereBlowout.hide().trigger("close");ECWidget.sessionfilter.$when.removeClass("active");ECWidget.sessionfilter.$whenBlowout.hide().trigger("close")}});$(".movie-overview",this.$whatBlowout).on("click","span",function(c){if(!$(c.target).is("a")){var b={title:$(".title",this).text(),id:$(".title",this).data("id")};if($(this).hasClass("active")){for(var a=0;a<selected_movies.length;a++)if(selected_movies[a].id==b.id){removeByElement(selected_movies[a]);selected_movies.splice(a,1);break}$(this).removeClass("active")}else{for(a=0;a<selected_movies.length;a++)if(selected_movies[a].id==b.id){removeByElement(selected_movies[a]);break}selected_movies.push(b);$(this).addClass("active")}if(selected_movies.length>1)ECWidget.sessionfilter.$what.html("Your selected movies <em class='arrow-down'></em>");else if(selected_movies.length==1)ECWidget.sessionfilter.$what.html(selected_movies[0].title+"<em class='arrow-down'></em>");else ECWidget.sessionfilter.$what.html("Any movie now showing<em class='arrow-down'></em>");ECWidget.sessionfilter.$whatBlowout.trigger("set-movie");ECWidget.sessionfilter.$ticketBar.trigger("updated")}});$(".done",this.$whatBlowout).click(function(){ECWidget.sessionfilter.hideAllTicketBarBlowouts()});this.$when.click(function(){if(ECWidget.sessionfilter.$whenBlowout.is(":visible"))ECWidget.sessionfilter.hideAllTicketBarBlowouts();else{$("#cover").show();ECWidget.sessionfilter.ticketBarZIndex(9980);EC.SessionFilter.DatesGet();$(this).addClass("active");ECWidget.sessionfilter.$whenBlowout.show();ECWidget.sessionfilter.$where.removeClass("active");ECWidget.sessionfilter.$whereBlowout.hide().trigger("close");ECWidget.sessionfilter.$what.removeClass("active");ECWidget.sessionfilter.$whatBlowout.hide().trigger("close")}});this.getUserDetails();$(".when-blowout ul").on("click","li",function(){selected_dates=[];$(".when-blowout li").each(function(){$(this).removeClass("active")});$("#top-ticketing-time").val($(this).text());selected_dates.push($(this).data("value"));$(this).addClass("active");$("#when").html($(this).text()+"<em class='arrow-down'></em>");ECWidget.sessionfilter.hideAllTicketBarBlowouts();$("#ticket-bar").trigger("updated")});$("a#advancedTickets").click(function(){$(".what-blowout ul.head li").removeClass("active");$(this).parent().addClass("active");GetAdvancedMovies()});$("a#nowShowing").click(function(){$(".what-blowout ul.head li").removeClass("active");$(this).parent().addClass("active");EC.SessionFilter.MovieNowShowing()});$(".what-blowout img").error(function(){$(this).attr("src",$("#cdnUrl").attr("path")+"img/unavailable_poster105x50.jpg")});$("#ticket-bar").bind("updated",function(){$(".btn",this).attr("href",ECWidget.sessionfilter.buildQueryString())});$(".what-blowout ul.filters li").each(function(){$(this).addClass($.cookie($(this).attr("id")))});$(".what-blowout .filters span.eccheckbox").bind("filter-clicked",function(){EC.SessionFilter.FilterMovies()});$(".what-blowout").on("filter-clicked","li",function(){$.cookie($(this).attr("id"),$(this).attr("class"),{path:"/",expires:7300})});$(window).resize(function(){EC.Scroller.init()});$(".cinema-row").resize(function(){EC.Scroller.init()})},hideAllTicketBarBlowouts:function(){this.$where.removeClass("active");this.$whereBlowout.hide().trigger("close");this.$what.removeClass("active");this.$whatBlowout.hide().trigger("close");this.$when.removeClass("active");this.$whenBlowout.removeClass("in-the-middle").hide().trigger("close");$(".btn",this.$whereBlowout).removeClass("wider").text("done");this.ticketBarZIndex(4e3);$(".overlay").hide();$("#cover").hide()},readMoviesFromUrl:function(){var a=[getParameterByName("movies"),a=$.deparam.fragment().movies].filter(function(a){return a}).join();return a!=null&&a.length>0?a.match(/[^,]+/g):[]},buildQueryString:function(){var c=EC.Urls.SessionFinder,a=[];selected_dates.length>0&&a.push("date="+selected_dates[0]);var b=[];$.each(selected_movies,function(c,a){typeof a.id!="undefined"&&b.push(a.id)});b.length>0&&a.push("movies="+b.join());if(a.length>0)c+="#"+a.join("&");return c},ticketBarZIndex:function(a){this.$ticketBar.css("z-index",a)},getUserDetails:function(){if($.cookie("Cinebuzz")==null){var c=$.cookie("_ecnouser"),a=0;if(c){var b=toJSON(c);if(!isNaN(b.counter)){a=parseInt(b.counter);if(a<10){a++;b.counter=a;$.cookie("_ecnouser",JSON.stringify(b),{path:"/",expires:new Date(b.date)})}else a=0}}a==0&&$.ajax({url:"/sessionfilter/GetUserDetails",success:function(b){if(b!=null){ECWidget.sessionfilter.renderCinebuzzPoints(b);$.removeCookie("_ecnouser",{path:"/"})}else{var a=new Date;a.setTime(a.getTime()+5*60*1e3);$.cookie("_ecnouser",JSON.stringify({counter:0,date:a}),{path:"/",expires:a})}},cache:false})}else{var d=toJSON($.cookie("Cinebuzz"));ECWidget.sessionfilter.renderCinebuzzPoints(d)}},renderCinebuzzPoints:function(f){$("#cine-buzz").remove();$("#loggedInTemplate").tmpl(f).appendTo($("header"));var b=$("#cine-buzz");if($(".progress",b).length>0){var a=$(".progress-bar",b),c=parseInt(a.data("maxpoints")),d=parseInt($.trim($(".points strong",b).text())),e=a.width();if(d>c)$(".progress",a).width(e);else $(".progress",a).width(e*(d/c))}}};function GetAdvancedMovies(){var a=$(".what-blowout ul.movie-overview"),d=a.data("AdvancedTickets");$(".movie-overview",".what-blowout").hide();$(".movie-overview li",".what-blowout").remove();$(".bottom",".what-blowout").before("<div class='loading'><img src='"+$("#cdnUrl").attr("path")+"img/loader-red.gif'/> Loading advanced movies...</div>");var b=EC.PreferredCinemas.orderedIds(),c={cinemaIds:b};$.ajax({url:"/SessionFilter/AdvancedTicketMovies",traditional:true,success:function(a){RenderAdvancedMovies(a)},data:c})}var movieAdvancedTemplate="<li class='${Css}' style='display: none;' data-id='${Id}'><span><div class='image-wrapper'><img class='lazy' data-original='"+$("#cdnUrl").attr("path")+"../resources/movies/${Id}/images/movie.jpg' src='"+$("#cdnUrl").attr("path")+"img/unavailable_poster105x50.jpg' alt='${Name}' width='105' height='154' /><div class='hover'><p class='title' data-id='${Id}'>${Name}</p><a href='${Url}'>&#8250; more details</a>{{if HasTrailer}}<a href='#' onclick='LoadTrailer(${Id})'>&#8250; view trailer</a>{{/if}}</div></div><div class='select'><div class='checkbox'></div><label>Select movie</label></div></span></li>";function RenderAdvancedMovies(b){var a=$(".what-blowout ul.movie-overview");a.data("AdvancedTickets",b);$("li",a).fadeOut(100).delay(200);if(a.data("NowShowing")==null){$("li",a).hide();a.data("NowShowing",a.html())}$(".movie-overview",".what-blowout").show();$(".loading",".what-blowout").remove();$(".empty",".what-blowout").remove();$("li",a).remove();var b=a.data("AdvancedTickets");$.tmpl(movieAdvancedTemplate,b).appendTo(a);$("li",a).fadeIn();LazyLoadImages($(".what-blowout"));CheckSelectedMovies()}ECWidget.sessionfinderfilter={init:function(){this.initSessionAttributeFilters();var b=this,a=$("#session-finder-filter");$("#time-filters span",a).click(function(){$(this).siblings().removeClass("active")});$(a).bind("filter-clicked",function(){b.filterSessions()});$("input#movieKeywordTextbox",a).keyup(function(){delay(function(){b.filterMovies()},500)})},filterMovies:function(){ECWidget.sessionfinderfilter.filterSessions();LazyLoadImages()},filterSessions:function(){$(".movie-list-item").show();var e=$("#session-finder-filter"),c=$("#time-filters span.active",e),d=$("#experience-filters span.active div",e),b=$("#attribute-filters span.active",e),f=$.trim($("#movieKeywordTextbox").val()).toLowerCase();$("p.nosessions").remove();if(c.length==0&&d.length==0&&b.length==0){$(".cinema-row-wrapper .btn").show();$(".cinema-row-wrapper").each(function(c,b){var a=$(b);if($(".btn:visible",a).length>0)$(".nosessions",a).remove();else a.append('<p class="nosessions">No sessions available</p>')})}else $(".cinema-row-wrapper").each(function(f,e){var a=$(e);$(".btn",a).each(function(l,a){var i=false,e=false,h=false,f=false,j=false,g=false;c.each(function(f,d){i=true;if($(d).hasClass("before5")){var b=Date.parse($(a).data("starttime")),c=b.getHours()*100+b.getMinutes();e=c<=1700}else if($(d).hasClass("after5")){var b=Date.parse($(a).data("starttime")),c=b.getHours()*100+b.getMinutes();e=c>=1700}return!e});d.each(function(d,c){j=true;var b=$(c).data("class");if($("span",a).hasClass(b+"-icon"))g=true;return!g});b.each(function(g,e){h=true;var d=$(e).data("id"),b=$(a).data("attributes");if(b!=null&&b.length>0)for(var c=0;c<b.length;c++)if(b[c].Id==d){f=true;break}return!f});var k=(!i||e)&&(!j||g)&&(!h||f);if(k)$(a).show();else $(a).hide()});if($(".btn:visible",a).length>0)$(".nosessions",a).remove();else a.append('<p class="nosessions">No sessions available</p>')});$("#movie-overview-list").trigger("additionalfilters");$.each($(".movie-list-item"),function(b,a){if($("a.btn:visible",a).length==0||f&&$(".cinema-movie-times-info .title",$(this)).text().toLowerCase().indexOf(f)===-1)$(a).hide();else $(a).show()});ECPage.movie.update.movies.length>0&&$(".movie-list-item:visible").each(function(){var a=$(this).data("id");$.inArray(a,ECPage.movie.update.movies)==-1&&$(this).hide()});var a=$(".movie-list-item:visible").length;if(a>1)$("p.results").text(a.toString()+" movies currently showing");else if(a==1)$("p.results").text("1 movie currently showing");else{var g=c.length>0||d.length>0||b.length>0||ECPage.movie.update.movies.length>0;if(g)$("p.results").text("Filter returned no results, please try an alternate date or cinema");else $("p.results").text("No session available for that date yet")}EC.Scroller.init();$("#timeline").is(":visible")&&ECPage.movie.currentTimeLineFilter!==undefined&&ECPage.movie.currentTimeLineFilter()},checkSessionsExist:function(a,b){a.siblings().removeClass("active");var c=a.hasClass("active");$(".cinema-row-wrapper").each(function(e,d){var a=$(d);if(c)$(".btn",a).show();else $(".btn",a).each(function(e,a){var c=new Date($(a).data("starttime")),d=c.getHours()*100+c.getMinutes();if(b(d))$(a).hide();else $(a).show()});if($(".btn:visible",a).length>0)$(".nosessions",a).remove();else a.append('<p class="nosessions">No sessions available</p>')})},initSessionAttributeFilters:function(){$('#experience-filters span .checkbox[data-type="attribute"]').each(function(c,a){var b=$(a).data("class");$(".cinema-row-wrapper ."+b+"-btn").length==0&&$(a).parent().hide()})}};ECWidget.sessiontimes={init:function(){EC.QuickTimesSeats.init()}};ECPage.cinebuzz={dashboard:function(){ECPage.cinebuzz.updateProgress();this.loadPastBookings();this.loadFutureBookings();this.resizecinebuzzSlider();ECPage.cinebuzz.member();ECPage.cinema.initLoadPreferredCinemas();$("#background-wrap").remove();$("body").removeClass("lights");if($("#cinebuzz-member").size()>0){var b=$("#cinebuzz-member");$(".confirmemail-fieldset",b).hide();var c=$("#User_Email",b).val();$("#User_Email",b).attr("orValue",c);$("#User_ConfirmEmail").val(c);$(document).on({blur:function(){var a=$("#User_ConfirmEmail",$("#cinebuzz-modal")).val();if($(this).val()!=a){$("#User_ConfirmEmail",$("#cinebuzz-modal")).val("");$(".confirmemail-fieldset",$("#cinebuzz-modal")).show()}},focus:function(){var a=$("#User_ConfirmEmail",$("#cinebuzz-modal")).val();if($(this).val()!=a){$("#User_ConfirmEmail",$("#cinebuzz-modal")).val("");$(".confirmemail-fieldset",$("#cinebuzz-modal")).show()}}},"#User_Email")}ECPage.cinebuzz.sameSizeRow();$("body").on("click",".card-add",function(){$(this).hide();$(".payment-option").show()});$("body").on("click",".future-booking-details",function(){var a=$(this).data("url");window.open(a,"_blank");return false});if($(".myoffers-box").size()>0){var a=$(".myoffers-box"),e=$(".my-offers-template-wrapper",a);$(".slide-wrapper",a).prepend("<div class='slider-wrap'></div>");ECPage.cinebuzz.cinebuzzSlider(a,e)}function d(d,b,c,a){$("body").append('<div id="cinebuzz-modal" class="in-the-middle '+d+'"></div>');$("#cinebuzz-modal").children().remove();$("#cinebuzz-modal").append(b).prepend('<a class="close"></a><div class="modal-header">'+c+"</div>");$("#cinebuzz-modal").css("margin-left","-"+a/2+"px");$("#cinebuzz-modal").attr("style",function(c,b){return b+"width: "+a+"px !important;"});$("#cinebuzz-modal .close").click(function(){$("#cover").trigger("click")});$("#cinebuzz-modal").show();$("#cover").attr("popup","cinebuzz-modal")}$("body").on("click",".viewmore",function(){EC.ShowModalRegion("#past-bookings-full",{additionalClass:"cinebuzz-bookings"})});$("body").on("click",".cinebuzz-Edit-bt",function(){var c=$(this).data("edit"),a=$(this).attr("title");$("#cover").show();var b=$("#"+c).children().clone();d(a,b,"My "+a,700);$("body").attr("cinebuzz-reload","true")});$("#cover").click(function(){var a=$(this).attr("popup");$("#"+a).remove()});$("#barcode-print").click(function(){$(".barcode-box .print-wrapper").print();return false});$("body").on("submit",".payment-option",function(){var a=$(this),c=a.find(".btn");if(c.isLoading())return false;var e=$("#CardTypeId",a),d=$("#CardNumber",a),g=$("#CardExpiryYear",a),f=$("#CardExpiryMonth",a);$("select, input",a).removeError();var b=e.valueRequired()&&d.valueRequired()&&g.valueRequired()&&f.valueRequired();if(b)b=ECValidate.validateCreditCard(e.val(),d.val(),function(a){EC.Alert(a)});if(b)b=ECValidate.validateCreditCardDate(g.val(),f.val(),function(a){EC.Alert(a)});if(b){c.loading(true);EC.post({url:"/Cinebuzz/AddCreditCard",data:a.serialize(),success:function(a){a.index=$("#manage-stored-cards .card-remove").length+1;$.tmpl($("#success-card-add-template"),a).appendTo($(".stored-cards-table"));EC.Success("Card added succesfully");c.stopLoading()},error:function(a){EC.Alert(a);c.stopLoading()},errorMessage:"Error adding Credit Card"})}return false});$("body").on("click","#cinebuzz-modal .card-remove",function(){var a=$(this);EC.post({url:"/Ticketing/RemoveCard",data:{id:a.data("id")},success:function(){var b=a.closest("tr");b.fadeOut(function(){b.remove()})},error:function(a){EC.Alert(a)},errorMessage:"Error removing card"});return false})},dashboard2:function(){$(".form-block .listing").on("click","span",function(){if($(this).hasClass("active"))$(this).removeClass("active");else $(this).addClass("active")});$(".form-block.last").on("click","span",function(){if($(this).hasClass("active"))$(this).removeClass("active");else $(this).addClass("active")});$(".membership").on("click",".checkbox",function(){if($(this).hasClass("checked"))$(this).removeClass("checked");else $(this).addClass("checked")});$(".membership").on("click","img",function(){if($(this).siblings(".checkbox").hasClass("checked"))$(this).siblings(".checkbox").removeClass("checked");else $(this).siblings(".checkbox").addClass("checked")});$(".recommended-movies-wrapper").cycle({fx:"scrollHorz",speed:500,timeout:0,next:".move-right",prev:".move-left"});$(".offerslider .slide-wrapper").cycle({fx:"scrollHorz",speed:900,timeout:3500,next:".move-offer-right",prev:".move-offer-left"});$("#points").on("click",function(){$("#points-area").show();$("#vip-points-area").hide();$(this).siblings().removeClass("active");$(this).addClass("active")});$("#vip-status").on("click",function(){$("#points-area").hide();$("#vip-points-area").show();$(this).siblings().removeClass("active");$(this).addClass("active")});ECPage.cinebuzz.updateProgress2();$(".help").length>0&&$(".help").tooltip({track:true,delay:0,showURL:false,showBody:" - ",fade:100});$("#Update_Member").click(function(){$("#User_Phone").val(formatPhoneNumber($("#User_Phone").val()))});$(".member-dashboard .trivia .content").length>0&&triviaLoad();$(".member-dashboard .trivia").on("click","input[type='radio']",function(){triviaLoad()});this.loadPastBookings2();this.loadFutureBookings2();ECPage.cinema.initLoadPreferredCinemas()},index:function(){ECPage.cinebuzz.join();$("#background-wrap").remove();$("body").removeClass("lights");ECPage.cinebuzz.sameSizeRow();$(window).bind("hashchange",function(){var a=$.bbq.getState();if(a.join!==undefined)ECPage.cinebuzz.ShowModalCinebuzz("#join-section");else a.login!==undefined&&ECPage.cinebuzz.ShowModalCinebuzz("#login-section")});$(window).trigger("hashchange");$("#join-section").find("label").each(function(){$joinsection=$("#join-section");$label=$(this);var c=$label.html();$label.html(c.replace("*",""));var b=$label.attr("for");if($("#"+b,$joinsection).size()>0){var a=$("#"+b,$joinsection);if(a.attr("type")=="text"||a.attr("type")=="password"||a.attr("type")=="tel")a.attr("placeholder",c);else a.attr("type")=="radio"&&$label.css("display","block")}});$("#User_PostCode").parent().after('<fieldset><a class="black btn" id="cine-join-next">Next</a></fieldset>');$("body").on("click","#login-page-btn-Login",function(){ECPage.cinebuzz.ShowModalCinebuzz("#login-section");return false});$("body").on("click","#login-page-btn-Join",function(){ECPage.cinebuzz.ShowModalCinebuzz("#join-section");$(".steps",$joinsection).find("h2").attr("step")=="2"&&$(".step1").click();return false});$("body").on("click",".step1",function(){$joinsection=$("#join-section");$(".stepactive").removeClass("stepactive");$(this).addClass("stepactive");if($(".steps",$joinsection).find("h2").attr("step")=="2"){var a=$joinsection.height();$joinsection.height(a-100);a=$(".modal-wrapper").height();$(".modal-wrapper").height(a-100);$(".form-block",$joinsection).hide();$(".form-block",$joinsection).first().show();$(".steps",$joinsection).find("h2").attr("step","1");$(".steps",$joinsection).find("h2").html("STEP 1 OF 2:");$(".steps",$joinsection).find("h3").html("PERSONAL DETAILS")}});$("body").on("click",".step2",function(){$joinsection=$("#join-section");$(".stepactive").removeClass("stepactive");$(this).addClass("stepactive");if($(".steps",$joinsection).find("h2").attr("step")=="1"||$(".steps",$joinsection).find("h2").attr("step")==null){var a=$joinsection.height();$joinsection.height(a+100);a=$(".modal-wrapper").height();$(".modal-wrapper").height(a+100);$(".form-block",$joinsection).show();$(".form-block",$joinsection).first().hide();$(".steps",$joinsection).find("h2").attr("step","2");$(".steps",$joinsection).find("h2").html("STEP 2 OF 2:");$(".steps",$joinsection).find("h3").html("PREFERENCES");$("#geolocate",$joinsection).removeClass("yellow").addClass("black")}});$("body").on("click","#cine-join-next",function(){$(".step2").click()});$("body").on("click","#forgot-link",function(){EC.ShowModalRegion("#forgotten-password");return false});$("#forgotten-password #Email").onEnterClick("#forgotten-submit");$("#forgotten-submit").click(this.submitResetPassword);$("#login-section").submit(function(){var a=$(this).find(".btn");if(a.isLoading())return false;var b=$(this);if(b.valid()){a.loading(true);EC.post({url:"/Cinebuzz/Login",data:{Username:$("#Username",b).val(),Password:$("#Password",b).val()},success:function(){a.stopLoading();$("#modal-popup.cinebuzz-modal").remove();window.location="/Cinebuzz"},error:function(b){a.stopLoading();EC.Alert(b)},errorMessage:"Error logging in"})}return false});$("body").on("click",".cinebuzz-popup input.btn",function(){$("#login-page-btn-Join").trigger("click");return false})},login2:function(){$(document).bind("gigyaloaded",function(){ECPage.cinebuzz.showSocialLogin()});$("#forgot-link").click(function(){EC.ShowModalRegion("#forgotten-password");return false});$("#forgotten-password #Email").onEnterClick("#forgotten-submit");$("#forgotten-submit").click(this.submitResetPassword);this.loadGigya();var a=$(".cinebuzz-login"),c=$("#Username",a),b=$("#Password",a);c.keypress(function(b){if(b.which==13){$("#login",a).click();return false}});b.keypress(function(b){if(b.which==13){$("#login",a).click();return false}});$("#login",a).click(ECPage.cinebuzz.performLogin)},ShowModalCinebuzz:function(a){EC.ShowModalRegion(a,{additionalClass:"cinebuzz-modal"});iePlaceholder()},updateBirthDate:function(){$("#User_BirthDay","#cinebuzz-modal").val(Date.parse($("#year","#cinebuzz-modal").val()+"-"+$("#month","#cinebuzz-modal").val()+"-"+$("#day","#cinebuzz-modal").val()).toString("yyyy-MM-dd"))},logingigya:function(){var a=$(".cinebuzz-login"),c=$("#Username",a),b=$("#Password",a);c.keypress(function(b){if(b.which==13){$("#login",a).click();return false}});b.keypress(function(b){if(b.which==13){$("#login",a).click();return false}});$("#login",a).click(ECPage.cinebuzz.performLogin)},unsubscribe:function(){$("#unsubscribe-btn").on("click",function(){var a=$(this);if(a.isLoading())return false;a.loading();$("#unsubscribeResult").hide().text("");$.post("/Cinebuzz/Unsubscribe",$("#unsubscribe-widget input").serialize(),function(b){if(b!=null)if(b.Success)EC.Message("Success!",b.Data);else $("#unsubscribeResult").show().text(b.Message);else $("#unsubscribeResult").show().text("Error unsubscribing user");a.stopLoading()});return false})},member:function(){$("#User_Username").bind("keypress",function(a){if(a.which===32)return false});$("body").on("click","#resetPassword",function(){if($("#cinebuzz-modal").size()>0){$("#cinebuzz-modal").remove();$("#cover").hide()}EC.ShowModalRegion($("#change-password-modal"))});$(".news .eccheckbox").bind("filter-clicked",ECPage.cinebuzz.setPreferences);$("body").on("submit","#member-form",function(){var b=$(".news .active",$(this)).map(function(){return $(".checkbox",this).data("value")}).get();console.log(b);$("#User_Preferences",$(this)).val(b.join());console.log($("#User_Preferences",$(this)).val());var a=$("#Update_Member");if($(this).valid()){if(a.isLoading())return false;a.loading(true);EC.post({url:"/Cinebuzz/UpdateMember",data:$(this).serialize(),success:function(){a.stopLoading();EC.Message("Success!!","Your details have been successfully updated");var b=$("body").attr("cinebuzz-reload");b=="true"&&$(".ecalert-ok").click(function(){location.reload()})},error:function(b){a.stopLoading();EC.Alert(b)},errorMessage:"Error updating Member."})}return false});$("#change-password-modal form").submit(function(){var a=$(this),c=true;$('input[type="password"]',a).each(function(b,a){if(!$(a).hasValue()){c=false;$(a).showValidationMessage($(a).getName()+" required")}});if(c){var b=$(".btn",a);if(b.isLoading())return false;b.loading(true);EC.post({url:"/Cinebuzz/ChangePassword",data:a.serialize(),success:function(){b.stopLoading();$('input[type="password"]',a).val("");EC.Success("Successfully updated password")},error:function(a){b.stopLoading();EC.Alert(a)},errorMessage:"Error changing password"})}return false})},reset:function(){$("#ConfirmPassword").onEnterClick("#reset-submit");$("#Password").onEnterClick("#reset-submit");$("#reset-submit").click(function(){var c=$("#NewPassword").val(),b=$("#ConfirmPassword").val();if(c!==b){EC.Alert("Passwords must match. Please try again.");return false}var a=$(this);if(a.isLoading())return false;if(a.closest("form").valid()){a.loading(true);var d={NewPassword:c,ConfirmPassword:b,Token:$("#Token").val()};EC.Toast("valid");EC.post({url:"/cinebuzz/reset",data:d,success:function(){window.location="/cinebuzz"},error:function(b){a.stopLoading();EC.Alert(b)}})}return false})},join:function(){var a=this;$("#StudentPaymentCardNumber").numericInt();$("#StudentPaymentCardCsc").numericInt();if($("#payment-retry").length>0){$("#payment-retry").click(function(){if(!a.validateStudentPayment())return false});return}$("#User_Username").bind("keypress",function(a){if(a.which===32)return false}).bind("blur",function(){this.value=this.value.replace(/ /g,"")});$("#User_Phone").numericInt();$("#User_PostCode").numericInt();$(".last input:submit").click(function(){a.setPreferences()});if(ie){console.log("hiding find cinemas");$("#findCinemasNearMeContainer").hide()}$(".form-block .listing, .form-block.last, #approve-guardian").on("click","span:not(.eccheckbox)",function(){if($(this).hasClass("active"))$(this).removeClass("active");else $(this).addClass("active");a.setPreferences()});$(".news .eccheckbox").bind("filter-clicked",a.setPreferences);$("#join").submit(function(){var b=$(this),e=b.find("#cinebuzz-signup");if(e.isLoading())return false;e.loading(true);$(".field-validation-error").removeClass("field-validation-error").addClass("field-validation-valid");var c=b.valid(),f=b.validate();b.find('input[data-val="true"]').each(function(){try{c=c&&f.element(this)}catch(a){}});$("#User_BirthDay",b).val($("#year",b).val()+"-"+$("#month",b).val()+"-"+$("#day",b).val());if($('input[name="PreferredCinemas"]',b).length===0){c=false;$("#pref-cinema-error").showValidationMessage("Please select your preferred cinema(s)")}var d=$("#approve-guardian_checkbox",b);if(d.length>0&&d.is(":visible"))if(!d.isActive()){c=false;d.find("input").showValidationMessage("Please select guardian approval.")}$("#User_Phone",b).val(formatPhoneNumber($("#User_Phone",b).val()));c=ECPage.cinebuzz.validateDate()&&c;c=(!$("#IsStudent",b).isChecked()||a.validateStudentPayment())&&c;if(!c){e.stopLoading();$(".form-block.step-1 .field-validation-error").length>0&&$(".step1").trigger("click");return false}EC.post({url:"/Cinebuzz/Join",data:b.serialize(),success:function(a){if(a.PaymentSuccess)window.location="/Cinebuzz/Dashboard?source=join";else{$("#CinebuzzId").val(a.CinebuzzId);$("#CinebuzzCardNumber").val(a.CardNumber);EC.Alert("Your account was created, but payment was unsuccessful. \r\nPlease try again to take advantage of student offers.");$(".form-block:not(.last)").hide();$(".form-block.last .column > fieldset").hide();$(".form-block.last > span").hide();$("#retry-btn").show();$(".form-block.last:last").hide()}},error:function(a){e.stopLoading();EC.Alert(a)},errorMessage:"Error creating user"});return false});$("#retry-btn").click(function(){var b=$(this);if(b.isLoading())return false;b.loading(true);a.validateStudentPayment()&&EC.post({url:"/Cinebuzz/RetryPayment",data:$("#join").serialize(),success:function(){window.location="/Cinebuzz"},error:function(a){b.stopLoading();EC.Alert(a)},errorMessage:"Payment unsuccesful"});return false});if($("#state").length>0){var e=$(".cinema-pref-list li.active a").text();$("div#"+e).show()}$(".form-block #User_Username").change(function(){var a=$.trim($(this).val());a.length>0&&delay(function(){$("#username-status").html("<img src='"+baseCdnUrl+"/img/loader-red.gif' alt='Checking username...' /> Checking username");delay(function(){EC.get({url:"/Cinebuzz/CheckUsername",data:{username:a},success:function(){$("#username-status").html("<img src='"+baseCdnUrl+"/img/tick.png' alt='Username available' /> Username is available")},error:function(){$("#username-status").html("<img src='"+baseCdnUrl+"/img/cross.png' alt='Username already taken' /> Username already taken")}})},300)},600)});$(".form-block #CinebuzzCardNumber").change(function(){var a=$.trim($(this).val());a.length==12&&delay(function(){$("#cinebuzzcardnumber-status").html("<img src='"+baseCdnUrl+"/img/loader-red.gif' alt='Checking card...' /> Checking card number");delay(function(){EC.get({url:"/Cinebuzz/CheckCinebuzzCardNumber",data:{cardNumber:a},success:function(){$("#cinebuzzcardnumber-status").html("<img src='"+baseCdnUrl+"/img/tick.png' alt='card available' /> Card is available")},error:function(){$("#cinebuzzcardnumber-status").html("<img src='"+baseCdnUrl+"/img/cross.png' alt='card already taken' /> The card number has already been used")}})},300)},600)});$("#geolocate").click(function(){var a=$(this);if(a.isLoading())return false;a.loading();$("#geolocateMessage").show();if(typeof geo_position_js!="undefined"&&geo_position_js.init())geo_position_js.getCurrentPosition(function(d){var b=d.coords.longitude,c=d.coords.latitude;$("input#lat").val(c);$("input#lng").val(b);EC.get({url:"/Cinema/CinemasNearMe",data:{latitude:c,longitude:b,numToReturn:5},success:function(b){a.stopLoading();ECWidget.findcinemas.loadCinemas(b)}})},function(){$("#geolocateMessage").hide();a.stopLoading();EC.Alert("No current location data available. Please search cinemas by state below.")},{timeout:5e3});else{a.stopLoading();$("#geolocateMessage").hide()}return false});$(".cinema-pref-list ul.head").on("click","li",function(){$(".cinema-pref-list li").removeClass("active");$(this).addClass("active");$("div.listing").hide();var a=$("a",this).text();$("div[id='"+a+"']").fadeIn(200)});var c=$("input#lat").val(),d=$("input#lng").val();c!=0&&d!=0&&ECWidget.findcinemas.loadCinemasNearMe(c,d);$("#IsStudent_checkbox").bind("checked",function(){$(".nz-student-payment").show()}).bind("unchecked",function(){$(".nz-student-payment").hide()});$(".listing .eccheckbox").live("checked",function(){var a=$(".checkbox",this).data("id");if($("#pref_"+a).length==0){var b=$("<input/>").attr("id","pref_"+a).attr("name","PreferredCinemas").attr("type","hidden").val(a);$(this).after(b)}}).live("unchecked",function(){var b=$(".checkbox",this).data("id"),a=$("#pref_"+b);a.length>0&&a.remove()});var b=$("input[name='PreferredCinemas']").map(function(){return $(this).val()});if(b.length==0)b=EC.PreferredCinemas.all();$.each(b,function(c,b){var a=$(".cinemasByState .preferred-cinema[data-id='"+b+"']");a.parent().active();$("#state a:contains("+a.closest(".cinemasByState").attr("id")+")").trigger("click")});$(".listing .eccheckbox.active").trigger("checked")},goldcoastseniors:function(){ECPage.cinebuzz.join()},expressjoin:function(){$(".express form").submit(function(){var b=$(this),a=$(".btn",b);if(a.isLoading())return false;if(b.valid()){a.loading(true);EC.post({url:"/Cinebuzz/ExpressJoin",data:b.serialize(),success:function(){EC.Success("Thanks for your information, check your inbox to complete your enrolment");a.stopLoading();$(".express form")[0].reset()},error:function(b){EC.Alert(b);a.stopLoading()},errorMessage:"Error signing user up, please try again"})}return false})},performLogin:function(){var a=$(".cinebuzz-login"),d=$("#login",a);if(d.isLoading())return false;var c=$("#Username",a),b=$("#Password",a);d.loading();c.removeClass("input-validation-error");b.removeClass("input-validation-error");$("#login-message",a).hide();var e={username:c.val(),password:b.val(),memberExternalID:$("#GigyaUID",a).val()};EC.post({url:"/Cinebuzz/Login",data:e,success:function(){c.removeClass("input-validation-error");b.removeClass("input-validation-error");$("#login-message",a).hide();window.location="/Cinebuzz"},error:function(e){d.stopLoading();c.addClass("input-validation-error");b.addClass("input-validation-error");$("#login-message",a).html(e).show()},errorMessage:"Invalid username or password"});return false},renderMovieLink:function(b,a){return b.length>0?"<a href='"+b+"'>"+a+"</a>":a},renderCinameLink:function(b,a){return b.length>0?"<a href='/cinema/"+b+"'>"+a+"</a>":a},loadPastBookings:function(){$("#past-bookings tbody").append("<tr><td><img src='"+baseCdnUrl+"img/loader-red.gif' /> Loading...</td></tr>");EC.get({url:"/Cinebuzz/GetPastBookings",success:function(a){var b=a.bookings;$("#past-bookings tbody tr").remove();if(b.length==0)$("#past-bookings tbody").append("<tr><td colspan='4'>There are no past bookings.</td></tr>");else{$.tmpl($("#past-booking-template"),b).appendTo($("#past-bookings tbody"));$.tmpl($("#past-booking-template-full"),b).appendTo($("#past-bookings-full tbody"));$("#past-bookings tr").slice(0,6).show()}if(a.statusPoints){$(".status-credits .points").html(a.statusPoints);$(".status-credits").show();ECPage.cinebuzz.updateProgress()}},error:function(a){$("#past-bookings tbody tr").remove();$("#past-bookings tbody").append("<tr><td colspan='4'>"+a+"</td></tr>")},errorMessage:"Error loading past bookings"})},loadPastBookings2:function(){$("#past-bookings tbody").append("<tr><td><img src='"+baseCdnUrl+"img/loader-red.gif' /> Loading...</td></tr>");EC.get({url:"/Cinebuzz/GetPastBookings",success:function(a){var b=a.bookings;$("#past-bookings tbody tr").remove();if(b.length==0)$("#past-bookings tbody").append("<tr><td colspan='4'>There are no past bookings.</td></tr>");else $.tmpl($("#past-booking-template"),b).appendTo($("#past-bookings tbody"));if(a.statusPoints){$("span.status-points").html(a.statusPoints);ECPage.cinebuzz.updateProgress()}},error:function(a){$("#past-bookings tbody tr").remove();$("#past-bookings tbody").append("<tr><td colspan='4'>"+a+"</td></tr>")},errorMessage:"Error loading past bookings"})},cinebuzzSlider:function(a,g){var b=parseInt($(".slider-wrap",a).first().width()/127);if(b>6)b=6;if(b<4)b=4;var d=$(g,a);$(".slider-wrap",a).remove();if(d.length>0)for(var c=0;c<d.length;c+=b)d.slice(c,c+b).appendTo($(".slide-wrapper",a).first()).wrapAll("<div class='slider-wrap'></div>");var h=$(".slider-wrap",a).size(),e=$(".slide-wrapper",a).first().width();if(e==0){$(".slide-wrapper",a).first().css("width","100%");e=$(".slide-wrapper",a).first().width()}$(".slide-wrapper",a).first().width(e*h);$(".arrow-left",a).hide();var f=$(".slide-wrapper",a).first().find(".slider-wrap").size();f==1&&$(".arrow-right",a).hide();$(".arrow-right",a).click(function(){var b=$(this);if(b.attr("cl")=="false"||b.attr("cl")==null){b.attr("cl","true");var c=b.parent(),d=c.find(".slider-wrap").first().width();c.find(".slider-wrap:visible:first").animate({"margin-left":"-="+(d+10)},500,function(){$(this).hide();$(".arrow-left",a).show();var d=c.find(".slider-wrap:visible").size();d==1&&$(".arrow-right",a).hide();b.attr("cl","false")})}});$(".arrow-left",a).click(function(){var b=$(this);if(b.attr("cl")=="false"||b.attr("cl")==null){b.attr("cl","true");$(".arrow-right",a).show();var c=b.parent(),d=c.find(".slider-wrap").first().width();c.find(".slider-wrap:hidden:last").show().animate({"margin-left":"+="+(d+10)},500,function(){var d=c.find(".slider-wrap:hidden").size();d==0&&$(".arrow-left",a).hide();b.attr("cl","false")})}})},resizecinebuzzSlider:function(){$(window).resize(function(){$(".slide-wrapper").each(function(){$wrapper=$(this);var a=parseInt($(".slider-wrap",$wrapper).first().width()/127);if(a>6)a=6;if(a<4)a=4;$li=$(".slider-wrap",$wrapper).first().children();$lisAll=$(".slider-wrap",$wrapper).children();if($li.length!=a){$lisAll.appendTo($wrapper);$(".slider-wrap",$wrapper).remove();for(var b=0;b<$lisAll.length;b+=a)$lisAll.slice(b,b+a).appendTo($wrapper).wrapAll("<div class='slider-wrap'></div>");var d=$(".slider-wrap",$wrapper).size(),e=$wrapper.first().width();$wrapper.first().width(e*d);$(".arrow-left",$wrapper).hide();var c=$wrapper.first().find(".slider-wrap").size();c==1&&$(".arrow-right",$wrapper).hide()}})})},loadFutureBookings:function(){$futurebookings=$("#future-bookings");$(".slide-wrapper",$futurebookings).append("<div><img src='"+baseCdnUrl+"img/loader-red.gif' /> Loading...</div>");$.ajax({url:"/Cinebuzz/GetFutureBookings",dataType:"json",cache:false,success:function(a){if(a.Success){var b=a.Data;$(".slide-wrapper",$futurebookings).first().html("");if(b.length==0)$(".future-bookings-box").parent().remove();else{$.tmpl($("#future-booking-template"),b).appendTo($(".slide-wrapper",$futurebookings).first());$(".future-booking-img").mouseenter(function(){$(this).next().fadeIn()});$(".future-booking-img").mouseleave(function(){$(this).next().hide()});$(".future-booking-details").mouseover(function(){$(this).show()});$(".future-booking-details").mouseout(function(){$(this).hide()});$(".slide-wrapper",$futurebookings).prepend("<div class='slider-wrap'></div>");ECPage.cinebuzz.cinebuzzSlider($(".future-bookings-box"),$(".future-booking-template-wrapper"))}}else $(".slide-wrapper",$futurebookings).append("<div>Error loading past bookings<div>")},error:function(){$(".slide-wrapper",$futurebookings).children().remove();$(".slide-wrapper",$futurebookings).append("<div>Error loading past bookings</div>")}})},loadFutureBookings2:function(){$("#future-bookings tbody").append("<tr><td colspan='5'><img src='"+baseCdnUrl+"img/loader-red.gif' /> Loading...</td></tr>");$.ajax({url:"/Cinebuzz/GetFutureBookings",dataType:"json",cache:false,success:function(a){if(a.Success){var b=a.Data;$("#future-bookings tbody tr").remove();if(b.length==0)$("#future-bookings tbody").append("<tr><td colspan='5'>There are no upcoming bookings.</td></tr>");else $.tmpl($("#future-booking-template"),b).appendTo($("#future-bookings tbody"))}else $("#future-bookings tbody").append("<tr><td>Error loading past bookings</td></tr>")},error:function(){$("#future-bookings tbody tr").remove();$("#future-bookings tbody").append("<tr><td>Error loading past bookings</td></tr>")}})},showSocialLogin:function(){var a=$(".cinebuzz-login");$("p.social-label",a).show();$("#loginDiv",a).show();$("p.signin-label",a).text("Or sign in using your Cine Buzz member number and password");gigya.socialize.showLoginUI({containerID:"loginDiv",cid:"",width:215,height:20,redirectURL:"https://"+window.location.hostname+"/member-programs/logingigya",UIConfig:'<config><body><controls><snbuttons buttonsize="20" /></controls></body></config>',showTermsLink:false,hideGigyaLink:true})},loadGigya:function(){if(typeof gigya=="undefined"){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="https://cdns.gigya.com/js/socialize.js?apiKey=3_fEX2sZaS4aspllaaZyAv0C5zxFxzZCFXxeGtJ-SapZHNzRT_JIagnzk-fJLoThTh";a.text="{ siteName: 'eventcinemas.com.au',enabledProviders: 'facebook,twitter,google,linkedin,yahoo,messenger,foursquare,openid'}";document.getElementsByTagName("head")[0].appendChild(a)}},submitResetPassword:function(){var a=$(this);if(a.isLoading())return false;var c=a.parent();ECPage.cinebuzz.resetError();var d=$.trim($("#FirstName",c).val());if(d.length===0){ECPage.cinebuzz.resetError("First Name is required");return false}var b=$.trim($("#Email",c).val());if(b.length===0){ECPage.cinebuzz.resetError("Email is required");return false}a.loading();EC.post({url:"/Cinebuzz/SendReset",data:{email:b,firstName:d},success:function(){a.stopLoading();EC.Message("Success","An email has been sent to "+b+" with instructions on changing your password.")},error:function(b){a.stopLoading();ECPage.cinebuzz.resetError(b)}});return false},resetError:function(a){if(a===undefined)a="";$("#forgotten-error").html(a)},validateDate:function(){var c=$("#birthDateThreeSelects #day").val(),a=$("#birthDateThreeSelects #month").val(),b=$("#birthDateThreeSelects #year").val();if(c=="-"||b=="-"||a=="-"){$("#birthDateThreeSelects").showValidationMessage("Please enter a valid date.");$("#birthDateThreeSelects select").addClass("input-validation-error");return false}var d=Date.parseExact(c+"-"+a+"-"+b,"dd-MM-yyyy"),e=Date.parseExact(c+"-"+a+"-"+b,"dd-MM-yy");if(d==null&&e==null){$("#birthDateThreeSelects").showValidationMessage("Please enter a valid date.");$("#birthDateThreeSelects select").addClass("input-validation-error");return false}if(ECPage.cinebuzz.calculateAge(d)<=15)$("#approve-guardian_checkbox").show();else $("#approve-guardian_checkbox").hide();$("#birthDateThreeSelects select").removeClass("input-validation-error");$("#birthDateThreeSelects").removeValidationMessage();return true},calculateAge:function(b){var a=Date.now()-b.getTime(),c=new Date(a);return Math.abs(c.getUTCFullYear()-1970)},setPreferences:function(){var a=$(".news .active").map(function(){return $(".checkbox",this).data("value")}).get();$("#User_Preferences").val(a.join())},validateStudentPayment:function(){var a=$("#StudentPaymentCardNumber").valueRequired();a=$("#StudentPaymentCardCsc").valueRequired()&&a;a=$("#StudentPaymentCardTypeId").valueRequired()&&a;if(!$("#StudentPaymentCardExpiryMonth").hasValue()){$("#StudentPaymentCardExpiryMonth").addError();a=false}a=$("#StudentPaymentCardExpiryYear").valueRequired()&&a;return a},updateProgress:function(){$(".main .progress").length>0&&$(".content .progress-bar").each(function(j,i){var b=$(i),c=parseInt(b.data("maxpoints")),a=b.width(),f=c/a,d=$(".progress",b),e=parseInt(b.text());if(e>=c)if($(".realpointsandawards-box").size()>0)d.css("width","99.90%");else d.width(a);else if(e==0)d.hide();else if($(".realpointsandawards-box").size()>0){var h=a*(e/c),g=h*100/a;d.css("width",g-.1+"%")}else d.width(a*(e/c));$("a",b).each(function(){var b=$(this),d=b.data("points");if($(".realpointsandawards-box").size()>0){var e=94.5;if(d<=c)var g=a*(d/c),e=(g-b.outerWidth()/2)*100/a;b.css("left",e-.1+"%")}else b.css("left",(d/f-20).toFixed(0).toString()+"px")});$("a",b).tooltip({track:true,delay:0,showURL:false,showBody:" - ",fade:100,top:-65,left:-55})})},updateProgress2:function(){$(".main .progress").length>0&&$(".content .progress-bar").each(function(h,g){var a=$(g),b=parseInt(a.data("maxpoints")),c=a.width(),f=b/c,e=$(".progress",a),d=parseInt(a.text());if(d>=b)e.width(c);else e.width(c*(d/b));$("a",a).each(function(){var a=$(this),b=a.data("points");a.css("left",(b/f-20).toFixed(0).toString()+"px")});$("a",a).tooltip({track:true,delay:0,showURL:false,showBody:" - ",fade:100,top:-65,left:-55})})},sameSizeRow:function(){$(".cinebuzz-page .row").each(function(){var a=$(this).find(".box");if(a.length>1){var b=Math.max.apply(Math,a.map(function(){var a=0;$(this).find(".stroke").each(function(){a+=$(this).outerHeight(true)});return a}).get());a.each(function(){var a=0;$(this).find(".stroke").each(function(){a+=$(this).outerHeight(true)});if(a<b){var c=$(this).find(".stroke:last"),d=c.height();c.height(d+(b-a))}})}})}};function triviaLoad(){var a=$(".member-dashboard .trivia .content"),b=0,c=0;if($(":radio[name='trivia']:checked").length>0){c=$(":radio[name='trivia']:checked").val();b=a.attr("TriviaId")}$.ajax({url:"/Cinebuzz/GetTrivia",data:{TriviaId:b,Answer:c,username:a.data("username")},dataType:"json",success:function(b){if(b.Success){a.data("trivia",b.Data);renderTriviaAnswer(b.Data)}else $(".member-dashboard .trivia .content").html("<p>Error loading trivia details</p>")}})}function renderTriviaAnswer(b){if(b.LastQuestionAnswer==0)renderTriviaQuestion();else{var a=$(".member-dashboard .trivia .content");$("div",a).addClass("incorrect");$(".q"+b.LastQuestionAnswer,a).removeClass("incorrect");$(".q"+b.LastQuestionAnswer,a).addClass("correct");if($(":radio[name='trivia']:checked").val()==b.LastQuestionAnswer)a.append("<div class='answer'>Correct</div>");else a.append("<div class='answer'>Incorrect</div>");triviaReload=window.setInterval(renderTriviaQuestion,5e3)}}function renderTriviaQuestion(){clearInterval(triviaReload);var c=$(".member-dashboard .trivia .content"),a=c.data("trivia");if(a.Question!=null){c.attr("TriviaId",a.TriviaId);var b="<strong>"+a.Question+"</strong><ul>";b+="<li><div class='q1'><input type='radio' name='trivia' value='1' /><label>"+a.Answer1+"</label></div></li>";b+="<li><div class='q2'><input type='radio' name='trivia' value='2' /><label>"+a.Answer2+"</label></div></li>";if(a.Answer3!=null)b+="<li><div class='q3'><input type='radio' name='trivia' value='3' /><label>"+a.Answer3+"</label></div></li>";if(a.Answer4!=null)b+="<li><div class='q4'><input type='radio' name='trivia' value='4' /><label>"+a.Answer4+"</label></div></li>";b+="</ul>";c.html(b)}else c.html("There are no more trivia questions at this time")}ECPage.cinema={index:function(){$("#Cinema-Filter").on("filter-clicked",".filter-element span",function(){FilterCinemas();$("#CinemaSearchSuggestions").hide()});$("#Cinema-Filter input.grey-search-btn").live("click",function(){FilterCinemas();$("#CinemaSearchSuggestions").hide()});$("#Cinema-Filter input#cinemaKeywordFilter").keydown(function(a){if(a.which==13||a.keyCode==13){FilterCinemas();$("#CinemaSearchSuggestions").hide();return}});$("#Cinema-Filter input#cinemaKeywordFilter").keyup(function(a){if($(this).val().length==0){$("#CinemaSearchSuggestions").hide();return}a.which!=13&&a.keyCode!=13&&ECPage.cinema.lookup($(this).val())});$(".block .strip").click(function(){if($("span",this).hasClass("open")){$("span",this).removeClass("open").addClass("closed");$(this).siblings(".content").hide()}else{$("span",this).removeClass("closed").addClass("open");$(this).siblings(".content").show()}});ECPage.cinema.initLoadPreferredCinemas()},details:function(){$("#cinema-gallery .cinema-gallery-thumb").click(function(){var a=$(this).data("fullsize"),b=new Image;b.onload=function(){EC.ShowModal('<img src="'+a+'" />')};b.src=a});var a=$("#set-preferred").data("id");EC.PreferredCinemas.contains(a)&&$("#set-preferred").hide();$("#set-preferred").click(function(){EC.PreferredCinemas.add($(this).data("id"),$(this).data("name"));$(this).hide()});$(document).bind("gigyaloaded",function(){console.log("second gigya");setTimeout(function(){var g=ECPage.cinema.getGigyaButton("facebook"),c=ECPage.cinema.getGigyaButton("twitter"),e=ECPage.cinema.getGigyaButton("youtube"),b=ECPage.cinema.getGigyaButton("custom"),f=$("#FacebookUrl").val();if(f)g.actionURL=f;var h=$("#TwitterAccount").val();if(h)c.actionURL=h;var i=$("#YoutubeUrl").val();if(i)e.actionURL=i;var d=$("#InstagramUrl").val();if(d)b.actionURL=d;var k=[g,c,e,b],j={containerID:"cinema-follow",iconSize:25,buttons:k};gigya.socialize.showFollowBarUI(j);var a=new gigya.socialize.UserAction;a.setTitle($("#Cinema_Fullname").val());a.setLinkBack("");a.setDescription("");$("#cinema-share").click(function(){gigya.socialize.showShareUI({userAction:a})})},1e3)});if($(".manual-details").length===0){ECWidget.cinemanowshowing.init();ECWidget.cinemaenquiry.init()}},promo:function(){if($(".find-times-and-book").length>0){$("#movie-overview-list").bind("additionalfilters",function(){var a=$(".find-times-and-book"),b=a.data("attributes"),c=a.data("screens");$("#movie-overview-list .btn").allVisible().each(function(f,a){var e=c.length==0,d=b.length==0;$.each(c,function(c,b){if($(a).data("screentype")==b){e=true;return false}});$.each(b,function(c,e){var b=$(a).data("attributes");if(b!=null&&b.length>0)for(var c=0;c<b.length;c++)if(b[c].Id==e){d=true;break}});(!e||!d)&&$(a).hide()});ECPage.movie.update.movies=a.data("movies")});$(".dates li").live("click",function(){var b=$(this).data("value");$(".results").html("");var a=[];a.push($(".find-times-and-book").data("cinema"));$(".find-times-and-book").hide();if($(".results").isLoading())return;$(".results").loading();ECPage.movie.getSessionFinderResultBase(b,a)});$("#movie-overview-list").bind("postfilter",function(){$(".dates").show();if($(".movie-list-item:visible").length===0)EC.ParseDate($("#AdvancedDate").val())<=EC.ParseDate($(".dates .active").data("value"))&&$(".results").html("No session available for that date yet")});var a=$(".dates .active").trigger("click");EC.QuickTimesSeats.init()}},getGigyaButton:function(b){if(gigya.services.socialize.plugins.followbar.instances.shareDiv.buttons)for(var c=gigya.services.socialize.plugins.followbar.instances.shareDiv.buttons.length,a=0;a<c;a++)if(gigya.services.socialize.plugins.followbar.instances.shareDiv.buttons[a].provider===b)return gigya.services.socialize.plugins.followbar.instances.shareDiv.buttons[a]},initLoadPreferredCinemas:function(){$(".where-blowout").bind("selectCinema",ECPage.cinema.selectCinemaListBlowout);if(EC.PreferredCinemas.any()&&$("#cinema-list-preferred").length>0){var b=$("#cinema-list-preferred dl"),a=[];$.each(EC.PreferredCinemas.all(),function(d,b){if(b.Name!=null&&b.Name!=""){var c=getCinemaUrl(b.Name);a.push({Name:b.Name,Id:b.Id,Url:c})}});$("#cinema-list-favorite-cinema").tmpl(a).appendTo(b)}$("#preferred-cinema-count").text(EC.PreferredCinemas.count());$("#cinema-list-preferred").on("click","span.x",function(){var a=$(this).data("id");EC.PreferredCinemas.remove(a);$(".where-blowout span div[id='"+a+"']").parent().click();$(this).parent(".fav").fadeOut().remove();$("#preferred-cinema-count").text(EC.PreferredCinemas.count())})},selectCinemaListBlowout:function(f){var d=f.target,a=$("div",d).attr("id"),c=$("div",d).attr("value");if(EC.PreferredCinemas.contains(a)){var b=[];b.push({Name:c,Id:a,Url:getCinemaUrl(c)});var e=$("#cinema-list-preferred dl");$("#cinema-list-favorite-cinema").tmpl(b).appendTo(e)}else $("#cinema-list-preferred span").each(function(){$(this).data("id")==a&&$(this).parent("dt.fav").fadeOut().remove()});$("#preferred-cinema-count").text(EC.PreferredCinemas.count())},lookup:function(a){clearTimeout(timerSearch);timerSearch=setTimeout(function(){ECPage.cinema.lookupSearch(a)},750)},lookupSearch:function(b){clearTimeout(timerSearch);if(b.length<3)$("#CinemaSearchSuggestions").fadeOut();else{var a="";$(".cinema-list-item .block").each(function(){var c=$(".cinemaItem",this).filter(function(){return $.trim($(this).text()).toLowerCase().indexOf(b.toLowerCase())>=0});if(c.length>0){a+="<span>"+$(this).data("label")+"</span>";c.each(function(){a+="<a href='/cinema/"+$(this).attr("href")+"'>"+$(this).html()+"</a>"})}});if(a.length>0){$("#CinemaSearchSuggestions").fadeIn();$("#CinemaSearchSuggestions").html(a)}}}};function FilterCinemas(){var a=$(".cinemaItem"),b=$.trim($("#cinemaKeywordFilter").val());if($("#Cinema-Filter span.active").length>0||b.length>0){a.hide();$("#brand-filters span.active div").each(function(){$('.cinemaItem[data-cinematypeid="'+$(this).attr("value")+'"]').show()});if(a.anyVisible())a=a.allVisible();$("#experience-filters span.active").length>0&&a.each(function(){var b=$(this),a=false;$("#experience-filters span.active div").each(function(){if(isTrue(b.data("has"+$(this).attr("value"))))a=true});if(a)$(this).show();else $(this).hide()});if(b.length>0){if(a.anyVisible())a=a.allVisible();var c=[];a.each(function(){if($(this).children().text().toLowerCase().indexOf(b.toLowerCase())>=0)$(this).show();else $(this).hide()})}}else a.show();updateCinemaCount()}function updateCinemaCount(){var a=$("div.cinema-list-item .block");a.each(function(){var a=0;$(".cinemaItem",this).each(function(){if($(this).css("display")!="none")a++});$("h2 label",this).text(a);if(a>0){$("h2 span",this).removeClass("closed").addClass("open");$(".content",this).show()}else{$("h2 span",this).removeClass("open").addClass("closed");$(".content",this).hide()}})}ECPage.corporatesales={contactus:function(){$("#contact-us .btn").click(function(){if($("#contact-us form").valid()){var a=$(this);a.loading(true);var b=$("#contact-us form").serialize();EC.post({url:"  /CorporateSales/ContactUs",data:b,success:function(){EC.Success("Your details have been successfully sent");a.stopLoading()},error:function(b){EC.Alert(b);a.stopLoading()},errorMessage:"Error sending details."})}return false})}};ECPage.crew={init:function(){changeSkinBackgroundSet(EC.CdnUrl("img/cinebuzz-crew-bg.gif"));var a=$(".cinebuzz-crew-left-nav");if(isTrue($("#cine-buzz").data("loggedin"))){$(".signup",a).closest("li").hide();$(".login",a).closest("li").hide();$(".myaccount",a).closest("li").show()}else{$(".myaccount",a).closest("li").hide();$(".login",a).closest("li").show();$(".signup",a).closest("li").show()}$(".awesomemovies").click(function(){LoadAwesomeMovies(-1);return false})},join:function(){ECPage.cinebuzz.join()},dashboard:function(){ECPage.cinebuzz.dashboard2()},login:function(){$(".login-btn").attr("href","/Crew/Join").append(" crew");ECPage.cinebuzz.login2()}};function LoadAwesomeMovies(){var a=$("#awesome-trailer");if(a.length===0)a=$("<div/>").attr("id","awesome-trailer").appendTo(".main .crew");var b=$("<div/>").attr("id","awesome-mask").appendTo(".main .crew");EC.get({url:"/Crew/AwesomeMovies",success:function(b){a.html(b);a.show();initAnimatedSlider();LazyLoadImages($("#awesome-trailer .items"));$(".items a:first",a).trigger("click")},error:function(){EC.Alert("Error retrieving Trailer")}})}function showAwesomeTrailer(b){var a=b.data("trailer");$("#awesome-trailer .info").html($("#synopsis-tmpl").tmpl(a));LazyLoadImages($("#awesome-trailer .info"));$("#awesome-trailer a.active").removeClass("active");b.addClass("active");if(isTrue(a.IsYoutube))$("#awesome-trailer #awesomeVideoArea").html("<iframe src='http://www.youtube.com/embed/"+a.TrailerId+"' class='video' frameborder='0' allowfullscreen></iframe>");else{if(isAppleDevice()||!a.FlvUrl)$("#awesome-trailer #awesomeVideoArea").html("<a class='video' href='"+a.M4vUrl+"' id='player'></a>");else $("#awesome-trailer #awesomeVideoArea").html("<a class='video' href='"+a.FlvUrl+"' id='player'></a>");$f("player",$("#cdnUrl").attr("path")+"img/flowplayer-3.2.12.swf").ipad()}}function closeAwesomeTrailer(){$("#awesome-mask").remove();$("#awesome-trailer").remove()}ECPage.customerservice={index:function(){$("#refund-enquiry").click(function(){EC.ShowModalRegion("#refund-form");return false});$("#refund-form .btn").click(function(){var a=$(this),b=a.closest("form");if(b.valid()){a.loading(true);EC.post({url:"/CustomerService/RefundRequest",data:b.serialize(),success:function(){EC.Success("Request has been submitted");a.stopLoading()},error:function(b){EC.Alert(b);a.stopLoading()},errorMessage:"Error submitting request"})}return false})}};ECPage.eventspromotions={details:function(){ECWidget.sessionfilter.$whereBlowout.bind("setcinema",function(){var a=$(".dates .active").data("value");ECPage.eventspromotions.grabSessions(a)});if($(".find-times-and-book").length>0){$("#movie-overview-list").bind("additionalfilters",function(){var a=$(".find-times-and-book"),b=a.data("attributes"),c=a.data("screens");$("#movie-overview-list .btn").allVisible().each(function(f,a){var e=c.length==0,d=b.length==0;$.each(c,function(c,b){if($(a).data("screentype")==b){e=true;return false}});$.each(b,function(c,e){var b=$(a).data("attributes");if(b!=null&&b.length>0)for(var c=0;c<b.length;c++)if(b[c].Id==e){d=true;break}});(!e||!d)&&$(a).hide()});ECPage.movie.update.movies=a.data("movies")});$(".dates li").live("click",function(){var a=$(this).data("value");ECPage.eventspromotions.grabSessions(a)});$("#movie-overview-list").bind("postfilter",function(){$(".dates").show();if($(".movie-list-item:visible").length===0)EC.ParseDate($("#AdvancedDate").val())<=EC.ParseDate($(".dates .active").data("value"))&&$(".results").html("No session available for that date yet")});var a=$(".dates .active").trigger("click");EC.QuickTimesSeats.init()}},grabSessions:function(d){$("#no-cinemas").hide();$(".results").html("");var b=EC.PreferredCinemas.orderedIds();if(b.length>0){var c=$(".find-times-and-book").data("cinemas"),a=[];if(c.length>0)$.each(b,function(d,b){$.inArray(b,c)>-1&&a.push(b)});else a=b;if(a.length==0){$(".find-times-and-book").show();$("#no-cinemas").show();$("#movie-overview-list").html("");return}$(".find-times-and-book").hide();if($(".results").isLoading())return;$(".results").loading();ECPage.movie.getSessionFinderResultBase(d,a)}else{$(".find-times-and-book").show();$("#movie-overview-list").html("");$(".dates").hide()}}};ECPage.friendsandfamily={init:function(){$("#lv-pay-now").click(function(){if(!ECPage.friendsandfamily.required("LostEmail")){var a=$.trim($("#LostEmail").val());if(a.length==0)return false;$.post(EC.Urls.FriendsAndFamily.LostVouchers,{email:a},function(a){if(a.Success)EC.Message("Success!!","Successfully resent emails with vouchers");else if(a.Message!==undefined)ECPage.friendsandfamily.lostError(a.Message);else ECPage.friendsandfamily.lostError("Error processing request.")})}else ECPage.friendsandfamily.lostError("Email required");return false});$("#lost").click(function(){EC.ShowModalRegion("#lost-vouchers");return false});$("#terms").click(function(){EC.ShowModalRegion("#terms-modal");return false});$("#SelectedPaymentType").live("change",function(){if($(this).val()==2)$("#payment-details").hide();else $("#payment-details").show()});$("#ff-pay-now").live("click",function(){var b=$(this);if(b.isLoading())return false;$("#modal-content #ff-error").html("");var c=$("#SelectedPaymentType").val(),a=ECPage.friendsandfamily.required("Email");a=ECPage.friendsandfamily.required("Name")||a;if(c==1){a=ECPage.friendsandfamily.required("CardNumber")||a;a=ECPage.friendsandfamily.required("SelectedCardType")||a;a=ECPage.friendsandfamily.required("ExpMM")||a;a=ECPage.friendsandfamily.required("ExpYY")||a;a=ECPage.friendsandfamily.required("CSV")||a}if(a){ECPage.friendsandfamily.displayError("Required fields missing");return false}else if(!ECValidate.validateEmail($("#Email").val())){ECPage.friendsandfamily.displayError("Email not in correct format");return false}if(c==1){if(!ECValidate.validateCreditCard($("#SelectedCardType").val(),$("#CardNumber").val(),ECPage.friendsandfamily.displayError))return false;if(!ECValidate.validateCreditCardDate("20"+$("#ExpYY").val(),$("#ExpMM").val(),ECPage.friendsandfamily.displayError))return false}if($.trim($("#modal-content #ff-error").html()).length===0){b.loading(true);var d=$(this).closest("form").serialize();$.post(EC.Urls.FriendsAndFamily.Payment,d,function(a){if(a.Success)window.location=a.RedirectUrl;else{b.stopLoading();if(a.Message===undefined)a.Message="Error purchasing vouchers. Please try again later";EC.Alert(a.Message)}})}return false});$("#card-details input").live("keyup",function(){$(this).hasClass("error")&&$(this).removeClass("error")});$("#card-details select").live("change",function(){$(this).hasClass("error")&&$(this).removeClass("error")});$("#friends-family #rightcolumn .btn").click(function(){var a=parseInt($("#TicketNo").val());if(a===0)EC.Alert("Must select at least 1 ticket");else{$("#Tickets").val(a);var c=parseFloat($("#Price").val()),b=a*c;$(".ff-amount").html("$"+b.toFixed(2));EC.ShowModalRegion("#card-details-area")}});$("#CSV").numericInt();$("#CardNumber").numericInt()},displayError:function(a){$("#modal-content #ff-error").html(a)},required:function(b){var a=$("#modal-content #"+b);if($.trim(a.val()).length===0){a.addClass("error");return true}return false},lostError:function(a){$("#lv-error").html(a)}};ECPage.giftcard={balance:function(){$("#gc-balance #Pin").numericInt();$("#gc-balance #GiftCardNumber").numericInt();$("#gc-balance .btn").click(function(){var a=$(this);if(a.isLoading())return false;$("#response").hide();var b=$("#GiftCardNumber");if(!b.hasValue()){EC.Alert(b.getName()+" required");return false}var c=$("#Pin");if(!c.hasValue()){EC.Alert("PIN required");return false}a.loading(true);EC.post({url:"/GiftCard/Balance",data:a.closest("form").serialize(),success:function(c){$("#response").show();$("#response .card").html(b.val());$("#response .amount").html(c);a.stopLoading()},error:function(b){EC.Alert(b);a.stopLoading()},errorMessage:"Error retrieving gift card balance"});return false})}};ECPage.home={init:function(){$("#premium-cinema-box .top a").click(function(){$("#premium-cinema-box .top .active").removeClass("active");$(this).parent().addClass("active");$("#premium-cinema-box .items a").hide();$("#premium-cinema-box .items a#"+$(this).parent().attr("id")+"_item").show()});$("body").on("click",".rotatorMovies a",function(){EC.ga("Home","Rotator - "+$("#slider .top .active").text(),$(this).find("img").attr("alt"))});$("body").on("click","#cine-buzz p a",function(){EC.ga("Home","CBR Click",$(this).text())});$("body").on("click","#premium-cinema-box a",function(){EC.ga("Home","Premium Cinema Tile",$(this).attr("id")=="gc_item"?"GoldClass":"Vmax")});$("body").on("click","#ticket-bar .btn.blue",function(){EC.ga("Home","FindTimesAndBook")});ECWidget.movierotator.init();EC.QuickTimesSeats.init();$(window).konami(function(){EC.Alert("This is not the konami code you were looking for..")});var a=new Date,b=false;if($("html.nz").length>0){if(a>new Date(2014,10-1,9)&&a<new Date(2014,10-1,23)||a>new Date(2014,10-1,30)&&a<new Date(2014,11-1,6)||a>new Date(2014,11-1,13)&&a<new Date(2014,11-1,27))b=true}else if($(".rialto-bar").length===0)if(a>new Date(2014,10-1,9)&&a<new Date(2014,10-1,16)||a>new Date(2014,10-1,30)&&a<new Date(2014,11-1,6)||a>new Date(2014,11-1,20)&&a<new Date(2014,11-1,27))b=true;b&&ECPage.home.HomePageTakeOver()},HomePageTakeOver:function(){changeSkinBackgroundSet(baseCdnUrl+"img/million/wallpaper-million-dollar.jpg");$(".call-to-action").clone().html("<div id='takeover-top'></div>").insertAfter(".call-to-action").addClass("hptakeover");$(".call-to-action").first().fadeOut(200);var a=$(".call-to-action.hptakeover");a.append("<div class='clearfix'></div>");a.append("<div id='takeover-bot'><a class='btn blue' href='/EventsPromotions/1MillionCompetition'>Find Out More</a></div>");a.fadeIn(600);ECWidget.movierotator.isHomePageTakeOver=true}};ECPage.hungerpromo={init:function(){$("#hunger-voucher-submit").click(function(){var a=$(this);if(a.isLoading())return false;a.loading(true);var b=a.closest("form");b.valid()&&$.ajax({url:"/HungerPromo",type:"POST",data:b.serialize(),success:function(b){a.stopLoading();if(b.Success)EC.Message("Success!","An email has been sent to your account with details on how to redeem.");else EC.Alert(b.Message)},error:function(){a.stopLoading();EC.Alert("There was an error sending the email, please try again later.")}});return false})}};ECPage.memberprograms={template:function(){}};ECPage.members={login:function(){var a=$("#ImageUrl").val();$("#background-wrap").css("background-image","url("+a+")");$("#background-wrap").click(function(){window.location=$("#LinkUrl").val();return false})}};ECPage.movie={initmovielist:function(){ECWidget.movielistfilter.$movieFilter().bind("movieFilter",function(){ECPage.movie.movieFilter()});ECWidget.movielistfilter.init();$('.widget[data-action="sessionfinder"]').length===0&&this.movieFilter();var a=null;$(".where-blowout").on("selectCinema","span",function(){var b=1;if(ie)b=500;a!=null&&clearTimeout(a);a=setTimeout(function(){if(!ECPage.movie.isThumb()){$("#movie-overview-list .movie-list-item .quick-times-select-widget").html("");$(".no-preferred-cinemas-set").hide();$("#movielist-tools a.list").trigger("initListLoad")}ECWidget.movielistfilter.filterMovies()},b)});this.initListThumbButtons();EC.QuickTimesSeats.init();ECPage.movie.settings().viewType==="list"&&$("#movielist-tools .list").trigger("click")},nowshowing:function(){$("#movielist-tools a.list").bind("initListLoad",function(){ECPage.movie.getListData("/Movie/NowShowingListData")});this.initmovielist();this.initNowShowingDdl();var a=ECPage.movie.settings().sortBy;(!a||a==="popularity")&&$("#movielist-tools #sort").val("popularity").trigger("change")},details:function(){EC.QuickTimesSeats.init();if($(".movies.basic").length>0)ECWidget.moviedetails.init();else ECWidget.homepremiumcinemabox.movieHanger();if($(".parallax").length>0){$(".parallax").parallax({calibrateX:false,calibrateY:true,invertX:true,invertY:true,limitX:10,limitY:10,scalarX:15,scalarY:15,frictionX:.1,frictionY:.1});$(window).on("resize",function(){var a=$(window).width()*(860/1430);if($(window).height()>a)$(".parallax").hide();else $(".parallax").show()});$(window).trigger("resize")}$.cookie("Cinebuzz")!=null&&EC.post({url:"/Cinebuzz/MemberMovie",data:{movieId:$("#Movie_Id").val()}})},advancedtickets:function(){$("a.list").bind("initListLoad",function(){ECPage.movie.getListData("/Movie/AdvancedListData")});this.initmovielist();this.initAdvancedComingSoonSortByDdl();ECPage.movie.settings().sortAdvancedBy==="alphabetical"&&$(".tools #sort").val("alphabetical").trigger("change")},comingsoon:function(){$("a.list").bind("initListLoad",function(){EC.get({url:"/Movie/GetComingSoonSynopsis",success:function(a){$.each(a,function(b,a){$('.movie-list-item[data-id="'+a.Id+'"] .descr p').html(a.Content)})}})});this.initmovielist();this.initAdvancedComingSoonSortByDdl();ECPage.movie.settings().sortAdvancedBy==="alphabetical"&&$(".tools #sort").val("alphabetical").trigger("change")},sessionfinder:function(){ECWidget.sessionfinderfilter.init();ECPage.movie.update.movies=[];ECPage.movie.update.attributes=[];var a=$.deparam.fragment(),c=a.attributes;if(c){var e=c.match(/[^,]+/g);$.each(e,function(b,a){ECPage.movie.update.attributes.push(a.toUpperCase())})}var d=a.movies;if(d){var f=d.match(/[^,]+/g);$.each(f,function(b,a){ECPage.movie.update.movies.push(parseInt(a))})}var b=a.exp;if(b){var g=b.match(/[^,]+/g);$.each(g,function(b,a){$('#experience-filters .checkbox[data-value="'+a.toLowerCase()+'"]').closest(".eccheckbox").active()})}$(".when-blowout ul").on("click","li",function(){var a=$(this).data("value");$.bbq.pushState({date:a})});$(".datesrow li").live("click",function(){var a=$(this).data("value");$.bbq.pushState({date:a})});ECWidget.sessionfilter.$whereBlowout.bind("setcinema",function(){ECPage.movie.update()});ECWidget.sessionfilter.$whatBlowout.bind("set-movie",function(){if(selected_movies)ECPage.movie.update.movies=$.map(selected_movies,function(a){return a.id});ECWidget.sessionfinderfilter.filterSessions()});$("#attribute-filters").bind("filter-clicked",function(){ECPage.movie.update.attributes=$("#attribute-filters .active").map(function(){return $(this).data("code")}).get()});$(window).bind("hashchange",function(){ECPage.movie.update()});$(".results").mousedown(function(a){if(a.which===2){if($("#timeline").is(":visible"))cancelTimeline();else if($(".cinema-row",$(".quick-times-select-widget").first()).length>1)timelineFilterByCinema();else timelineNoFilter();return false}});$("#timeline-group-cinema").click(timelineFilterByCinema);$("#timeline-group-movie").click(timelineFilterByMovie);$("#timeline-group-none").click(timelineNoFilter);if(EC.PreferredCinemas.any())ECPage.movie.update();else $("#where").trigger("click");EC.QuickTimesSeats.init()},movieFilter:function(){if(movielistsettings.loader.isLoading()){movielistsettings.filterHasQueue=true;return false}movielistsettings.loader.loading();var d=ECPage.movie.isThumb(),e;if(d)e=$("#movie-overview-thumb");else e=$("#movie-overview-list");var c=$(".movie-list-item",e),f=ECWidget.movielistfilter.get_selectedCinemas(),a=ECWidget.movielistfilter.get_selectedExperiences(),b=ECWidget.movielistfilter.get_selectedSessionAttribute();if(f.length>0&&(a.length>0||b.length>0)&&d){EC.get({url:"/Movie/FilterNowShowing",data:{cinemaId:f,screenTypes:a,has3D:EC.indexOf("three-d",a)>=0,attributes:b},traditional:true,success:function(f){var e=ECPage.movie.getMoviesToShowFromFilters(c);e=$.arrayIntersect(f,e);FadeInMovies(c,e);!d&&FilterSessions(a,b);movielistsettings.actionQueue()},error:function(a){EC.Toast(a,{toastClass:"error"});movielistsettings.loader.stopLoading();movielistsettings.filterHasQueue=false}});return}$("span.cinema-row").hide();$.each(f,function(b,a){$("span.cinema-row[id="+a+"]").show()});var g=this.getMoviesToShowFromFilters(c);FadeInMovies(c,g);!d&&FilterSessions(a,b);movielistsettings.actionQueue()},getMoviesToShowFromFilters:function(g){var c=ECWidget.movielistfilter.get_selectedCinemas(),d=ECWidget.movielistfilter.get_selectedGenres(),b=ECWidget.movielistfilter.get_selectedExperiences(),a=ECWidget.movielistfilter.get_selectedSessionAttribute(),f=ECWidget.movielistfilter.get_keyword(),e=[];g.each(function(){var i=$(this),l=i.data("cinemas").toString().split(/[\s,]+/),m=i.data("genres").toString().split(/[\s,]+/),h=false;if(window.location.href.indexOf("/movie/comingsoon")>-1)h=true;else if(c.length>0)$.each(c,function(b,a){h=h||$.inArray(a,l)>=0});else h=true;var j=false;if(d.length>0)$.each(d,function(b,a){j=j||$.inArray(a,m)>=0});else j=true;var g=false;if(b.length>0||a.length>0){b.length>0&&$.each(b,function(b,a){g=g||isTrue(i.data(a))});a.length>0&&$.each(a,function(b,a){g=g||i.data("attributes").indexOf(a)>=0})}else g=true;var k=false;if(f.length==0)k=true;else k=$(".title",i).text().toLowerCase().indexOf(f)>=0;h&&j&&g&&k&&e.push($(this).data("id"))});return e},initNowShowingDdl:function(){$("#movielist-tools select").change(function(){var d=ECPage.movie.isThumb(),a;if(d)a=$("#movie-overview-thumb");else a=$("#movie-overview-list");var c=$(".movie-list-item",a);if($(this).val()==="popularity")c.sortElements(function(a,b){return $(a).data("rank")<$(b).data("rank")?1:-1});else c.sortElements(function(a,b){return $(".title",a).html()>$(".title",b).html()?1:-1});var b=ECPage.movie.settings();b.sortBy=$(this).val();ECPage.movie.saveSettings(b);$(window).trigger("scroll")})},initAdvancedComingSoonSortByDdl:function(){$("#movielist-tools select").change(function(){var a=ECPage.movie.settings();a.sortAdvancedBy=$(this).val();ECPage.movie.saveSettings(a);if(ECPage.movie.isThumb())sortBy($(this).val(),$("#movie-overview-thumb"));else{var b=$("#movie-overview-list .movie-list-item");if($(this).val()==="release")b.sortElements(function(a,b){return Date.parseExact($(a).data("release"),"yyyy-MM-dd")>Date.parseExact($(b).data("release"),"yyyy-MM-dd")?1:-1});else b.sortElements(function(a,b){return $(".title",a).html()>$(".title",b).html()?1:-1});$(window).trigger("scroll")}})},settings:function(){var a={};if($.cookie("nowshowing_settings")!=null)a=$.parseJSON($.cookie("nowshowing_settings"));return a},saveSettings:function(a){$.cookie("nowshowing_settings",JSON.stringify(a))},initListThumbButtons:function(){$("a.list").unbind("click");$("a.list").click(function(){if(ECPage.movie.isThumb()){var a=ECPage.movie.settings();a.viewType="list";ECPage.movie.saveSettings(a);$(".tools .thumb").removeClass("active");$(".tools .list").addClass("active");$("#movie-overview-list .quick-times-select-widget").show();ECPage.movie.listView();$("#movie-overview-list").show();$("#movie-overview-thumb").hide()}return false});$("a.thumb").unbind("click");$("a.thumb").click(function(){if(!ECPage.movie.isThumb()){var a=ECPage.movie.settings();a.viewType="thumb";ECPage.movie.saveSettings(a);$(".tools .thumb").addClass("active");$(".tools .list").removeClass("active");$("#movie-overview-list").hide();$("#movie-overview-thumb").show();ECPage.movie.movieFilter()}return false})},listView:function(){if($.trim($("#movie-overview-list").html()).length===0){$("#movie-overview-thumb .movie-list-item").each(function(){var a=$(this),d={Id:a.data("id"),Attributes:a.data("attributes"),Rating:a.data("rating"),RunningTime:a.data("runningtime"),Genres:a.data("genres"),Cinemas:a.data("cinemas"),Has3D:a.data("three-d"),HasGoldClass:a.data("gc"),HasVmax:a.data("vmax"),HasDeluxe:a.data("deluxe"),Rank:a.data("rank"),PosterUrl:$(".image-wrapper img",a).data("original"),Title:$("p.title",a).html(),Url:$(".details-link",a).attr("href"),Release:a.data("release")},c=$("#now-showing-listitem");if($(".movies.movielist.coming-soon").length>0)c=$("#comingsoon-listitem");var b=$.tmpl(c,d);b.appendTo($("#movie-overview-list"));if(a.is(":visible")){a.hide();b.show()}});LazyLoadImages();$("#movielist-tools a.list").trigger("initListLoad");EC.Scroller.init()}else{$("#movie-overview-list .movie-list-item").hide();$("#movie-overview-thumb .movie-list-item").each(function(){var a=$(this);if(a.is(":visible")){a.hide();$('#movie-overview-list .movie-list-item[data-id="'+a.data("id")+'"]').show()}})}},update:function(){if($(".results").isLoading())return;$(".results").loading(true);var b=$.deparam.fragment(),a=b.date;if(ECPage.movie.update.movies.length>0&&!a)EC.get({url:"/Movie/GetEarliestSessionDate",traditional:true,data:{movieIds:ECPage.movie.update.movies,cinemaIds:EC.PreferredCinemas.orderedIds()},success:function(a){ECPage.movie.getSessionFinderResult(a.Date)}});else ECPage.movie.getSessionFinderResult(a)},getSessionFinderResult:function(a){ECPage.movie.getSessionFinderResultBase(a,EC.PreferredCinemas.orderedIds())},getSessionFinderResultBase:function(c,b){var a=[];c&&a.push("date="+c);$("#movie-overview-list").html("");b.length>0&&a.push("cinemas="+b.join());var d="/Movie/SessionFinderResult?"+a.join("&");EC.get({url:d,success:function(a){$(".results").stopLoading();var f=a.Html;$("#movie-overview-list").html("");$("#movie-overview-list").html(f);if($("#attribute-filters").length>0){var b=a.Attributes;if(b==null||b.length==0)$("#attribute-filters").hide();else{$("#attribute-filters").show();$("#attribute-filters .wrap #attriubtes-container").html("");$("#attribute-filters .wrap #attriubtes-container").html($.tmpl($("#attributeFilterTemplate"),b))}}$(".datesrow li").hide().removeClass("active");var e=EC.ParseDate($(".find-times-and-book").data("to")),d=EC.ParseDate($(".find-times-and-book").data("from"));$.each(a.Dates,function(f,a){var c=EC.ParseDate(a.value),b=$('.datesrow li[data-value="'+a.value+'"]');if(!(e&&c>e||d&&c<d))if(b.length===0)$(".datesrow ul").append($.tmpl(EC.SessionFilter.DateTemplate,a));else b.show()});$("#sessiondDates li").sortElements(function(a,b){return $(a).data("value")>$(b).data("value")?1:-1});$('.datesrow li[data-value="'+a.SelectedDate+'"]').active();var c=$("#session-finder-filter #attribute-filters");c.length>0&&$.each(ECPage.movie.update.attributes,function(b,a){$("span[data-code='"+a.toUpperCase()+"']",c).active()});ECWidget.sessionfinderfilter.initSessionAttributeFilters();ECWidget.sessionfinderfilter.filterSessions();$("#movie-overview-list").trigger("postfilter");LazyLoadImages();$(".quick-times-select-widget .dates-row .btn").showSeatsHover();EC.Scroller.init();EC.Scroller.ensureElementVisible($(".date-row-wrapper"),$(".dates li.active"))},error:function(){$(".results").stopLoading()}})},getListData:function(c){var a=ECWidget.movielistfilter.get_selectedCinemas();if(a.length===0)$("#movie-overview-list .no-preferred-cinemas-set").show();else{$("#movie-overview-list .quick-times-select-widget").loading();var b=EC.Guid();$("#movie-overview-list .movie-list-item:first").data("guid",b);EC.get({url:c,data:{cinemaIds:a,source:"WWW|Movies"},traditional:true,success:function(a){b===$("#movie-overview-list .movie-list-item:first").data("guid")&&$.eachAsync(a,{progress:function(a){if(a!=undefined){var b=$('#movie-overview-list .movie-list-item[data-id="'+a.Id+'"]');if(b.length>0){var c=$(".quick-times-select-widget",b);c.stopLoading();c.append(a.Html)}}},done:function(){var a=ECWidget.movielistfilter.get_selectedExperiences();a.length>0&&FilterSessions(a,null,$("#movie-overview-list .movie-list-item"));$("#movie-overview-list .quick-times-select-widget .dates-row .btn").showSeatsHover();EC.Scroller.init()}})}})}},isThumb:function(){return $("#movielist-tools a.thumb").hasClass("active")}};var movielistsettings={actionQueue:function(){if(this.filterHasQueue){this.filterHasQueue=false;ECPage.movie.movieFilter()}},filterHasQueue:false,loader:$(".movielist .results")};function FadeInMovies(b,a){b.each(function(){if($.inArray($(this).data("id"),a)>-1)$(this).show();else $(this).hide()});$("#movie-overview-thumb .month-wrapper").each(function(){if($(".movie-list-item",$(this)).anyVisible())$(this).show();else $(this).hide()});LazyLoadImages();updateNowShowingCount(a);movielistsettings.loader.stopLoading()}function updateNowShowingCount(a){$(".results span#count").text(a.length)}function sortBy(c,a){if(c=="release"){if(a.data("release")!=null){a.data("alphabetical",a.html());a.html(a.data("release"))}}else if(a.data("alphabetical")!=null){a.data("release",a.html());a.html(a.data("alphabetical"))}else{a.data("release",a.html());if(a.attr("id")=="movie-overview-thumb"){$("p.month").remove();var b=$("li",a).get();b.sort(function(c,d){var a=$("p.title",c).text().toLowerCase(),b=$("p.title",d).text().toLowerCase();return a<b?-1:a>b?1:0});var d=$("ul",a).first();$.each(b,function(b,a){d.append(a)})}else{$("p.month").remove();var b=$("div.movie-list-item",a).get();b.sort(function(c,d){var a=$("p.title",c).text().toLowerCase(),b=$("p.title",d).text().toLowerCase();return a<b?-1:a>b?1:0});$.each(b,function(c,b){a.append(b)})}}ECWidget.movielistfilter.filterMovies()}ECWidget.moviedetails={init:function(){if($("#movieNowShowing").length>0){console.log("movie details init");this.loadNowShowingInPreferredCinemas();ECWidget.sessionfilter.$whereBlowout.bind("setcinema",function(){ECWidget.moviedetails.loadNowShowingInPreferredCinemas()});this.loadGigya();$(".date-width-wrap ul.dates li").live("click",function(){ECWidget.moviedetails.loadNowShowingInPreferredCinemas($(this).data("value"))})}},loadGigya:function(){if(typeof gigya=="undefined"){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="https://cdns.gigya.com/js/socialize.js?apiKey=3_fEX2sZaS4aspllaaZyAv0C5zxFxzZCFXxeGtJ-SapZHNzRT_JIagnzk-fJLoThTh";a.text="{ siteName: 'eventcinemas.com.au',enabledProviders: 'facebook,twitter,google,linkedin,yahoo,messenger,foursquare,openid'}";document.getElementsByTagName("head")[0].appendChild(a)}},loadNowShowingInPreferredCinemas:function(c){var b=$(".movie-details #movieNowShowing");if(EC.PreferredCinemas.any()){$(".find-times-and-book",b).hide();$(".movie-list-item",b).show();var a=$(".quick-times-select-widget");if(a.isLoading()){ECWidget.moviedetails.hasQueue=true;return}a.loading(true);var f=a.data("movieid"),d=Date.today().toString("yyyy-MM-dd");if(c==undefined||c==null)c=d;var g={cinemaIds:EC.PreferredCinemas.orderedIds(),movieId:f,startDate:d,endDate:null,selectedDate:c,dateDisplayFormat:"ddd dd/MM",hasGoldClass:false,hasVmax:false,has3d:false,hasDeluxe:false,source:"WWW|Movies"};a.html("");$.ajax({url:"/Movie/QuickTimesSelect",data:g,traditional:true,success:function(b){a.html(b);a.stopLoading();EC.Scroller.init(a);$(".quick-times-select-widget .dates-row .btn").showSeatsHover();if(ECWidget.moviedetails.hasQueue){ECWidget.moviedetails.hasQueue=false;var c=$(".date-row-wrapper .active").data("value");ECWidget.moviedetails.loadNowShowingInPreferredCinemas(c)}}});var e=$(".quick-times-select-widget");e.show()}else{$(".find-times-and-book",b).show();$(".movie-list-item",b).hide()}},hasQueue:false};ECPage.premiumcinema={template:function(){$("#slider .arrow-right").click(function(){moveSliderRight()});$("#slider .arrow-left").click(function(){moveSliderLeft()});$("#slider.animate").on("click","a",function(){ECWidget.movierotator.stopRotator();$("#slider.animate").find("a.active").removeClass("active");$(this).addClass("active");if($("img",this).data("isstatic"))ECWidget.movierotator.stopRotator();else ECWidget.movierotator.startRotator();changeSkin2(false);return false});initAnimatedSlider();$("#slider.animate a:first").trigger("click");EC.QuickTimesSeats.init()}};function changeSkin2(e){var a=$("#slider.animate a.active"),f=a.data("skintitle"),i=a.data("skin"),b=a.data("id"),g=a.attr("href"),c=a.next(),h=c.data("skin"),d=c.data("id");!(e&&isTrue($("#slider").attr("disableSlider")))&&changeSkinBackground(b,i,d,h);changeCallToActionInfo(b,g,f,a);if(isTrue(a.data("hastrailer")))$(".call-to-action .poptrailer").show();else $(".call-to-action .poptrailer").hide()}ECPage.search={init:function(){EC.QuickTimesSeats.init();ECPage.search.getPageResult();$(window).bind("hashchange",ECPage.search.getPageResult)},getPageResult:function(){var a=$(".search-results");a.loading(true);a.html("");var c=$.deparam.fragment(),b=c.s;ECPage.search.getResults(b,function(c){a.append('<h2>Search results for: "<span id="SearchedString">'+b+'</span>"</h2>');$.each(c,function(d,b){a.append("<h3>"+b.CategoryDesc+"</h3>");if(b.Category=="NowShowing"||b.Category=="Advanced"){var c=$('<div class="movie-overview-list left '+b.Category+'">');$.each(b.Items,function(b,a){c.append($.tmpl($("#now-showing-listitem"),a))});a.append(c)}else if(b.Category=="ComingSoon"){var c=$('<div class="movie-overview-list left '+b.Category+'">');$.each(b.Items,function(b,a){c.append($.tmpl($("#comingsoon-listitem"),a))});a.append(c)}else $.each(b.Items,function(c,b){a.append($.tmpl($("#resultItemTmpl"),b))})});a.stopLoading();if(c.length==0){a.append('<div class="result-item">No results found</div>');return}if($(".movie-list-item").length>0){LazyLoadImages();$(".movie-list-item").each(function(e,d){var c=$(d),a=$(".quick-times-select-widget",c);a.loading(true);var b=Date.today().toString("yyyy-MM-dd");$.ajax({url:"/Movie/QuickTimesSelect",data:{cinemaIds:EC.PreferredCinemas.orderedIds(),movieId:c.data("id"),startDate:b,endDate:null,selectedDate:b,dateDisplayFormat:"ddd dd/MM",hasGoldClass:false,hasVmax:false,has3d:false,hasDeluxe:false,source:"search"},traditional:true,success:function(b){a.append(b);a.stopLoading();EC.Scroller.init(a)}})})}},function(){a.stopLoading();EC.Toast("error")})},getResults:function(c,a,b){EC.get({url:"/Search/Results",data:{query:c},traditional:true,success:a,error:b,errorMessage:"Error performing query"})},lookup:function(a){clearTimeout(timerSearch);timerSearch=setInterval(function(){ECPage.search.lookupSearch(a)},750)},lookupSearch:function(a){clearTimeout(timerSearch);if(a.length<3)$("#SearchSuggestions").fadeOut();else ECPage.search.getResults(a.trim(),function(a){$("#SearchSuggestions").fadeIn();if(a.length===0)$("#SearchSuggestions").html("<span>There were no results for your search</span>");else $("#SearchSuggestions").html($.tmpl(ECPage.search.basicSearchTemplate,a))},function(){})},basicSearchTemplate:'<span>${CategoryDesc}</span>{{each(i, item) Items}}<a href="${item.Url}">${item.Title}</a>{{/each}}'};ECPage.survey={unsubscribe:function(){$(".survey form").submit(function(){EC.post({url:"/Survey/Unsubscribe",data:$(this).serialize(),success:function(){EC.Success("Request submitted successfully")},error:function(a){EC.Alert(a)},errorMessage:"Error submitting unsubscribe request"});return false})}};ECTicketing.common={init:function(){$("#proceed").on("click",function(){var a=$(this);if(a.isLoading())return false;var c=false,d=$("body").data("action"),b=ECTicketing[d];if(b&&$.isFunction(b.validate))c=b.validate();if(c)if(ie){$("form").submit();a.loading(true)}else{a.loading(true);$("form").submit()}});var a=$("#theTime").html();$(".time-remaining").show();$("#theTime").countdown({until:+a,onExpiry:function(){EC.Alert("Your time to complete this booking has been exceeded.<br />Press OK to start your booking again.",{close:function(){window.location="/movie/"}})},layout:"{mn}:{snn}"});$(".button-box").click(function(){var a=$(this);if(a.isActive())a.inactive();else a.active();a.trigger("change");return false});LazyLoadImages()}};ECTicketing.paypalcancel={init:function(){ECTicketing.step4.init()}};ECTicketing.step2={init:function(){$(".select-tickets .item-table a").tooltip({bodyHandler:function(){return $($(this).attr("href")).html()},showURL:false});UpdateTicketQuantity($(".qty.threedglasses"));$(".cinebuzz-numbers").on("keyup","input.cinebuzz-number",function(){ECTicketing.step2.checkCinebuzzCard(true)});$(".cinebuzz-numbers").on("change","input.cinebuzz-number",function(){ECTicketing.step2.checkCinebuzzCard()});$(".item-table").on("change","select.qty",function(){if($('input[name$="IsPlatinum"][value="True"]').length>0)if($(this).attr("id").indexOf("OrderTickets_")==0)if($(this).data("isplat")==="True")if($(this).val()>0)$('select[name$="Quantity"][name^="OrderTicket"][data-isplat="False"]').attr("disabled","disabled");else $('select[name$="Quantity"][name^="OrderTicket"]').removeAttr("disabled");else{var a=$('select[name$="Quantity"][name^="OrderTicket"][data-isplat="False"]').filter(function(){return parseInt($(this).val(),10)>0}).length>0;if(a)$('select[name$="Quantity"][name^="OrderTicket"][data-isplat="True"]').attr("disabled","disabled");else $('select[name$="Quantity"][name^="OrderTicket"]').removeAttr("disabled")}UpdateTicketQuantity(this)});$("#voucherPinSpan").hide();$("#voucher").on("keyup",ECTicketing.step2.showHidePin);$("#voucher").on("change",ECTicketing.step2.showHidePin);$("#voucher-submit").on("click",function(){var b=$(this),a=$.trim($("#voucher").val().toLowerCase()),d=$.trim($("#voucherpin").val()),c=$("#Token").val();$("#voucherpin").removeError();$("#voucher-error").html("");ECValidate.validateVoucher(a,d,c,b,false,EC.Alert)});$("#voucherpin,#voucher").onEnterClick("#voucher-submit");$("#voucherpin").numericInt();$(".cinebuzz-number").numericInt();$("#show-login").click(function(){EC.ShowModalRegion("#login-section");return false});$("#cine-login").click(function(){var a=$(this);if(a.isLoading())return false;a.loading(true);var b=$("#login-section");EC.post({url:"/Cinebuzz/Login",data:{Username:$("#Username",b).val(),Password:$("#Password",b).val()},success:function(){a.stopLoading();window.location.reload()},error:function(b){a.stopLoading();EC.Alert(b)},errorMessage:"Error logging in"});return false})},validate:function(){var a=true;if($("#ticket-selection").length>0){var b=0,c=parseInt($("#SessionAvailableSeats").val());$(".qty").each(function(){var a=parseInt($(this).val());if(!$(this).hasClass("threedglasses")&&!$(this).hasClass("complimentary")&&a>0)b=b+a});$(".vchlabel").each(function(){b++});if(b>c){if(c===1)EC.Alert("There is only 1 seat available. Change your ticket selection or choose another session");else EC.Alert("There are only "+c+" seats available. Please change your ticket selection or choose another session");a=false}else if(b>10){EC.Alert("You may only order a maximum of 10 tickets<br /> Complete another order to purchase more tickets");a=false}else if(b==0){EC.Alert("Please select tickets before continuing");a=false}else if($("#ChildAgreeement").is(":visible"))if(!$("#ChildAgreeement").is(":checked")){EC.Alert("Please agree to the Terms and Conditions");a=false}}ECTicketing.step2.checkCinebuzzCard();if(!ECTicketing.step2.findInvalidCinebuzzCards(false))a=false;if(ECTicketing.step2.findCinebuzzDuplicates())a=false;return a},checkCinebuzzCard:function(a){$(".cinebuzz-numbers div.error").remove();var c=ECTicketing.step2.findInvalidCinebuzzCards(a);if(c){var b=ECTicketing.step2.findCinebuzzDuplicates();b&&$(".cinebuzz-numbers").append("<div class='error'>Error: Duplicate cards found</div>")}else $(".cinebuzz-numbers").append("<div class='error'>Error: Invalid Card</div>")},findCinebuzzDuplicates:function(){var a=true;$(".cinebuzz-numbers input.cinebuzz-number").each(function(e,d){var b=$(d);b.removeError();var c=$.trim(b.val());c.length>0&&$(".cinebuzz-numbers input.cinebuzz-number").each(function(f,e){var d=$(e);if($.trim(d.val())==c&&b.attr("name")!=d.attr("name")){a=false;b.addError();d.addError()}})});return!a},findInvalidCinebuzzCards:function(a){a=typeof a==="undefined"?false:a;var b=true;$(".cinebuzz-numbers input.cinebuzz-number").each(function(f,e){var c=$(e);c.removeError();var d=$.trim(c.val());if(d.length>0)if(a&&d.length<12)b=true;else if(d.length==12){if(d.substring(0,3)!="800"){b=false;c.addError()}}else{b=false;c.addError()}});return b},showHidePin:function(){var a=$.trim($("#voucher").val().toLowerCase());if(ECValidate.showPin(a))$("#voucherPinSpan").show();else $("#voucherPinSpan").hide();$("#voucher-error").html("")}};ECValidate.giftCardSuccess=function(a){$("#voucher").val("");$("#voucherpin").val("");$("#voucherPinSpan").hide();if($("#totGiftCard").find("#gf"+a.giftcardNumber).length===0){var e=parseFloat(a.Balance),d={guid:EC.Guid(),giftcardnumber:a.giftcardNumber,balance:e.toFixed(2),orderpaymentid:a.OrderPaymentId},c=$("#giftcard-row-template").tmpl(d);$("#totGiftCard").css("display")=="none"&&$("#totGiftCard").css("display","");$("#totGiftCard").append(c);var b=$("#totGiftCard").find("div.giftCardItem:hidden");b.slideDown()}UpdateTicketQuantity($(".qty").first())};ECValidate.allVouchers=function(){return $(".tixeachitem").map(function(){return $(this).data("barcode")})};ECValidate.allGiftCards=function(){return $('input[name$="GiftcardID"]').map(function(){return $(this).val()})};ECValidate.voucherDupSelector=function(a){return'.tixeachitem[data-barcode="'+a+'"]'};ECValidate.promoDupSelector=function(a){return $('.tixeachitem input[id$="PromoCode"][value="'+a+'"]')};ECValidate.voucherSuccess=function(b){$("#voucher").val("");$("#voucherpin").val("");$("#voucherPinSpan").hide();if(!$("a[title*='"+b.name+"']").length>0){b.showRemove=true;var a=$(".tixeachitem:first");if(a.parent().hasClass("tixpromosel"))a=a.parent();a.before($("#ticket-row-template").tmpl(b))}UpdateTicketQuantity($(".qty").first())};ECValidate.promoSuccess=function(b){$("#voucher").val("");$("#voucherpin").val("");$("#voucherPinSpan").hide();if(!$("."+b.promocode).length>0){var a=$(".tixeachitem:first");if(a.parent().hasClass("tixpromosel"))a=a.parent();a.before($("#ticket-row-template").tmpl(b))}else EC.Alert("*Promo code has already been entered on this order");UpdateTicketQuantity($(".qty").first())};function removeItemLine(a){$(a).parent().parent().remove();UpdateTicketQuantity(a);return false}function UpdateTicketQuantity(t){var g=0,a=0,m=0,e=[],r=$(".item-table"),p=parseFloat(r.data("bookingfee")),d=$(t);$.each($(".tixeachitem"),function(e,b){var d=parseFloat($(".qty",b).val()),a=$(b).data("children");if(a!=undefined&&a.length>0){var c=a.split(",");$.each(c,function(e,c){var b=$("."+c),a=b.closest(".tixeachitem");if(d>0)a.show();else{a.hide();b.val("0")}})}});$.each($(".item-table select.qty"),function(n,l){var d=$(l);if(!d.hasClass("threedglasses")&&!d.hasClass("complimentary")){var c=d.closest(".tixeachitem"),b=parseFloat(d.val());if(b>0){a+=b;var j=parseFloat($('input[name$="Price"]',c).val()),h=b*j;g+=h;var f=parseFloat(c.data("bookingfee")),k=parseFloat(c.data("seatqty"));m+=k*b;if(f==0)for(var i=0;i<p.length;i++)e.push({price:p,qty:b});else e.push({price:f,qty:b});$("span.subtotal",c).text("$"+h.toFixed(2))}else $("span.subtotal",c).text("-")}});$("#num-tickets").text(a);$("#num-seats").text(m);var k=$("select.threedglasses");if(k.length>0){!d.hasClass("threedglasses")&&!d.hasClass("complimentary")&&k.val(m);var n=getConcessionItemTotal(k);g+=n}var f=$("select.complimentary");if(f.length>0){var s=d.closest(".tixeachitem");s.data("iscomp")==="True"&&!d.hasClass("complimentary")&&$("select.complimentary").val(d.val());var n=getConcessionItemTotal(f);if(n>0)f.closest(".tixeachitem").show();else f.closest(".tixeachitem").hide();g+=n}var i=0,l=[];$.each(e,function(b,a){$.inArray(a.price,l)<0&&l.push(a.price);i+=a.price*a.qty});var j="";$.each(l,function(c,b){var a=0;$.each(e,function(d,c){if(c.price==b)a+=c.qty});j+=" $"+b.toFixed(2)+" x "+a+" tickets,"});$("#booking-fee span.price").text($.trim(j.substring(0,j.lastIndexOf(",")-1)));$("#booking-fee span.subtotal").text("$"+i.toFixed(2));$("div.total-cost #total").text("$"+(g+i).toFixed(2));var o=$("div.cinebuzz-numbers"),c=$("input.cinebuzz-number",o);if(a>c.length)for(var q=c.length;q<a;q++){var u={Guid:EC.Guid()};$.tmpl(cinebuzzCardTemplate,u).appendTo(o)}else if(a<c.length)for(var h=c.length;h>=a;h--)h>0&&$(c[h]).remove();if($("#ticket-selection").length>0){var b="";$.each($(".tixeachitem"),function(e,c){var d=$.trim($(".first a",c).text()),a=$(".qty",c);if(a.val()!="0"&&!a.hasClass("threedglasses")&&!a.hasClass("complimentary"))b+=a.val()+" x "+d+"<br/>"});if(b!=="")$("#SummaryOfTickets").html("<strong>Number of tickets</strong><br/>"+b);else $("#SummaryOfTickets").html("");var b="";$.each($(".tixeachitem"),function(e,c){var d=$.trim($(".first a",c).text()),a=$(".qty",c);if(a.val()!="0"&&(a.hasClass("threedglasses")||a.hasClass("complimentary")))b+=a.val()+" x "+d+"<br/>"});if(b!=="")$("#SummaryOfExtras").html("<br/><strong>Extras</strong><br/>"+b);else $("#SummaryOfExtras").html("")}a>10&&EC.Alert("You may only order a maximum of 10 tickets<br /> Complete another order to purchase more tickets")}function getConcessionItemTotal(b){var a=0;b.each(function(f,d){var c=$(d).closest(".tixeachitem"),e=parseFloat($('input[name$="Price"]',c).val()),b=$(d).val()*e;if(b==0)$("span.subtotal",c).text("-");else $("span.subtotal",c).text("$"+b.toFixed(2));a+=b});return a}ECTicketing.step3={init:function(){var b=parseInt($(".seat-selection-wrapper").data("seatselection"));if(b>0){var a=$(".seat-selection");a.on("click",".seats li",function(){selectSeat($(this),a.data("seatselection"))});ECTicketing.step3.resizeSeatingPlan()}},validate:function(){var c=true;if($(".seat-selection").length>0){var a=parseInt($("#TotalSeats").val()),b=$(".selected").length;if(b<a){var d=a-b;EC.Alert("You should select "+a+" seat(s) in total. Please select "+d+" more seat"+(d>1?"s":""));c=false}}return c},resizeSeatingPlan:function(){console.log("resizing..");var d=$(".seats").width(),b=0;$(".seats .row:first li").each(function(){b+=$(this).outerWidth(true)});$(".seats").width(b);var a=0;if(b>d)a=10;var c=$(".seats").height();$(".seats .row").each(function(){a+=$("li",$(this)).outerHeight(true)});a+=$(".front").outerHeight(true);a+=$(".rear").outerHeight(true);a>c&&$(".seats").height(a)}};ECTicketing.step4={init:function(){ECTicketing.step4.scoopAlley();ECTicketing.step4.calculateRemaining();$("#CardNumber").numericInt();$("#CardCsc").numericInt();$("input[id$='_Amount']").numeric();$("#MobileNumber").numericInt();$(".digital-btn").on("click",function(){var a=$("#proceed");if(a.isLoading())return false;$("input, select").removeError();if(ECTicketing.step4.validateMobile()&&ECTicketing.step4.validateTerms()){a.loading(true);$("#SelectedPaymentType").val($(this).data("paymenttypeid"));$("form").validate().cancelSubmit=true;$("form").submit()}return false});$("#ccno input").off("keyup change blur");$("#normal-cards input, #normal-cards select").on("change blur",function(){ECTicketing.step4.validate()});$(".gift-cards").on("keyup","span.giftcardallocation input:text",function(){var b=$(this),a=b.data("timerId");a&&window.clearTimeout(a);b.data("timerId",window.setTimeout(function(){ECTicketing.step4.calculateRemaining()},1e3))});$("input#giftcardnumber").on("keyup",ECTicketing.step4.showHideGiftCardPin);$("input#giftcardnumber").on("change",ECTicketing.step4.showHideGiftCardPin);$("#giftcardvalidate").click(function(){var a=$(this);if(a.isLoading())return false;var b=$.trim($("#giftcardnumber").val());$(this).removeError();var c=ECValidate.Regex.nzoldgiftc.test(b);if(c){EC.Message("Sorry!","Unfortunately Gift Cards issued prior to August 2013 can't be redeemed on-line for security reason;<br /> you will need to present your gift card at the box office at your local cinema. <br />The good news is gift cards issued after August 2013 have a unique PIN and can be used on-line.");return false}else if(ECValidate.testGiftCard(b)){a.loading(true);$.getJSON("/GiftCardServices/Validate",{giftcardNumber:b,pin:$("#giftcardpin").val(),token:$("#Token").val()},function(b){a.stopLoading();if(b!=null)if(b.Success){var d={guid:EC.Guid(),giftcardnumber:$("#giftcardnumber").val(),balance:parseFloat(b.Balance).toFixed(2),orderpaymentid:b.OrderPaymentId};$(".gift-cards").show();$(".gift-cards #giftCards").after($("#giftcard-row-template").tmpl(d));var c=$("#gift-card-container").find("div.giftcardline:hidden");if(ie)c.show();else c.slideDown("slow");$("#giftcardnumber").val("");$("#giftcardpin").val("");$(".remaining-cost").show();ECTicketing.step4.allocateAmounts();$("#SelectedPaymentType").val()=="3"&&$("#gift-card-section .button-box").trigger("click")}else EC.Alert(b.Message);else EC.Alert("System error, please try again later")})}else EC.Alert("Invalid gift card number");return false});$("#CardTypeId").on("change",function(){ECTicketing.step4.UpdateCompetitionCheckList()});$(".payment-choice").click(function(){$(".button-box",$(this)).trigger("click");return false});$(".payment-choice .button-box").bind("change",function(){var a=$(this);if(a.isActive()){$(".payment-option").slideUp();a.closest(".payment-choice").siblings(".payment-option").slideDown();$(".payment-choice .button-box").not(a).inactive();$("#SelectedPaymentType").val(a.data("id"));a.trigger("opened")}else{a.closest(".payment-choice").siblings(".payment-option").slideUp();$("#SelectedPaymentType").val("")}ECTicketing.step4.UpdateCompetitionCheckList()});$("#credit-card-section .button-box").bind("opened",function(){$("#RevealNormal").trigger("change")});$("#RevealNormal").change(function(){if($(this).is(":checked")){$("#SelectedPaymentType").val("1");$("#normal-cards").slideDown()}else{$("#SelectedPaymentType").val("stored");$("#normal-cards").slideUp(function(){$("#normal-cards").hide()})}});$("#manage-btn").click(function(){EC.ShowModalRegion("#manage-stored-cards");return false});$("#manage-stored-cards .card-remove").live("click",function(){var a=$(this),b=a.data("id");EC.post({url:"/Ticketing/RemoveCard",data:{id:b},success:function(){var c=a.closest("tr");c.fadeOut(function(){c.remove()});$('#SelectedStoredCard option[value="'+b+'"]').remove()},error:function(){},errorMessage:"Error removing card"});return false})},validate:function(){$("#TermsConditions_checkbox").removeError();$("select, input").removeError();var a=$(".payment #Name").valueRequired();a=$(".payment #EmailAddress").valueRequired()&&a;a=ECTicketing.step4.validateMobile()&&a;if($("#normal-cards").is(":visible")){var d=$("#CardTypeId").removeError().val(),b=$("#CardNumber").removeError().val(),g=$("#CardCsc").removeError().val(),c=$("#CardExpiryMonth").removeError().val(),e=$("#CardExpiryYear").removeError().val();if(/\D/.test(b)){$("#CardNumber").addError("Card number must be numeric.");a=false}else if(!ECValidate.validateCreditCard(d,b,function(a){$("#CardNumber").addError(a)}))a=false;if($.trim(g).length==0){$("#CardCsc").addError("Please enter the card CSC");a=false}if(d.length==0){$("#CardTypeId").addError("Please select a card type");a=false}if($.trim(c).length==0||$.trim(e).length==0){$("#CardExpiryMonth").addError();$("#CardExpiryYear").addError("Please select the card Expiry date");a=false}if(a)a=ECValidate.validateCreditCardDate(e,c,function(){$("#CardExpiryMonth").addError();$("#CardExpiryYear").addError("Card expiration is in the past")})}a=a&&ECTicketing.step4.validateTerms();if(a&&!ECTicketing.step4.calculateRemaining()&&!$("#SelectedPaymentType").hasValue()){EC.Alert("Please select a payment type");a=false}var f=[];$("#competitions span.active:visible").each(function(){f.push($("div",$(this)).data("value"))});$("#SelectedCompetitions").val(f.join(","));return a},scoopAlley:function(){var a=$("#scoop-alley");if(a.length>0){ECTicketing.step4.allocateAmounts();parseInt($("#scoop-alley").data("items"))>0&&a.data("haserror").toLowerCase()!="true"&&showScoopAlley();$("#scoop-alley-proceed").click(function(){updateOrderSummaryForScoop();ECTicketing.step4.allocateAmounts();$("#cover").hide();$("#scoop-alley").hide()});$("#scoop-alley .close").click(function(){closeScoopAlley(false);updateOrderSummaryForScoop()});$("#no-thanks").click(function(){closeScoopAlley(true);updateOrderSummaryForScoop()})}},UpdateCompetitionCheckList:function(){var a=$("#SelectedPaymentType").val();if(a){$("#competitions span").hide();$("#competitions span").each(function(){var b=$("div",$(this)).data("paymenttypes")+"";(!b||$.inArray(a,b.split(","))>-1)&&$(this).show();if(a=="1"){var d=$("#CardTypeId").val();if(d){var c=$("div",$(this)).data("cardtypes")+"";if(c)if($.inArray(d,c.split(","))>-1)$(this).show();else $(this).hide();else $(this).show()}else $(this).show()}})}else $("#competitions span").show()},validateMobile:function(){var a=true,b=$("#MobileNumber").removeError();if(b.length>0){var c=$.trim(b.val());if(c.length===0){$("#MobileNumber").addError("You must specify your mobile number");a=false}else if(c.length!==10){$("#MobileNumber").addError("Mobile must be 10 digits in length");a=false}}return a},showHideGiftCardPin:function(){var a=$.trim($("input#giftcardnumber").val().toLowerCase());if(ECValidate.Regex.nzoldgiftc.test(a)){$("#giftcardpin").hide();$('label[for="giftcardpin"]').hide()}else{$("#giftcardpin").show();$('label[for="giftcardpin"]').show()}},updateGiftCardAmount:function(a,b){var c=$("#Token").val();$.getJSON("/GiftCardServices/Update",{token:c,orderPaymentId:a,amount:b})},allocateAmounts:function(){ECTicketing.step4.calculateRemaining();var a=parseFloat($(".remaining-cost #remaining-total").text().replace("$",""));$(".giftcardline").each(function(e,b){var d=parseFloat($(b).data("available")),c=Math.min(a,d);parseFloat($(".giftcardallocation input:text",b).val())==0&&$(".giftcardallocation input:text",b).val(c.toFixed(2));a-=c});ECTicketing.step4.calculateRemaining()},calculateRemaining:function(){var a=true;$(".giftcardallocation input:text").removeError();$(".giftcardline span.error").remove();var b=parseFloat($("#transaction-total").data("total"))+parseFloat($("#transaction-total").data("scoop-total"));if($(".giftcardline").length==0)a=true;$(".giftcardline").each(function(g,c){var d=parseFloat("0"+$(".giftcardallocation input:text",c).val()),e=parseFloat($(c).data("available"));if(isNaN(d)){$(".giftcardallocation input:text",c).addError();EC.Alert("Please enter a valid number");$(".remaining-cost #remaining-total").text("-");a=false}else{if(d<0){$(".giftcardallocation input:text",c).addError();EC.Alert("Amount allocated must be greater than 0 and less than $"+e.toFixed(2));$(".remaining-cost #remaining-total").text("-");a=false}if(e<d){a=false;$(".giftcardallocation input:text",c).addError();EC.Alert("You do not have sufficient funds on the gift card.");$(".remaining-cost #remaining-total").text("-")}else{b-=d;if(!$(".giftcardallocation input:text",c).hasClass("input-validation-error"))if(parseFloat($(c).data("lastval"))!=d){var f=$(c).data("id");ECTicketing.step4.updateGiftCardAmount(f,d);$(c).data("lastval",d)}}}});if(!a)return a;if(b==NaN){$(".remaining-cost #remaining-total").text("-");a=false}else if(b.toFixed(2)==0){$("#SelectedPaymentType").val("3");$("#all-payment-options").slideUp();$(".remaining-cost #remaining-total").text("$"+b.toFixed(2))}else if(b<0){$(".giftcardallocation input:text").addError("You have allocated too much money from the gift cards");$(".remaining-cost #remaining-total").text("-");a=false}else{$("#all-payment-options").slideDown();$(".remaining-cost #remaining-total").text("$"+b.toFixed(2));a=false}ValueChange();return a},validateTerms:function(){if(!$("#TermsConditions_checkbox").removeError().isActive()){$("#TermsConditions_checkbox").addError("You must agree to the Conditions of Sale");return false}return true}};function showScoopAlley(){$("#cover").show();var a=$("#scoop-alley");a.show();$(window).bind("resize",function(){resizeScoopAlley(a)});resizeScoopAlley(a);$("#cover").unbind("click")}function resizeScoopAlley(a){var b=0;$(".total-cost",a).each(function(){b+=$(this).outerHeight(true)});var d=$(".back-proceed",a).outerHeight(true)+$(".row.head .first",a).outerHeight(true)+$(".intro",a).outerHeight(true)+b+20,c=a.outerHeight();$(".scoop-alley-items",a).height(c-d)}function updateOrderSummaryForScoop(){var a=[],e=$("#scoop-alley"),f=0;$(".row",e).each(function(){var b=0,c=parseInt($(".tixqtysel",this).val()),e=parseFloat($("input:hidden[name$='.Price']",this).val());if(c>0){b=c*e;f+=b;var g=$("input:hidden[name$='.Name']",this).val(),d=$("input:hidden[name$='.HOCode']",this).val();a.push({name:g,qty:c,subtotal:b,hocode:d})}});var c="<strong>Candy Bar</strong> <strong>(<a onclick='showScoopAlley()'>Change</a>)</strong>";if(a.length>0)$.each(a,function(b,a){c+="<div id='"+a.name+"'>"+a.qty+" x "+a.name});else c+="<div>None selected</div>";$("#SummaryOfScoopAlley").html("<p>"+c+"</p>");e.data("items",a);var b=$("#transaction-total"),g=parseFloat(b.data("total")),d="$"+(f+g).toFixed(2);if(b.text()!=d){b.text(d);$(".giftcardline").each(function(b,a){$(a).data("lastval",0);$(".giftcardallocation input:text",a).val(0)})}}function calculateScoopAlley(){var d=[],c=$("#scoop-alley"),a=0;$(".row",c).each(function(){var c=parseInt($(".tixqtysel",this).val()),f=parseFloat($("input:hidden[name$='.Price']",this).val());if(c>0){var b=c*f;a+=b;var g=$("input:hidden[name$='.Name']",this).val(),e=$("input:hidden[name$='.HOCode']",this).val();d.push({name:g,qty:c,subtotal:b,hocode:e});$("span.subtotal",this).text("$"+b.toFixed(2))}else $("span.subtotal",this).text("-")});var b=parseFloat($("#transaction-total").data("total"));$("#transaction-total").data("scoop-total",a.toFixed(2));$("#scoop-subtotal").text("$"+a.toFixed(2));var e=a+b;$("#scoop-total").text("$"+e.toFixed(2))}function closeScoopAlley(b){var a=$("#scoop-alley");$("option",a).removeAttr("selected");$("option[value=0]",a).attr("selected","selected");if(!b){var c=a.data("items");$.each(c,function(c,b){var a=$(".row input:hidden[name$='.HOCode'][value='"+b.hocode+"']").parent().find(".tixqtysel");$("option",a).removeAttr("selected");$("option[value="+b.qty+"]",a).attr("selected","selected")})}$(window).unbind("resize");calculateScoopAlley();a.hide();$("#cover").hide()}ECValidate.Regex={re:new RegExp("[g]+[0-9]+[a-z]"),giftc:new RegExp("[9]+[0]+[3]+[6]"),nzoldgiftc:new RegExp("^(60001[0-9]{9})"),nzgiftc:new RegExp("^(60001[0-9]{7})"),mbf:new RegExp("[g]+[0-1]+[e]+[0]+[1-2]"),nzoldvc:new RegExp("^(50[5,6][0-9][0-9])"),nzvc:new RegExp("[n]+[0145]+[a-z]+[0-9]+[0-9]"),village:new RegExp("[v]+[0-9]"),village2:new RegExp("^[c]{1}[0-9a-z]{11}$"),cinebuzz:new RegExp("[8][0][0]")};ECValidate.validateVoucher=function(a,d,e,c,g,b){if(c.isLoading())return false;if(a.length===0)b("Number required");else if(g)if(ECValidate.Regex.cinebuzz.test(a)&&a.length==12){var f=false;$(ECValidate.cinebuzzDupSelector).each(function(){if($(this).val()==a)f=true});if(!f)ECValidate.cinebuzzSuccess(a);else b("Cine Buzz card already added")}else b("The Cine Buzz number is not valid");else if(ECValidate.testGiftCard(a))if(d.length==4){c.loading(true);$.getJSON("/GiftCardServices/Validate",{giftcardNumber:a,pin:d,token:e},function(a){c.stopLoading();if(a!=null)if(a.Success)ECValidate.giftCardSuccess(a);else b(a.Message);else b("System error, please try again later")})}else b("Invalid pin code");else if(ECValidate.Regex.re.test(a)&&a.length>=5||ECValidate.Regex.nzvc.test(a)||ECValidate.Regex.village.test(a)||ECValidate.Regex.village2.test(a)){if($(ECValidate.voucherDupSelector(a)).length>0){b("Voucher already exists");return false}if(d.length===0){b("PIN required");ECValidate.pinError&&ECValidate.pinError()}else{c.loading(true);$.getJSON("/Voucher/Validate",{voucherId:a,pinEnteredByUser:d,token:e},function(a){c.stopLoading();if(a!=null)if(a.Success)ECValidate.voucherSuccess(a.Data);else if(a.Message!=undefined&&a.Message.length>0)b(a.Message);else b("The Voucher is not valid");else b("System error, pelase try again later")})}}else if(ECValidate.Regex.nzoldvc.test(a))b("Unfortunately Movie Vouchers issued prior to August 2013 can't be redeemed on-line for security reason;<br/> you will need to present your voucher at the box office at your local cinema. <br />The good news is vouchers issued after August 2013 have a unique PIN and can be used on-line.");else if(ECValidate.Regex.nzoldgiftc.test(a))b("Unfortunately Gift Cards issued prior to August 2013 can't be redeemed on-line for security reason;<br /> you will need to present your gift card at the box office at your local cinema. <br />The good news is gift cards issued after August 2013 have a unique PIN and can be used on-line.");else if($(ECValidate.promoDupSelector(a)).length>0){b("Promo code has already been entered on this order");return false}else{c.loading(true);$.getJSON("/PromoCode/ValidatePromo",{promoCode:a,token:e},function(a){c.stopLoading();if(a!=null)if(a.Success)ECValidate.promoSuccess(a.Data);else if(a.Message!=undefined&&a.Message.length>0)b(a.Message);else b("The Promo Code is not valid");else b("System error, pelase try again later")})}};ECValidate.showPin=function(a){return ECValidate.Regex.giftc.test(a)&&a.length==19||ECValidate.Regex.nzgiftc.test(a)&&a.length==12||(ECValidate.Regex.re.test(a)||ECValidate.Regex.mbf.test(a))&&a.length>=5||ECValidate.Regex.nzvc.test(a)&&a.length==12||ECValidate.Regex.village2.test(a)||ECValidate.Regex.village.test(a)&&a.length==12};ECValidate.testGiftCard=function(a){return ECValidate.Regex.giftc.test(a)&&a.length==19||ECValidate.Regex.nzgiftc.test(a)};ECValidate.validateCreditCard=function(c,a,b){if(c=="4"&&a.length!=16&&a.length!=13){b("Visa numbers must be 13 or 16 digits.");return false}else if(c=="3"&&a.length!=16){b("Mastercard numbers must be 16 digits.");return false}else if(c=="1"&&a.length!=15){b("American Express card numbers must be 15 digits.");return false}else if(c=="2"&&a.length!=14){b("Diners Club card numbers must be 14 digits.");return false}else if(cardtype="0"&&a.length==0){b("Card Number is required");return false}return true};ECValidate.validateCreditCardDate=function(c,b,a){var e=new Date(c,b,1),d=new Date;if(d>e){a("Card expiration is in the past");return false}return true};ECValidate.validateEmail=function(a){var b=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;return b.test(a)};var V=V||{};function ValueChange(){onVmeReady()}function onVmeReady(){if($("#remaining-total").size()>0)Amount=$("#remaining-total").html().replace("$","");else if($("#transaction-total").size()>0)Amount=$("#transaction-total").html().replace("$","");$.isFunction(V.init)&&V.init({apikey:$("#VmeApiKey").val(),settings:{review:{buttonAction:"Pay"}},paymentRequest:{total:parseFloat(Amount).toFixed(2),description:"Ticket Total Amount",currencyCode:"AUD"}});if($.isFunction(V.on)){V.on("payment.success",function(a){$("#VmeCallId").val(a.callid);EC.post({url:"/Ticketing/CompleteVmeTransaction",data:{encPaymentData:a.encPaymentData,encKey:a.encKey},success:function(a){$("#CardNumber").val(a.cardNumber);!$("#EmailAddress").hasValue()&&$("#EmailAddress").val(a.email);!$("#Name").hasValue()&&$("#Name").val(a.name);$("#CardTypeId").val(a.paymentType);$("#CardExpiryYear").val(a.expiryYY);$("#CardExpiryMonth").val(a.expiryMM);$("#SelectedPaymentType").val(6);$("form").submit();$("#proceed").loading(true)},error:function(a){EC.Alert(a)},errorMessage:"There was an error completing the v.me order"})});V.on("payment.cancel",function(){$("#VmeCallId").val("")});V.on("payment.error",function(b,a){$("#VmeCallId").val("");EC.Alert(JSON.stringify(a))})}}/*! jQuery UI - v1.8.23 - 2012-08-15
* https://github.com/jquery/jquery-ui
* Includes: jquery.ui.core.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
(function(a,b){function c(b,f){var c=b.nodeName.toLowerCase();if("area"===c){var g=b.parentNode,h=g.name,e;return!b.href||!h||g.nodeName.toLowerCase()!=="map"?!1:(e=a("img[usemap=#"+h+"]")[0],!!e&&d(e))}return(/input|select|textarea|button|object/.test(c)?!b.disabled:"a"==c?b.href||f:f)&&d(b)}function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};if(a.ui.version)return;a.extend(a.ui,{version:"1.8.23",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(f){if(f!==b)return this.css("zIndex",f);if(this.length){var c=a(this[0]),d,e;while(c.length&&c[0]!==document){d=c.css("position");if(d==="absolute"||d==="relative"||d==="fixed"){e=parseInt(c.css("zIndex"),10);if(!isNaN(e)&&e!==0)return e}c=c.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(h,c){function f(c,b,d,e){return a.each(g,function(){b-=parseFloat(a.curCSS(c,"padding"+this,!0))||0,d&&(b-=parseFloat(a.curCSS(c,"border"+this+"Width",!0))||0),e&&(b-=parseFloat(a.curCSS(c,"margin"+this,!0))||0)}),b}var g=c==="Width"?["Left","Right"]:["Top","Bottom"],d=c.toLowerCase(),e={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+c]=function(g){return g===b?e["inner"+c].call(this):this.each(function(){a(this).css(d,f(this,g)+"px")})},a.fn["outer"+c]=function(b,g){return typeof b!="number"?e["outer"+c].call(this,b):this.each(function(){a(this).css(d,f(this,b,!0,g)+"px")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,d,c){return!!a.data(b,c[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var c=document.body,b=c.appendChild(b=document.createElement("div"));b.offsetHeight,a.extend(b.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=b.offsetHeight===100,a.support.selectstart="onselectstart"in b,c.removeChild(b).style.display="none"}),a.curCSS||(a.curCSS=a.css),a.extend(a.ui,{plugin:{add:function(e,f,d){var c=a.ui[e].prototype;for(var b in d)c.plugins[b]=c.plugins[b]||[],c.plugins[b].push([f,d[b]])},call:function(a,d,e){var b=a.plugins[d];if(!b||!a.element[0].parentNode)return;for(var c=0;c<b.length;c++)a.options[b[c][0]]&&b[c][1].apply(a.element,e)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,d){if(a(b).css("overflow")==="hidden")return!1;var c=d&&d==="left"?"scrollLeft":"scrollTop",e=!1;return b[c]>0?!0:(b[c]=1,e=b[c]>0,b[c]=0,e)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}})})(jQuery);
/*! jQuery UI - v1.8.23 - 2012-08-15
* https://github.com/jquery/jquery-ui
* Includes: jquery.ui.widget.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
(function(a,b){if(a.cleanData){var c=a.cleanData;a.cleanData=function(b){for(var d=0,e;(e=b[d])!=null;d++)try{a(e).triggerHandler("remove")}catch(f){}c(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,c){return this.each(function(){return c||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(b){}}),d.call(a(this),b,c)})}}a.widget=function(b,d,e){var c=b.split(".")[0],f;b=b.split(".")[1],f=c+"-"+b,e||(e=d,d=a.Widget),a.expr[":"][f]=function(c){return!!a.data(c,b)},a[c]=a[c]||{},a[c][b]=function(a,b){arguments.length&&this._createWidget(a,b)};var g=new d;g.options=a.extend(!0,{},g.options),a[c][b].prototype=a.extend(!0,g,{"namespace":c,widgetName:b,widgetEventPrefix:a[c][b].prototype.widgetEventPrefix||b,widgetBaseClass:f},e),a.widget.bridge(b,a[c][b])},a.widget.bridge=function(c,d){a.fn[c]=function(e){var f=typeof e=="string",g=Array.prototype.slice.call(arguments,1),h=this;return e=!f&&g.length?a.extend.apply(null,[!0,e].concat(g)):e,f&&e.charAt(0)==="_"?h:(f?this.each(function(){var d=a.data(this,c),f=d&&a.isFunction(d[e])?d[e].apply(d,g):d;if(f!==d&&f!==b)return h=f,!1}):this.each(function(){var b=a.data(this,c);b?b.option(e||{})._init():a.data(this,c,new d(e,this))}),h)}},a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(c,b){a.data(b,this.widgetName,this),this.element=a(b),this.options=a.extend(!0,{},this.options,this._getCreateOptions(),c);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(c,e){var d=c;if(arguments.length===0)return a.extend({},this.options);if(typeof c=="string"){if(e===b)return this.options[c];d={},d[c]=e}return this._setOptions(d),this},_setOptions:function(b){var c=this;return a.each(b,function(a,b){c._setOption(a,b)}),this},_setOption:function(b,a){return this.options[b]=a,b==="disabled"&&this.widget()[a?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",a),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(c,b,d){var e,f,g=this.options[c];d=d||{},b=a.Event(b),b.type=(c===this.widgetEventPrefix?c:this.widgetEventPrefix+c).toLowerCase(),b.target=this.element[0],f=b.originalEvent;if(f)for(e in f)e in b||(b[e]=f[e]);return this.element.trigger(b,d),!(a.isFunction(g)&&g.call(this.element[0],b,d)===!1||b.isDefaultPrevented())}}})(jQuery);
/*! jQuery UI - v1.8.23 - 2012-08-15
* https://github.com/jquery/jquery-ui
* Includes: jquery.ui.position.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
(function(a){a.ui=a.ui||{};var c=/left|center|right/,d=/top|center|bottom/,b="center",e={},f=a.fn.position,g=a.fn.offset;a.fn.position=function(g){if(!g||!g.of)return f.apply(this,arguments);g=a.extend({},g);var i=a(g.of),n=i[0],m=(g.collision||"flip").split(" "),j=g.offset?g.offset.split(" "):[0,0],k,l,h;return n.nodeType===9?(k=i.width(),l=i.height(),h={top:0,left:0}):n.setTimeout?(k=i.width(),l=i.height(),h={top:i.scrollTop(),left:i.scrollLeft()}):n.preventDefault?(g.at="left top",k=l=0,h={top:g.of.pageY,left:g.of.pageX}):(k=i.outerWidth(),l=i.outerHeight(),h=i.offset()),a.each(["my","at"],function(){var a=(g[this]||"").split(" ");a.length===1&&(a=c.test(a[0])?a.concat([b]):d.test(a[0])?[b].concat(a):[b,b]),a[0]=c.test(a[0])?a[0]:b,a[1]=d.test(a[1])?a[1]:b,g[this]=a}),m.length===1&&(m[1]=m[0]),j[0]=parseInt(j[0],10)||0,j.length===1&&(j[1]=j[0]),j[1]=parseInt(j[1],10)||0,g.at[0]==="right"?h.left+=k:g.at[0]===b&&(h.left+=k/2),g.at[1]==="bottom"?h.top+=l:g.at[1]===b&&(h.top+=l/2),h.left+=j[0],h.top+=j[1],this.each(function(){var d=a(this),f=d.outerWidth(),i=d.outerHeight(),n=parseInt(a.curCSS(this,"marginLeft",!0))||0,o=parseInt(a.curCSS(this,"marginTop",!0))||0,q=f+n+(parseInt(a.curCSS(this,"marginRight",!0))||0),r=i+o+(parseInt(a.curCSS(this,"marginBottom",!0))||0),c=a.extend({},h),p;g.my[0]==="right"?c.left-=f:g.my[0]===b&&(c.left-=f/2),g.my[1]==="bottom"?c.top-=i:g.my[1]===b&&(c.top-=i/2),e.fractions||(c.left=Math.round(c.left),c.top=Math.round(c.top)),p={left:c.left-n,top:c.top-o},a.each(["left","top"],function(b,d){a.ui.position[m[b]]&&a.ui.position[m[b]][d](c,{targetWidth:k,targetHeight:l,elemWidth:f,elemHeight:i,collisionPosition:p,collisionWidth:q,collisionHeight:r,offset:j,my:g.my,at:g.at})}),a.fn.bgiframe&&d.bgiframe(),d.offset(a.extend(c,{using:g.using}))})},a.ui.position={fit:{left:function(b,c){var d=a(window),e=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft();b.left=e>0?b.left-e:Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=a(window),e=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop();b.top=e>0?b.top-e:Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(h,c){if(c.at[0]===b)return;var d=a(window),i=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft(),e=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,f=c.at[0]==="left"?c.targetWidth:-c.targetWidth,g=-2*c.offset[0];h.left+=c.collisionPosition.left<0?e+f+g:i>0?e+f+g:0},top:function(h,c){if(c.at[1]===b)return;var d=a(window),i=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop(),e=c.my[1]==="top"?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,f=c.at[1]==="top"?c.targetHeight:-c.targetHeight,g=-2*c.offset[1];h.top+=c.collisionPosition.top<0?e+f+g:i>0?e+f+g:0}}},a.offset.setOffset||(a.offset.setOffset=function(b,c){/static/.test(a.curCSS(b,"position"))&&(b.style.position="relative");var d=a(b),e=d.offset(),g=parseInt(a.curCSS(b,"top",!0),10)||0,h=parseInt(a.curCSS(b,"left",!0),10)||0,f={top:c.top-e.top+g,left:c.left-e.left+h};"using"in c?c.using.call(b,f):d.css(f)},a.fn.offset=function(b){var c=this[0];return!c||!c.ownerDocument?null:b?a.isFunction(b)?this.each(function(c){a(this).offset(b.call(this,c,a(this).offset()))}):this.each(function(){a.offset.setOffset(this,b)}):g.call(this)}),a.curCSS||(a.curCSS=a.css),function(){var c=document.getElementsByTagName("body")[0],g=document.createElement("div"),b,d,f,h,i;b=document.createElement(c?"div":"body"),f={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},c&&a.extend(f,{position:"absolute",left:"-1000px",top:"-1000px"});for(var j in f)b.style[j]=f[j];b.appendChild(g),d=c||document.documentElement,d.insertBefore(b,d.firstChild),g.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;",h=a(g).offset(function(b,a){return a}).offset(),b.innerHTML="",d.removeChild(b),i=h.top+h.left+(c?2e3:0),e.fractions=i>21&&i<22}()})(jQuery);
/*! jQuery UI - v1.8.23 - 2012-08-15
* https://github.com/jquery/jquery-ui
* Includes: jquery.ui.dialog.js
* Copyright (c) 2012 AUTHORS.txt; Licensed MIT, GPL */
(function(a,c){var b="ui-dialog ui-widget ui-widget-content ui-corner-all ",d={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},e={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};a.widget("ui.dialog",{options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",collision:"fit",using:function(b){var c=a(this).css(b).offset().top;c<0&&a(this).css("top",b.top-c)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title"),typeof this.originalTitle!="string"&&(this.originalTitle=""),this.options.title=this.options.title||this.originalTitle;var c=this,d=c.options,i=d.title||"&#160;",h=a.ui.dialog.getTitleId(c.element),g=(c.uiDialog=a("<div></div>")).appendTo(document.body).hide().addClass(b+d.dialogClass).css({zIndex:d.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(b){d.closeOnEscape&&!b.isDefaultPrevented()&&b.keyCode&&b.keyCode===a.ui.keyCode.ESCAPE&&(c.close(b),b.preventDefault())}).attr({role:"dialog","aria-labelledby":h}).mousedown(function(a){c.moveToTop(!1,a)}),j=c.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(g),f=(c.uiDialogTitlebar=a("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(g),e=a('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){e.addClass("ui-state-hover")},function(){e.removeClass("ui-state-hover")}).focus(function(){e.addClass("ui-state-focus")}).blur(function(){e.removeClass("ui-state-focus")}).click(function(a){return c.close(a),!1}).appendTo(f),k=(c.uiDialogTitlebarCloseText=a("<span></span>")).addClass("ui-icon ui-icon-closethick").text(d.closeText).appendTo(e),l=a("<span></span>").addClass("ui-dialog-title").attr("id",h).html(i).prependTo(f);a.isFunction(d.beforeclose)&&!a.isFunction(d.beforeClose)&&(d.beforeClose=d.beforeclose),f.find("*").add(f).disableSelection(),d.draggable&&a.fn.draggable&&c._makeDraggable(),d.resizable&&a.fn.resizable&&c._makeResizable(),c._createButtons(d.buttons),c._isOpen=!1,a.fn.bgiframe&&g.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){var a=this;return a.overlay&&a.overlay.destroy(),a.uiDialog.hide(),a.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),a.uiDialog.remove(),a.originalTitle&&a.element.attr("title",a.originalTitle),a},widget:function(){return this.uiDialog},close:function(d){var b=this,c,e;return!1===b._trigger("beforeClose",d)?void 0:(b.overlay&&b.overlay.destroy(),b.uiDialog.unbind("keypress.ui-dialog"),b._isOpen=!1,b.options.hide?b.uiDialog.hide(b.options.hide,function(){b._trigger("close",d)}):(b.uiDialog.hide(),b._trigger("close",d)),a.ui.dialog.overlay.resize(),b.options.modal&&(c=0,a(".ui-dialog").each(function(){this!==b.uiDialog[0]&&(e=a(this).css("z-index"),isNaN(e)||(c=Math.max(c,e)))}),a.ui.dialog.maxZ=c),b)},isOpen:function(){return this._isOpen},moveToTop:function(f,d){var b=this,c=b.options,e;return c.modal&&!f||!c.stack&&!c.modal?b._trigger("focus",d):(c.zIndex>a.ui.dialog.maxZ&&(a.ui.dialog.maxZ=c.zIndex),b.overlay&&(a.ui.dialog.maxZ+=1,b.overlay.$el.css("z-index",a.ui.dialog.overlay.maxZ=a.ui.dialog.maxZ)),e={scrollTop:b.element.scrollTop(),scrollLeft:b.element.scrollLeft()},a.ui.dialog.maxZ+=1,b.uiDialog.css("z-index",a.ui.dialog.maxZ),b.element.attr(e),b._trigger("focus",d),b)},open:function(){if(this._isOpen)return;var b=this,c=b.options,d=b.uiDialog;return b.overlay=c.modal?new a.ui.dialog.overlay(b):null,b._size(),b._position(c.position),d.show(c.show),b.moveToTop(!0),c.modal&&d.bind("keydown.ui-dialog",function(b){if(b.keyCode!==a.ui.keyCode.TAB)return;var c=a(":tabbable",this),d=c.filter(":first"),e=c.filter(":last");return b.target===e[0]&&!b.shiftKey?(d.focus(1),!1):b.target===d[0]&&b.shiftKey?(e.focus(1),!1):void 0}),a(b.element.find(":tabbable").get().concat(d.find(".ui-dialog-buttonpane :tabbable").get().concat(d.get()))).eq(0).focus(),b._isOpen=!0,b._trigger("open"),b},_createButtons:function(b){var c=this,d=!1,e=a("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),f=a("<div></div>").addClass("ui-dialog-buttonset").appendTo(e);c.uiDialog.find(".ui-dialog-buttonpane").remove(),typeof b=="object"&&b!==null&&a.each(b,function(){return!(d=!0)}),d&&(a.each(b,function(e,b){b=a.isFunction(b)?{click:b,text:e}:b;var d=a('<button type="button"></button>').click(function(){b.click.apply(c.element[0],arguments)}).appendTo(f);a.each(b,function(a,b){if(a==="click")return;a in d?d[a](b):d.attr(a,b)}),a.fn.button&&d.button()}),e.appendTo(c.uiDialog))},_makeDraggable:function(){function c(a){return{position:a.position,offset:a.offset}}var b=this,d=b.options,e=a(document),f;b.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(e,g){f=d.height==="auto"?"auto":a(this).height(),a(this).height(a(this).height()).addClass("ui-dialog-dragging"),b._trigger("dragStart",e,c(g))},drag:function(a,d){b._trigger("drag",a,c(d))},stop:function(h,g){d.position=[g.position.left-e.scrollLeft(),g.position.top-e.scrollTop()],a(this).removeClass("ui-dialog-dragging").height(f),b._trigger("dragStop",h,c(g)),a.ui.dialog.overlay.resize()}})},_makeResizable:function(d){function f(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}d=d===c?this.options.resizable:d;var b=this,e=b.options,g=b.uiDialog.css("position"),h=typeof d=="string"?d:"n,e,s,w,se,sw,ne,nw";b.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:b.element,maxWidth:e.maxWidth,maxHeight:e.maxHeight,minWidth:e.minWidth,minHeight:b._minHeight(),handles:h,start:function(c,d){a(this).addClass("ui-dialog-resizing"),b._trigger("resizeStart",c,f(d))},resize:function(a,c){b._trigger("resize",a,f(c))},stop:function(c,d){a(this).removeClass("ui-dialog-resizing"),e.height=a(this).height(),e.width=a(this).width(),b._trigger("resizeStop",c,f(d)),a.ui.dialog.overlay.resize()}}).css("position",g).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return a.height==="auto"?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(b){var c=[],e=[0,0],d;if(b){if(typeof b=="string"||typeof b=="object"&&"0"in b)c=b.split?b.split(" "):[b[0],b[1]],c.length===1&&(c[1]=c[0]),a.each(["left","top"],function(a,b){+c[a]===c[a]&&(e[a]=c[a],c[a]=b)}),b={my:c.join(" "),at:c.join(" "),offset:e.join(" ")};b=a.extend({},a.ui.dialog.prototype.options.position,b)}else b=a.ui.dialog.prototype.options.position;d=this.uiDialog.is(":visible"),d||this.uiDialog.show(),this.uiDialog.css({top:0,left:0}).position(a.extend({of:window},b)),d||this.uiDialog.hide()},_setOptions:function(f){var g=this,b={},c=!1;a.each(f,function(a,f){g._setOption(a,f),a in d&&(c=!0),a in e&&(b[a]=f)}),c&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",b)},_setOption:function(g,c){var d=this,e=d.uiDialog;switch(g){case"beforeclose":g="beforeClose";break;case"buttons":d._createButtons(c);break;case"closeText":d.uiDialogTitlebarCloseText.text(""+c);break;case"dialogClass":e.removeClass(d.options.dialogClass).addClass(b+c);break;case"disabled":c?e.addClass("ui-dialog-disabled"):e.removeClass("ui-dialog-disabled");break;case"draggable":var h=e.is(":data(draggable)");h&&!c&&e.draggable("destroy"),!h&&c&&d._makeDraggable();break;case"position":d._position(c);break;case"resizable":var f=e.is(":data(resizable)");f&&!c&&e.resizable("destroy"),f&&typeof c=="string"&&e.resizable("option","handles",c),!f&&c!==!1&&d._makeResizable(c);break;case"title":a(".ui-dialog-title",d.uiDialogTitlebar).html(""+(c||"&#160;"))}a.Widget.prototype._setOption.apply(d,arguments)},_size:function(){var b=this.options,c,d,e=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),b.minWidth>b.width&&(b.width=b.minWidth),c=this.uiDialog.css({height:"auto",width:b.width}).height(),d=Math.max(0,b.minHeight-c);if(b.height==="auto")if(a.support.minHeight)this.element.css({minHeight:d,height:"auto"});else{this.uiDialog.show();var f=this.element.css("height","auto").height();e||this.uiDialog.hide(),this.element.height(Math.max(f,d))}else this.element.height(Math.max(b.height-c,0));this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),a.extend(a.ui.dialog,{version:"1.8.23",uuid:0,maxZ:0,getTitleId:function(b){var a=b.attr("id");return a||(this.uuid+=1,a=this.uuid),"ui-dialog-title-"+a},overlay:function(b){this.$el=a.ui.dialog.overlay.create(b)}}),a.extend(a.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:a.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(a){return a+".dialog-overlay"}).join(" "),create:function(c){this.instances.length===0&&(setTimeout(function(){a.ui.dialog.overlay.instances.length&&a(document).bind(a.ui.dialog.overlay.events,function(b){if(a(b.target).zIndex()<a.ui.dialog.overlay.maxZ)return!1})},1),a(document).bind("keydown.dialog-overlay",function(b){c.options.closeOnEscape&&!b.isDefaultPrevented()&&b.keyCode&&b.keyCode===a.ui.keyCode.ESCAPE&&(c.close(b),b.preventDefault())}),a(window).bind("resize.dialog-overlay",a.ui.dialog.overlay.resize));var b=(this.oldInstances.pop()||a("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});return a.fn.bgiframe&&b.bgiframe(),this.instances.push(b),b},destroy:function(c){var d=a.inArray(c,this.instances);d!=-1&&this.oldInstances.push(this.instances.splice(d,1)[0]),this.instances.length===0&&a([document,window]).unbind(".dialog-overlay"),c.remove();var b=0;a.each(this.instances,function(){b=Math.max(b,this.css("z-index"))}),this.maxZ=b},height:function(){var b,c;return a.browser.msie&&a.browser.version<7?(b=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),c=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),b<c?a(window).height()+"px":b+"px"):a(document).height()+"px"},width:function(){var b,c;return a.browser.msie?(b=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),c=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),b<c?a(window).width()+"px":b+"px"):a(document).width()+"px"},resize:function(){var b=a([]);a.each(a.ui.dialog.overlay.instances,function(){b=b.add(this)}),b.css({width:0,height:0}).css({width:a.ui.dialog.overlay.width(),height:a.ui.dialog.overlay.height()})}}),a.extend(a.ui.dialog.overlay.prototype,{destroy:function(){a.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);EC.Urls={SessionFinder:"/Movie/SessionFinder",FriendsAndFamily:{Payment:"/FriendsAndFamily/Payment",LostVouchers:"/FriendsAndFamily/LostVouchers"}};UTIL={exec:function(c,a,b){var b=b===undefined?"init":b;a!==""&&c[a]&&typeof c[a][b]=="function"&&c[a][b]()},init:function(){var a=[];$('.widget[data-runfirst="true"]').each(function(f,d){var b=$(d).data("controller"),c=$(d).data("action"),e=b+", "+c;if($.inArray(e,a)==-1){a.push(e);UTIL.exec(ECWidget,"common");UTIL.exec(ECWidget,b);UTIL.exec(ECWidget,b,c)}});$('.widget[data-runfirst!="true"]').each(function(f,d){var b=$(d).data("controller"),c=$(d).data("action"),e=b+", "+c;if($.inArray(e,a)==-1){a.push(e);UTIL.exec(ECWidget,"common");UTIL.exec(ECWidget,b);UTIL.exec(ECWidget,b,c)}});var b=$("body").attr("data-controller");if(b){var c=$("body").attr("data-action");if(b==="ticketing"){UTIL.exec(ECTicketing,"common");UTIL.exec(ECTicketing,c)}else{UTIL.exec(ECPage,b);UTIL.exec(ECPage,b,c)}}}};$(function(){UTIL.init()});var JSON=JSON||{};JSON.stringify=JSON.stringify||function(a){var c=typeof a;if(c!="object"||a===null){if(c=="string")a='"'+a+'"';return String(a)}else{var e,b,f=[],d=a&&a.constructor==Array;for(e in a){b=a[e];c=typeof b;if(c=="string")b='"'+b+'"';else if(c=="object"&&b!==null)b=JSON.stringify(b);f.push((d?"":'"'+e+'":')+String(b))}return(d?"[":"{")+String(f)+(d?"]":"}")}}